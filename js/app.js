/*!
 * Ripple Client v1.5.4
 * Copyright (c) 2015 Ripple Labs, Inc.
 * Licensed under the ISC license.
 */
!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e,t){_.each(u,function(t){var n={tabName:t.tabName,tabClass:"t-"+t.tabName,pageMode:"pm-"+t.pageMode,mainMenu:t.mainMenu,templateUrl:"templates/"+lang+"/tabs/"+t.tabName+".html"};"balance"===t.tabName&&e.when("/",n),e.when("/"+t.tabName,n),t.extraRoutes&&_.each(t.extraRoutes,function(t){$.extend({},n,t.config),e.when(t.name,n)}),_.each(t.aliases,function(t){e.when("/"+t,n)})}),e.when("/lang/:language",{redirectTo:function(e,t,n){lang=e.language,store.disabled||store.set("ripple_language",lang?lang:"");var r=location.port.length>0?":"+location.port:"";location.href=location.protocol+"//"+location.hostname+r+location.pathname}}),e.otherwise({redirectTo:"/404"})}function o(e,t,n,r){e.productName="Ripple Trade","object"==typeof l&&(l.$scope=e,l.version=e.version=angular.element("#version").html(),"undefined"!=typeof debug&&debug===!0&&(l.versionBranch=e.versionBranch=angular.element("#versionbranch").text())),e.isEmpty=function(e){return angular.equals({},e)},_.isArray(r.$$absUrl.match(/%2B|\+/gi))&&(window.location=r.$$absUrl.replace(/%2B|\+/gi,"%20"));var o=e;e.$route=t,e.$routeParams=n,e.lang=lang,$("#main").data("$scope",o);var a=r.search().amnt;a&&(r.search("amnt",null),r.search("amount",a)),e.globalOptions=Options,e.$on("$routeChangeStart",function(){e.pageLoading=!0}),e.$on("$routeChangeSuccess",function(){e.pageLoading=!1}),o.$watch("app_loaded",function(e,n){$("nav a").click(function(){location.hash==this.hash&&o.$apply(function(){t.reload()})})})}var a=n(1),i=n(3);n(5),n(14),n(16),n(17),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29),n(30),n(31),n(32),n(33),n(34),n(35),n(36),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(50),n(51),n(52),n(53);var s=["ngRoute","app","navbar","id","tracker","appManager","history","api","blob","authflow","charts","effects","events","fields","formatters","directives","validators","datalinks","errors","ngMessages","filters","ui.bootstrap","ui.sortable"],c=[n(54),n(56),n(57),n(58),n(60),n(61),n(62),n(63),n(64),n(65),n(66),n(68),n(69),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90)];window.lang=function(){var e=_.pluck(n(91).active,"code"),t=function(t){return t?-1!=e.indexOf(t)?t:-1!=t.indexOf("_")&&(t=t.split("_")[0],-1!=e.indexOf(t))?t:null:null};return t(store.get("ripple_language"))||t(window.navigator.userLanguage||window.navigator.language)||"en"}();var u=c.map(function(e){var t=new e;if(t.angular){var n=angular.module(t.tabName+"Tab",t.angularDeps);t.angular(n),s.push(t.tabName+"Tab")}return t}),d=angular.module("rp",s).config(r).run(o),l=window.rippleclient={};l.app=d,l.types=a,l.rewriter=i,l.tabs={},_.each(u,function(e){l.tabs[e.tabName]=e}),r.$inject=["$routeProvider","$injector"],o.$inject=["$rootScope","$route","$routeParams","$location"],Options.blobvault||(Options.blobvault=Options.BLOBVAULT_SERVER),"function"==typeof angular.resumeBootstrap&&(angular.resumeBootstrap(),angular.resumeBootstrap=function(){return!1})},function(e,t,n){var r=n(2),o=function(){function e(e,t){return[].concat(e,t>>24,t>>16&255,t>>8&255,255&t)}function t(e){return sjcl.bitArray.bitSlice(sjcl.hash.sha512.hash(sjcl.codec.bytes.toBits(e)),0,256)}function n(e){return sjcl.hash.ripemd160.hash(sjcl.hash.sha256.hash(e))}return function(o){if(this.seed=r.decode_base_check(33,o),!this.seed)throw"Invalid seed.";this.getAddress=function(o){o=o||0;var a,i,s=0;do a=sjcl.bn.fromBits(t(e(this.seed,s))),s++;while(!sjcl.ecc.curves.c256.r.greaterEquals(a));i=sjcl.ecc.curves.c256.G.mult(a);var c;s=0;do c=sjcl.bn.fromBits(t(e(e(i.toBytesCompressed(),o),s))),s++;while(!sjcl.ecc.curves.c256.r.greaterEquals(c));var u=sjcl.ecc.curves.c256.G.mult(c).toJac().add(i).toAffine();return r.encode_base_check(0,sjcl.codec.bytes.fromBits(n(sjcl.codec.bytes.toBits(u.toBytesCompressed()))))}}}();t.RippleAddress=o},function(e,t){var n=function(){var e={ripple:"rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz",bitcoin:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"},t=function(e){return sjcl.codec.bytes.fromBits(sjcl.hash.sha256.hash(sjcl.codec.bytes.toBits(e)))};return{encode_base:function(t,n){for(var r=e[n||"ripple"],o=new sjcl.bn(r.length),a=sjcl.bn.fromBits(sjcl.codec.bytes.toBits(t)),i=[];a.greaterEquals(o);){var s=a.mod(o);i.push(r[s.limbs[0]]),a=a.div(o)}i.push(r[a.limbs[0]]);for(var c=0;c!=t.length&&!t[c];c+=1)i.push(r[0]);return i.reverse().join("")},decode_base:function(t,n){for(var r,o=e[n||"ripple"],a=new sjcl.bn(o.length),i=new sjcl.bn(0);r!=t.length&&t[r]===o[0];)r+=1;for(r=0;r!=t.length;r+=1){var s=o.indexOf(t[r]);if(0>s)return null;i=i.mul(a).addM(s)}for(var c=sjcl.codec.bytes.fromBits(i.toBits()).reverse();0===c[c.length-1];)c.pop();for(r=0;t[r]===o[0];r++)c.push(0);return c.reverse(),c},encode_base_check:function(e,r,o){var a=[].concat(e,r),i=t(t(a)).slice(0,4);return n.encode_base([].concat(a,i),o)},decode_base_check:function(e,r,o){var a=n.decode_base(r,o);if(!a||a[0]!==e||a.length<5)return NaN;var i,s=t(t(a.slice(0,-4))).slice(0,4),c=a.slice(-4);for(i=0;4!=i;i+=1)if(s[i]!==c[i])return NaN;return a.slice(1,-4)}}}();e.exports=n},function(e,t,n){var r=n(4),o=function(e,t){var n,o=e.got?e.got:e.gets,a=e.paid?e.paid:e.pays;return a.is_zero()||o.is_zero()||(_.find(r,function(e){e.name==o.currency().to_human()+"/"+a.currency().to_human()&&(n=a.ratio_human(o,{reference_date:t}))}),n||(n=o.ratio_human(a,{reference_date:t}))),n||0},a=function(e,t){var n,r=e.got?e.got:e.gets,o=e.paid?e.paid:e.pays;return o.is_zero()||r.is_zero()||(n=r.ratio_human(o,{reference_date:t})),n||0},i=function(e,t){var n,r=e.got?e.got:e.gets,o=e.paid?e.paid:e.pays;return o.is_zero()||r.is_zero()||(n=o.ratio_human(r,{reference_date:t})),n||0},s=function(e){return e&&e.length&&2===e.length&&"trust_change_balance"==e[0].type&&"trust_change_balance"==e[1].type&&e[0].currency==e[1].currency&&!e[0].amount.compareTo(e[1].amount.negate())?!0:void 0},c=e.exports={filterAnodes:function(e,t){return e?e.filter(function(e){return e=e.CreatedNode?e.CreatedNode:e.ModifiedNode?e.ModifiedNode:{},e.LedgerEntryType===t}):[]},getAnodeResult:function(e){e=e.CreatedNode?e.CreatedNode:e.ModifiedNode?e.ModifiedNode:{};var t=$.extend({},e.NewFields,e.FinalFields);return t},processAnode:function(e){var t={};return["CreatedNode","ModifiedNode","DeletedNode"].forEach(function(n){e[n]&&(t.diffType=n)}),t.diffType?(e=e[t.diffType],t.entryType=e.LedgerEntryType,t.ledgerIndex=e.LedgerIndex,t.fields=$.extend({},e.PreviousFields,e.NewFields,e.FinalFields),t.fieldsPrev=e.PreviousFields||{},t.fieldsNew=e.NewFields||{},t.fieldsFinal=e.FinalFields||{},t):null},getAmountSent:function(e,t){var n,r,o,a,i=e.Account,s=null,c=null;if("Payment"===e.TransactionType){if(t.DeliveredAmount)return t.DeliveredAmount;if(t.AffectedNodes){if(e.SendMax&&e.SendMax.currency)for(r=0;r<t.AffectedNodes.length;r++)o=t.AffectedNodes[r],!o.ModifiedNode||"RippleState"!==o.ModifiedNode.LedgerEntryType||o.ModifiedNode.FinalFields.HighLimit.issuer!==i&&o.ModifiedNode.FinalFields.LowLimit.issuer!==i||o.ModifiedNode.FinalFields.Balance.currency!==e.SendMax.currency||(n=o.ModifiedNode.PreviousFields.Balance.value-o.ModifiedNode.FinalFields.Balance.value,o.ModifiedNode.FinalFields.HighLimit.issuer===i&&(n*=-1),s+=n,c=o.ModifiedNode.FinalFields.Balance.currency);if(null===s)for(r=0;r<t.AffectedNodes.length;r++)if(o=t.AffectedNodes[r],o.ModifiedNode&&"AccountRoot"===o.ModifiedNode.LedgerEntryType&&o.ModifiedNode.FinalFields&&o.ModifiedNode.FinalFields.Account===i){s=o.ModifiedNode.PreviousFields.Balance-o.ModifiedNode.FinalFields.Balance-e.Fee;break}if(s){var u=String(s);a=c?{value:u,currency:c}:u}else a=e.Amount}}return a},processTxn:function(e,t,n){try{return c._processTxn(e,t,n)}catch(r){var o={};return o.type="error",e&&"object"==typeof e?(o.hash=e.hash,o.date=ripple.utils.toTimestamp(e.date),o.dateRaw=e.date):(o.hash="unknown",o.date=(new Date).getTime(),o.dateRaw=ripple.utils.fromTimestamp(fromTimestamp)),{transaction:o,error:r}}},_processTxn:function(e,t,n){var r={},u=!1,d=[];if(e.Account===n||e.Destination&&e.Destination===n||e.LimitAmount&&e.LimitAmount.issuer===n){var l={};if("tesSUCCESS"===t.TransactionResult){switch(e.TransactionType){case"Payment":var p;p=t.DeliveredAmount?ripple.Amount.from_json(t.DeliveredAmount):ripple.Amount.from_json(e.Amount),e.Account===n?e.Destination===n?(l.type="exchange",l.spent=ripple.Amount.from_json(e.SendMax)):(l.type="sent",l.counterparty=e.Destination):(l.type="received",l.counterparty=e.Account),"object"==typeof e.SendMax&&(l.sendMax=e.SendMax);var f=c.getAmountSent(e,t);f&&(l.amountSent=f),l.amount=p,l.currency=p.currency().to_human();break;case"TrustSet":l.type=e.Account===n?"trusting":"trusted",l.counterparty=e.Account===n?e.LimitAmount.issuer:e.Account,l.amount=ripple.Amount.from_json(e.LimitAmount),l.currency=e.LimitAmount.currency;break;case"OfferCreate":l.type="offernew",l.pays=ripple.Amount.from_json(e.TakerPays),l.gets=ripple.Amount.from_json(e.TakerGets),l.sell=e.Flags&ripple.Transaction.flags.OfferCreate.Sell;break;case"OfferCancel":l.type="offercancel";break;case"AccountSet":if(1===t.AffectedNodes.length&&2===_.size(t.AffectedNodes[0].ModifiedNode.PreviousFields))break;l.type="accountset";break;default:console.log("Unknown transaction type: '"+e.TransactionType+"'",e)}e.Flags&&(l.flags=e.Flags)}else l.type="failed";$.isEmptyObject(l)||(r.transaction=l)}return"tesSUCCESS"===t.TransactionResult&&t.AffectedNodes.forEach(function(t){var s,l=c.processAnode(t),p={};if("AccountRoot"===l.entryType&&l.fields.Account===n)if(r.accountRoot=l.fields,"CreatedNode"===l.diffType)p.type="balance_change",p.amount=ripple.Amount.from_json(l.fields.Balance),p.balance=p.amount,r.balance_changer=p.balance_changer=!0,d.push("XRP");else if(l.fieldsPrev.Balance){var f=ripple.Amount.from_json(l.fields.Balance);e.Account===n&&e.Fee&&(s={type:"fee",amount:ripple.Amount.from_json(e.Fee).negate(),balance:f}),e.Fee!=l.fieldsPrev.Balance-l.fields.Balance&&(s&&(f=f.subtract(s.amount)),p.type="balance_change",p.amount=f.subtract(l.fieldsPrev.Balance),p.balance=f,r.balance_changer=p.balance_changer=!0,d.push("XRP"))}if("RippleState"!==l.entryType||l.fields.HighLimit.issuer!==n&&l.fields.LowLimit.issuer!==n){if("Offer"===l.entryType){var _=l.fields;l.fields.Account===n?("ModifiedNode"===l.diffType||"DeletedNode"===l.diffType&&l.fieldsPrev.TakerGets&&!ripple.Amount.from_json(l.fieldsFinal.TakerGets).is_zero()?(p.type="offer_partially_funded","DeletedNode"!==l.diffType?p.remaining=ripple.Amount.from_json(l.fields.TakerGets):p.cancelled=!0):(p.type="CreatedNode"===l.diffType?"offer_created":l.fieldsPrev.TakerPays?"offer_funded":"offer_cancelled","offer_funded"===p.type&&(_=l.fieldsPrev),"offer_cancelled"===p.type&&r.transaction&&"offercancel"===r.transaction.type&&(r.transaction.gets=_.TakerGets,r.transaction.pays=_.TakerPays)),p.seq=+l.fields.Sequence):e.Account!==n||$.isEmptyObject(l.fieldsPrev)||$.isEmptyObject(l.fieldsPrev.TakerGets)||$.isEmptyObject(l.fieldsPrev.TakerPays)||(p.type="offer_bought"),p.type&&(p.gets=ripple.Amount.from_json(_.TakerGets),p.pays=ripple.Amount.from_json(_.TakerPays),("offer_partially_funded"===p.type||"offer_bought"===p.type)&&(p.got=ripple.Amount.from_json(l.fieldsPrev.TakerGets).subtract(l.fields.TakerGets),p.paid=ripple.Amount.from_json(l.fieldsPrev.TakerPays).subtract(l.fields.TakerPays)),p.price=o(p,e.date),p.straightPrice=a(p,e.date),p.invStraightPrice=i(p,e.date),l.fields.Flags&&(p.flags=l.fields.Flags,p.sell=l.fields.Flags&ripple.Remote.flags.offer.Sell))}}else{var m=l.fields.HighLimit,h=l.fields.LowLimit,g=m.issuer===n,v=g?"HighNoRipple":"LowNoRipple";if(r.transaction&&(v="trusting"===r.transaction.type?g?"HighNoRipple":"LowNoRipple":g?"LowNoRipple":"HighNoRipple"),"CreatedNode"===l.diffType)p.limit=ripple.Amount.from_json(g?m:h),p.limit_peer=ripple.Amount.from_json(g?h:m),r.transaction?p.type="trusting"===r.transaction.type?"trust_create_local":"trust_create_remote":m.value>0&&m.issuer===n||h.value>0&&h.issuer===n?p.type="trust_create_local":p.type="trust_create_remote";else if("ModifiedNode"===l.diffType||"DeletedNode"===l.diffType){var y=l.fieldsPrev.HighLimit,b=l.fieldsPrev.LowLimit;if(l.fieldsPrev.Balance){p.type="trust_change_balance";var w=l.fields.Balance.value>0||l.fieldsPrev.Balance.value>0?m.issuer:h.issuer;p.amount=m.issuer===n?p.amount=ripple.Amount.from_json(l.fieldsPrev.Balance.value+"/"+l.fieldsPrev.Balance.currency+"/"+w).subtract(l.fields.Balance):p.amount=ripple.Amount.from_json(l.fields.Balance.value+"/"+l.fields.Balance.currency+"/"+w).subtract(l.fieldsPrev.Balance),r.balance_changer=p.balance_changer=!0,d.push(m.currency.toUpperCase())}else y||b?(m.issuer===n?(p.limit=ripple.Amount.from_json(m),p.limit_peer=ripple.Amount.from_json(h)):(p.limit=ripple.Amount.from_json(h),p.limit_peer=ripple.Amount.from_json(m)),y?(p.prevLimit=ripple.Amount.from_json(y),p.type=m.issuer===n?"trust_change_local":"trust_change_remote"):b&&(p.prevLimit=ripple.Amount.from_json(b),p.type=m.issuer===n?"trust_change_remote":"trust_change_local")):l.fieldsPrev.Flags&&(l.fields.Flags&ripple.Remote.flags.state[v]&&!(l.fieldsPrev.Flags&ripple.Remote.flags.state[v])?p.type="trust_change_no_ripple":l.fieldsPrev.Flags&ripple.Remote.flags.state[v]&&!(l.fields.Flags&ripple.Remote.flags.state[v])&&(p.type="trust_change_no_ripple"),p.type&&(p.flags=l.fields.Flags))}$.isEmptyObject(p)||(p.counterparty=m.issuer===n?h.issuer:m.issuer,p.currency=m.currency,p.balance=m.issuer===n?ripple.Amount.from_json(l.fields.Balance).negate(!0):ripple.Amount.from_json(l.fields.Balance),p.balance.is_zero()&&p.balance.is_negative()&&(p.balance=p.balance.negate(!0)),r.transaction&&"trust_change_balance"===r.transaction.type&&(r.transaction.balance=p.balance),l.fields.Flags&ripple.Remote.flags.state[v]&&(p.noRipple=!0))}$.isEmptyObject(p)||("DeletedNode"===l.diffType&&(p.deleted=!0),r.effects||(r.effects=[]),r.effects.push(p)),s&&(u=!0,r.effects||(r.effects=[]),r.effects.push(s))}),r.accountRoot&&r.transaction&&"undefined"==typeof r.transaction.balance&&(r.transaction.balance=ripple.Amount.from_json(r.accountRoot.Balance)),!$.isEmptyObject(r)&&("OfferCancel"!==e.TransactionType||!r.transaction||r.transaction.gets&&r.transaction.pays)?(s(r.effects)&&(r.transaction||(r.transaction={}),r.transaction.type="rippling"),r.tx_type=e.TransactionType,r.tx_result=t.TransactionResult,r.fee=ripple.Amount.from_json(u?e.Fee:0),r.date=ripple.utils.toTimestamp(e.date),r.dateRaw=e.date,r.hash=e.hash,r.affectedCurrencies=d||[],r.ledger_index=e.ledger_index,r):void 0}}},function(e,t){var n=[{name:"XRP/USD.SnapSwap",last_used:10}];e.exports=n},function(e,t,n){function r(e,t,r,c,u,d,l,p,f,m){function h(){e.apps=[],e.account={},e.lines={},e.offers={},e.events=[],e.history=[],e.balances={},e.loadState={},e.unseenNotifications={count:0}}function g(t,n){var o=r.remote;I=n.account,h();var a=o.account(n.account);q=C,L=S,e.loadingAccount=!0,a.on("entry",function(t){e.$apply(function(){if(e.loadingAccount=!1,e.noUserHistory=!1,L(t),!e.userHistory){e.userHistory=new f(I),e.userHistory.onTransaction(q);var n={limit:Options.transactions_per_page};e.userHistory.getHistory(n).success(A).error(T)}})}),a.entry(function(t,n){t&&(e.loadingAccount=!1,e.loadState.account=!0,e.noUserHistory=!0,e.userHistory=null)}),o.requestAccountLines({account:n.account}).on("success",y).on("error",b).request(),o.requestAccountOffers({account:n.account}).on("success",w).on("error",x).request(),R()}function v(e,t){if(q&&L){var n=r.remote,o=n.account(t.account);o.removeListener("transaction",q),o.removeListener("entry",L)}}function y(t){e.$apply(function(){e.lines={};for(var n=0,r=t.lines.length;r>n;n++){var o=t.lines[n];e.isSignificantLine(o)&&(o=$.extend({},o,{limit:ripple.Amount.from_json({value:o.limit,currency:o.currency,issuer:o.account}),limit_peer:ripple.Amount.from_json({value:o.limit_peer,currency:o.currency,issuer:o.account}),balance:ripple.Amount.from_json({value:o.balance,currency:o.currency,issuer:o.account})}),e.lines[o.account+o.currency]=o,e.hasRTJapanTrust=!1,e.hasRTJapanTrustWithRippling=!1,"rMAz5ZnK73nyNUL4foAvaxdreczCkG3vA6"===o.account&&(e.hasRTJapanTrust=!0,o.no_ripple&&o.no_ripple_peer||(e.hasRTJapanTrustWithRippling=!0)),j(o.currency,o.account,o.balance))}console.log("lines updated:",e.lines),t.lines.length>200&&(e.accountLinesWarning=!0),e.$broadcast("$balancesUpdate"),e.loadState.lines=!0})}function b(t){e.$apply(function(){e.loadState.lines=!0})}function w(t){e.$apply(function(){t.offers.forEach(function(e){var t={seq:+e.seq,gets:ripple.Amount.from_json(e.taker_gets),pays:ripple.Amount.from_json(e.taker_pays),flags:e.flags};B(t)}),console.log("offers updated:",e.offers),e.$broadcast("$offersUpdate"),e.loadState.offers=!0})}function x(t){e.$apply(function(){e.loadState.offers=!0})}function k(e,t){return s.from_json(e._reserve_base+e._reserve_inc*t)}function S(t){var n=r.remote;e.account=t;var o=n._getServer(),a=e.account.OwnerCount||0;e.account.reserve_base=s.from_json(o._reserve_base),e.account.reserve=k(o,a),e.account.reserve_to_add_trust=k(o,a+1);var i=s.from_json(t.Balance);e.account.max_spend=i.subtract(e.account.reserve),e.loadState.account=!0,u.checkQueue()}function A(t){e.history=[],t.transactions.reverse().forEach(function(e,t){P(e.tx,e.meta,!0)}),e.$broadcast("$eventsUpdate"),e.loadState.transactions=!0}function T(t){function n(){e.loadState.transactions=!0}e.$$phase?n():e.$apply(n)}function C(t){e.$apply(function(){P(t.transaction,t.meta),e.$broadcast("$eventsUpdate")})}function P(t,n,r){var a=o.processTxn(t,n,I);if(a&&a.error){var s=a.error;l.trackError("JsonRewriter Error",s,{"Transaction Hash":a.transaction.hash,Source:r?"app controller historic":"app controller event"}),console.error("Error processing transaction "+a.transaction.hash+"\n",s&&"object"==typeof s&&s.stack?s.stack:s),e.history.unshift(a)}else if(a){var c=a.transaction;if(a.accountRoot&&S(a.accountRoot),"tesSUCCESS"===a.tx_result&&c&&!r&&e.$broadcast("$appTxNotification",{hash:t.hash,tx:c}),"tesSUCCESS"===a.tx_result&&c){var u=[];switch(c.type){case"offernew":case"exchange":var p=!1;if(a.effects.some(function(e){return _.contains(["offer_bought","offer_funded","offer_partially_funded"],e.type)?(p=!0,u.push(e),!0):void 0}),!p)break;case"received":a.date>i.getSetting(e.userBlob,"lastSeenTxDate",0)&&(a.unseen=!0,e.unseenNotifications.count++),a.showEffects=u,e.events.unshift(a)}}d.getAllApps(function(t){_.each(t,function(t){var n;(n=t.findProfile("history"))&&n.getTransactions(e.address,function(e,n){n.forEach(function(e){e.app=t,a.hash===e.hash&&(a.details=e)})})})}),e.history.unshift(a),a.effects&&!r&&D(a.effects),a.effects&&!r&&(a.effects.forEach(function(e){if(_.contains(["offer_created","offer_funded","offer_partially_funded","offer_cancelled"],e.type)){var t={seq:+e.seq,gets:e.gets,pays:e.pays,deleted:e.deleted,flags:e.flags};B(t)}}),e.$broadcast("$offersUpdate"))}}function B(t){t.flags&&t.flags===ripple.Remote.flags.offer.Sell?(t.type="sell",t.first=t.gets,t.second=t.pays):(t.type="buy",t.first=t.pays,t.second=t.gets),t.deleted?delete e.offers[""+t.seq]:e.offers[""+t.seq]=t}function D(t){if($.isArray(t)){var n;$.each(t,function(){if(_.contains(["trust_create_local","trust_create_remote","trust_change_local","trust_change_remote","trust_change_balance","trust_change_no_ripple"],this.type)){var t=this,r={},o=t.counterparty+t.currency;if(r.currency=t.currency,r.account=t.counterparty,r.flags=t.flags,r.no_ripple=!!t.noRipple,t.balance&&(r.balance=t.balance,j(t.currency,t.counterparty,t.balance),n=!0),t.limit&&(r.limit=t.limit),t.limit_peer&&(r.limit_peer=t.limit_peer),t.deleted)return delete e.lines[o];e.lines[o]=$.extend(e.lines[o],r)}}),n&&e.$broadcast("$balancesUpdate")}}function j(t,n,r){e.balances[t]||(e.balances[t]={components:{},total:null});var o=e.balances[t];n&&(o.components[n]=r),$(o.components).sort(function(e,t){return e.compareTo(t)}),o.total=null;for(var a in o.components){var i=o.components[a];o.total=o.total?o.total.add(i):i}d.getApp(n,function(r,a){if(r)return void console.warn(r);var i={app:a,inboundBridge:a.getInboundBridge(t)};o.components[n].gateway=i,a.findProfile("account").getUser(e.address,function(t,n){return t?void console.warn(t):(i.user=n,void(i.inboundBridge&&i.inboundBridge.getInstructions(e.address,function(t,n){return t?void console.warn(t):(i.inboundBridge.limit=e.B2R.currencies[0].limit,void(i.inboundBridge.instructions=n))})))})})}function R(){e.loadState.B2RApp=!1,e.loadState.B2RInstructions=!1,d.loadApp(Options.b2rAddress,function(t,n){if(t)return void console.warn("Error loading app",t.message);e.B2RApp=n,e.B2R=n.getInboundBridge("BTC"),d.save(n),n.refresh=function(){n.findProfile("account").getUser(e.address,function(t,n){if(e.loadState.B2RApp=!0,t)return void console.log("Error",t);e.B2R.active=n,e.B2R.limit=e.B2R.currencies[0].limit;var r=_.findWhere(e.B2R.currencies,{currency:"BTC"});e.B2R.trust(r.currency,r.issuer),e.B2R.getPending(e.address,function(t,n){e.pending=n[0]}),e.B2R.getInstructions&&e.B2R.getInstructions(e.address,function(t,n){t||(e.B2R.instructions=n,e.loadState.B2RInstructions=!0)})})};var r=e.$watch("address",function(e){e&&(n.refresh(),r())});e.B2RSignupFields=n.findProfile("account").getFields()})}function N(e,t){return e.order<t.order?1:e.order>t.order?-1:0}function O(e,t){var n=e.last_used||e.order||0,r=t.last_used||t.order||0;return r>n?1:n>r?-1:0}function F(){K()}function M(){location.reload()}h();var I,E;store.set("announcement",!0),e.showAnnouncement=store.get("announcement");var U=e.$watch("userBlob",function(){e.userBlob.data&&e.userCredentials.username&&(i.getSetting(e.userBlob,"showDisclosure")!==!1&&e.userBlob.set("/clients/rippletradecom/showDisclosure",!0),e.showTerms=i.getSetting(e.userBlob,"showDisclosure"),U())});e.dismissBanner=function(){e.userBlob.set("/clients/rippletradecom/showDisclosure",!1),e.showTerms=i.getSetting(e.userBlob,"showDisclosure")},r.listenId(t),r.init(),t.init(),d.init(),"object"==typeof rippleclient&&(rippleclient.id=t,rippleclient.net=r,rippleclient.keychain=c,rippleclient.settingsUtils=i),e.load_notification=function(t){return"string"!=typeof t?void console.log("You must pass in a string for the status"):(e.notif=t,E&&(p.cancel(E),E=null),E=p(function(){e.notif="clear"},7e3),void E["finally"](function(){E=null}))},e.reset=function(){h()};var q,L;e.isSignificantLine=function(t){var n=e.account.Flags&ripple.Remote.flags.account_root.DefaultRipple;return"object"==typeof t.balance?!t.balance.is_zero()||!t.limit.is_zero()||!t.limit_peer.is_zero()||e.acctDefaultRippleFlag===t.no_ripple:0!==t.balance||0!==t.limit||0!==t.limit_peer||n===t.no_ripple},e.ordersSortFieldChoices=[{name:"Type",value:"type"},{name:"QTY",value:"qty"},{name:"Base",value:"base"},{name:"Counter",value:"counter"},{name:"Limit",value:"limit"}],m("templates/"+lang+"/strings/myOrders.html",!0).then(function(t){_.each(e.ordersSortFieldChoices,function(e,n){var r=$(t).find("#"+e.value).text();e.name=r})}),e.ordersSortFieldChoicesKeyed={},e.ordersSortFieldChoicesKeyedReverse={},_.each(e.ordersSortFieldChoices,function(t){e.ordersSortFieldChoicesKeyed[t.value]=t.name,e.ordersSortFieldChoicesKeyedReverse[t.name]=t.value}),e.currencies_all=n(13),store.disabled||store.get("ripple_pairs_all")||store.set("ripple_pairs_all",n(4));var V=store.get("ripple_pairs_all"),X=n(4);e.pairs_all=a.uniqueObjArray(V,X,"name"),e.currencies_all.sort(N),e.pairs_all.sort(O),e.currencies_all_keyed={},_.each(e.currencies_all,function(t){e.currencies_all_keyed[t.value]=t});var H=e.$watch("currencies_all",function(){e.currencies_all.length&&(store.disabled||store.set("ripple_currencies_all",e.currencies_all),H())},!0),z=e.$watch("pairs_all",function(){e.pairs_all.length&&(store.disabled||store.set("ripple_pairs_all",e.pairs_all),z())},!0);e.pairs=e.pairs_all.slice(1),p(function(){e.app_loaded="loaded",$("body").removeClass("loading")},100),e.$on("$idAccountLoad",function(t,n){e.connected&&g(t,n),e.$on("$netConnected",function(){$.isEmptyObject(e.account)&&(e.$broadcast("$idAccountUnload",{account:e.account}),g(t,n))})}),e.$on("$idAccountUnload",v);var K=e.$on("$netConnected",F);e.logout=function(e){t.logout(),e||(e=Options.ids_url+"/auth/logout?redirect="+encodeURIComponent(location.href)),location.href=e},e.$on("$idRemoteLogout",M),e.generate_src_currencies=function(){var t=[],n=e.balances,r=e.generate_issuer_currencies();t.push({currency:"XRP"});for(var o in n)if(n.hasOwnProperty(o)){var a=n[o],i=a.total.currency().to_hex(),s=[];for(var c in a.components)if(a.components.hasOwnProperty(c)){var u=a.components[c];u.is_positive()&&s.push({currency:i,issuer:c})}(s.length>1||r[i]||0===s.length)&&s.unshift({currency:i}),t=t.concat(s)}return t},e.generate_issuer_currencies=function(){var t={};return _.each(e.lines,function(e){e.limit_peer.is_positive()&&(t[e.balance.currency().to_hex()]=!0)}),t},this.reset=h,this.handleAccountLoad=g,this.handleAccountUnload=v,this.handleRemoteLogout=M,this.handleRippleLines=y,this.handleRippleLinesError=b,this.handleOffers=w,this.handleOffersError=x,this.handleAccountEntry=S,this.handleAccountTx=A,this.handleAccountTxError=T,this.handleAccountEvent=C,this.processTxn=P,this.updateOffer=B,this.updateLines=D,this.updateRippleBalance=j,this.compare=N,this.handleFirstConnection=F}var o=(n(6),n(10),n(3)),a=n(11),i=n(12),s=ripple.Amount;angular.module("app",[]).controller("AppCtrl",r),r.$inject=["$rootScope","rpId","rpNetwork","rpKeychain","rpTxQueue","rpAppManager","rpTracker","$timeout","rpHistory","$templateRequest"]},function(e,t,n){(function(e,r){function o(e,n){var r={seen:[],stylize:i};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&t._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=a),c(r,e,r.depth)}function a(e,t){var n=o.styles[t];return n?"["+o.colors[n][0]+"m"+e+"["+o.colors[n][1]+"m":e}function i(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function c(e,n,r){if(e.customInspect&&n&&A(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return y(o)||(o=c(e,o,r)),o}var a=u(e,n);if(a)return a;var i=Object.keys(n),m=s(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(n)),S(n)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return d(n);if(0===i.length){if(A(n)){var h=n.name?": "+n.name:"";return e.stylize("[Function"+h+"]","special")}if(x(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(k(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return d(n)}var g="",v=!1,b=["{","}"];if(_(n)&&(v=!0,b=["[","]"]),A(n)){var w=n.name?": "+n.name:"";g=" [Function"+w+"]"}if(x(n)&&(g=" "+RegExp.prototype.toString.call(n)),k(n)&&(g=" "+Date.prototype.toUTCString.call(n)),S(n)&&(g=" "+d(n)),0===i.length&&(!v||0==n.length))return b[0]+g+b[1];if(0>r)return x(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var $;return $=v?l(e,n,r,m,i):i.map(function(t){return p(e,n,r,m,t,v)}),e.seen.pop(),f($,g,b)}function u(e,t){if(w(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return v(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):h(t)?e.stylize("null","null"):void 0}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,o){for(var a=[],i=0,s=t.length;s>i;++i)D(t,String(i))?a.push(p(e,t,n,r,String(i),!0)):a.push("");return o.forEach(function(o){o.match(/^\d+$/)||a.push(p(e,t,n,r,o,!0))}),a}function p(e,t,n,r,o,a){var i,s,u;if(u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},u.get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),D(r,o)||(i="["+o+"]"),s||(e.seen.indexOf(u.value)<0?(s=h(n)?c(e,u.value,null):c(e,u.value,n-1),s.indexOf("\n")>-1&&(s=a?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),w(i)){if(a&&o.match(/^\d+$/))return s;i=JSON.stringify(""+o),i.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=e.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),i=e.stylize(i,"string"))}return i+": "+s}function f(e,t,n){var r=0,o=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function _(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function h(e){return null===e}function g(e){return null==e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function w(e){return void 0===e}function x(e){return $(e)&&"[object RegExp]"===C(e)}function $(e){return"object"==typeof e&&null!==e}function k(e){return $(e)&&"[object Date]"===C(e)}function S(e){return $(e)&&("[object Error]"===C(e)||e instanceof Error)}function A(e){return"function"==typeof e}function T(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function C(e){return Object.prototype.toString.call(e)}function P(e){return 10>e?"0"+e.toString(10):e.toString(10)}function B(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var j=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,a=r.length,i=String(e).replace(j,function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),s=r[n];a>n;s=r[++n])i+=h(s)||!$(s)?" "+s:" "+o(s);return i},t.deprecate=function(n,o){function a(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return n.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(n,o).apply(this,arguments)};if(r.noDeprecation===!0)return n;var i=!1;return a};var R,N={};t.debuglog=function(e){if(w(R)&&(R=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!N[e])if(new RegExp("\\b"+e+"\\b","i").test(R)){var n=r.pid;N[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else N[e]=function(){};return N[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=_,t.isBoolean=m,t.isNull=h,t.isNullOrUndefined=g,t.isNumber=v,t.isString=y,t.isSymbol=b,t.isUndefined=w,t.isRegExp=x,t.isObject=$,t.isDate=k,t.isError=S,t.isFunction=A,t.isPrimitive=T,t.isBuffer=n(8);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",B(),t.format.apply(t,arguments))},t.inherits=n(9),t._extend=function(e,t){if(!t||!$(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,function(){return this}(),n(7))},function(e,t){function n(){u=!1,i.length?c=i.concat(c):d=-1,c.length&&r();
}function r(){if(!u){var e=setTimeout(n);u=!0;for(var t=c.length;t;){for(i=c,c=[];++d<t;)i&&i[d].run();d=-1,t=c.length}i=null,u=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function a(){}var i,s=e.exports={},c=[],u=!1,d=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new o(e,t)),1!==c.length||u||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=a,s.addListener=a,s.once=a,s.off=a,s.removeListener=a,s.removeAllListeners=a,s.emit=a,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,s,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],i(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(a(n))for(s=Array.prototype.slice.call(arguments,1),u=n.slice(),o=u.length,c=0;o>c;c++)u[c].apply(this,s);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(o=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,i,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=i;s-->0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=s;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){t.uniqueObjArray=function(e,t,n){var r={};return _.each(e,function(e){r[e[n]]=e}),_.each(t,function(e){e[n]in r||(r[e[n]]=e)}),_.values(r)}},function(e,t){t.blobIsValid=function(e){return"object"==typeof e&&e.hasOwnProperty("data")&&e.hasOwnProperty("encrypted_secret")&&"function"==typeof e.unshift},t.hasSetting=function(e,t){if(!e||!e.data||"string"!=typeof t)return!1;var n=e.data;if(n.clients&&n.clients.rippletradecom){for(var r=t.split("."),o=n.clients.rippletradecom;r.length;){var a=r.shift();if(!_.has(o,a))return!1;o=o[a]}return!0}return!1},t.getSetting=function(e,t,n){if(!e||!e.data||"string"!=typeof t)return n;var r=e.data;if(r.clients&&r.clients.rippletradecom){for(var o=t.split("."),a=r.clients.rippletradecom;o.length;){var i=o.shift();if(!_.has(a,i))return n;a=a[i]}return a}return n},t.getClearServers=function(e){return _.map(e,function(e){var t=_.pick(e,"host","port","secure");return t.port=Number(t.port),t})}},function(e,t){e.exports=[{value:"XRP",name:"Ripples",custom_trade_currency_dropdown:!0,standard_precision:4,order:5},{value:"USD",name:"US Dollar",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:4},{value:"EUR",name:"Euro",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:3},{value:"JPY",name:"Japanese Yen",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"CNY",name:"Chinese Yuan",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"INR",name:"Indian Rupee",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"RUB",name:"Russian Ruble",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"GBP",name:"British Pound",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"CAD",name:"Canadian Dollar",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"BRL",name:"Brazilian Real",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"CHF",name:"Swiss Franc",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"DKK",name:"Danish Krone",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"NOK",name:"Norwegian Krone",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"SEK",name:"Swedish Krona",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"CZK",name:"Czech Koruna",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"PLN",name:"Polish Zloty",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"AUD",name:"Australian Dollar",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"MXN",name:"Mexican Peso",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"KRW",name:"South Korean Won",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"TWD",name:"New Taiwan Dollar",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"HKD",name:"Hong Kong Dollar",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"AMD",name:"Armenian Drams",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"KES",name:"Kenyan Shilling",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"NZD",name:"New Zealand Dollar",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"RON",name:"Romanian Leu",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"TRY",name:"Turkish Lira",display:!0,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"AFN",name:"Afghan Afghani",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ALL",name:"Albanian Lek",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"DZD",name:"Algerian Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"AOA",name:"Angolan Kwanza Readjustado",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"XCD",name:"East Caribbean Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ARS",name:"Argentine peso",display:!1,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"AWG",name:"Aruban Florin",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"AZN",name:"Azerbaijani Manat",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BSD",name:"Bahamian Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BHD",name:"Bahraini Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:3,order:0},{value:"BDT",name:"Taka",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BBD",name:"Barbados Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BYR",name:"Belarussian Ruble",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"BZD",name:"Belize Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"XOF",name:"CFA Franc BCEAO",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"BMD",name:"Bermudian Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BTN",name:"Ngultrum",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BOB",name:"Boliviano",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BOV",name:"Mvdol",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BAM",name:"Convertible Mark",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BWP",name:"Pula",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BND",name:"Brunei Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BGN",name:"Bulgarian Lev",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"BIF",name:"Burundi Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"KHR",name:"Riel",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"XAF",name:"CFA Franc BEAC",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"CVE",name:"Cabo Verde Escudo",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"KYD",name:"Cayman Islands Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"CLF",name:"Chilean Unidad de Formentos",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"CLP",name:"Chilean Peso",display:!1,custom_trade_currency_dropdown:!0,standard_precision:0,order:0},{value:"COP",name:"Colombian Peso",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"COU",name:"Unidad de Valor Real",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"KMF",name:"Comoro Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"CDF",name:"Congolese Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"CRC",name:"Costa Rican Colon",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"HRK",name:"Croatian Kuna",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"CUC",name:"Peso Convertible",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"CUP",name:"Cuban Peso",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ANG",name:"Netherlands Antillean Guilder",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"DJF",name:"Djibouti Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"DOP",name:"Dominican Peso",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"EGP",name:"Egyptian Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SVC",name:"El Salvador Colon",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ERN",name:"Nakfa",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ETB",name:"Ethiopian Birr",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"FKP",name:"Falkland Islands Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"FJD",name:"Fiji Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"XPF",name:"CFP Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"GMD",name:"Dalasi",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"GEL",name:"Lari",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"GHS",name:"Ghana Cedi",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"GIP",name:"Gibraltar Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"GTQ",name:"Quetzal",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"GNF",name:"Guinea Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"GYD",name:"Guyana Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"HTG",name:"Gourde",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"HNL",name:"Lempira",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"HUF",name:"Forint",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ISK",name:"Iceland Krona",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"IDR",name:"Indonesia Rupiah",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"IRR",name:"Iranian Rial",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"IQD",name:"Iraqi Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:3,order:0},{value:"ILS",name:"New Israeli Sheqel",display:!1,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"JMD",name:"Jamaican Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"JOD",name:"Jordanian Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:3,order:0},{value:"KZT",name:"Tenge",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"KPW",name:"North Korean Won",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"KWD",name:"Kuwaiti Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:3,order:0},{value:"KGS",name:"Som",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"LAK",name:"Kip",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"LVL",name:"Latvian Lats",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"LBP",name:"Lebanese Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"LSL",name:"Loti",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ZAR",name:"Rand",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"LRD",name:"Liberian Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"LYD",name:"Libyan Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:3,order:0},{value:"LTL",name:"Lithuanian Litas",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MOP",name:"Pataca",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MKD",name:"Denar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MGA",name:"Malagasy Ariary",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MWK",name:"Kwacha",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MYR",name:"Malaysian Ringgit",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MVR",name:"Rufiyaa",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MRO",name:"Ouguiya",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MUR",name:"Mauritius Rupee",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MXV",name:"Mexican Unidad de Inversion (UDI)",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MDL",name:"Moldovan Leu",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MNT",name:"Tugrik",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MAD",name:"Moroccan Dirham",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MZN",name:"Mozambique Metical",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"MMK",name:"Kyat",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"NAD",name:"Namibia Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"NPR",name:"Nepalese Rupee",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"NIO",name:"Cordoba Oro",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"NGN",name:"Naira",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"OMR",name:"Rial Omani",display:!1,custom_trade_currency_dropdown:!1,standard_precision:3,order:0},{value:"PKR",name:"Pakistan Rupee",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"PAB",name:"Balboa",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"PGK",name:"Kina",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"PYG",name:"Guarani",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"PEN",name:"Nuevo Sol",display:!1,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"PHP",name:"Philippine Peso",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"QAR",name:"Qatari Rial",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"RWF",name:"Rwanda Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"SHP",name:"Saint Helena Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"WST",name:"Tala",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"STD",name:"Dobra",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SAR",name:"Saudi Riyal",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"RSD",name:"Serbian Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SCR",name:"Seychelles Rupee",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SLL",name:"Leone",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SGD",name:"Singapore Dollar",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"SBD",name:"Solomon Islands Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SOS",name:"Somali Shilling",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SSP",name:"South Sudanese Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"LKR",name:"Sri Lanka Rupee",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SDG",name:"Sudanese Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SRD",name:"Surinam Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SZL",name:"Lilangeni",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"CHE",name:"WIR Euro",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"CHW",name:"WIR Franc",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"SYP",name:"Syrian Pound",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"TJS",name:"Somoni",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"TZS",name:"Tanzanian Shilling",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"THB",name:"Thai Baht",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"TOP",name:"Pa’anga",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"TTD",name:"Trinidad and Tobago Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"TND",name:"Tunisian Dinar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:3,order:0},{value:"TMT",name:"Turkmenistan New Manat",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"UGX",name:"Uganda Shilling",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"UAH",name:"Hryvnia",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"AED",name:"UAE Dirham",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"USN",name:"US Dollar (Next day)",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"USS",name:"US Dollar (Same day)",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"UYI",name:"Uruguay Peso en Unidades Indexadas (URUIURUI)",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"UYU",name:"Peso Uruguayo",display:!1,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"UZS",name:"Uzbekistan Sum",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"VUV",name:"Vatu",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"VEF",name:"Bolivar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"VND",name:"Dong",display:!1,custom_trade_currency_dropdown:!1,standard_precision:0,order:0},{value:"YER",name:"Yemeni Rial",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ZMK",name:"Zambian Kwacha",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"ZWL",name:"Zimbabwean Dollar",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"XAU",name:"Gold",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"XAU (-0.5%pa)",name:"Gold",display:!1,custom_trade_currency_dropdown:!1,standard_precision:2,order:0},{value:"XAG",name:"Silver",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"XPT",name:"Platinum",display:!0,custom_trade_currency_dropdown:!0,standard_precision:2,order:0},{value:"BTC",name:"Bitcoin",display:!0,custom_trade_currency_dropdown:!0,standard_precision:4,order:2},{value:"LTC",name:"Litecoin",display:!0,custom_trade_currency_dropdown:!0,standard_precision:4,order:1},{value:"STR",name:"Stellars",display:!0,custom_trade_currency_dropdown:!0,standard_precision:0,order:0}]},function(e,t,n){(function(e){var t=(ripple.Amount,n(12)),r=(n(3),angular.module("navbar",[]));r.controller("NavbarCtrl",["$scope","$element","$compile","rpId","rpNetwork","$location",function(n,r,o,a,i,s){function c(t){d.push(t),p||e(u)}function u(){if(m){m.removeClass("active");var t=m;setTimeout(function(){t.remove()},1e3),m=null}if(p=!1,d.length){n.$apply(function(){n.show_secondary=!1});var r=d.shift(),o=$(r);o.addClass("notification"),o.appendTo(_),e(function(){o.addClass("active")}),m=o,p=!0,setTimeout(u,l)}}n.loading=!0;var d=[],l=4e3,p=!1;n.toggle_secondary=function(){n.show_secondary=!n.show_secondary},n.page_reload=function(){location.reload()},n.$watch("connected",function(){n.fee=i.remote.createTransaction()._computeFee(),!n.connected&&n.userCredentials.username?n.serverStatus="disconnected":n.connected&&n.fee?parseFloat(ripple.Amount.from_json(n.fee).to_human())>parseFloat(Options.low_load_threshold)&&parseFloat(n.fee)<parseFloat(Options.max_tx_network_fee)?(n.serverLoad="mediumLoad",n.serverStatus="mediumLoad"):parseFloat(n.fee)>=parseFloat(Options.max_tx_network_fee)?(n.serverLoad="highLoad",n.serverStatus="highLoad"):(n.serverLoad="",n.serverStatus="lowLoad"):n.serverStatus="connected"},!0),n.$watch("userCredentials",function(){var e=n.userCredentials.username;e&&(n.loading=!1),n.shortUsername=null,e&&e.length>25&&(n.shortUsername=e.substring(0,24)+"...")},!0);var f=function(){n.events&&(n.notifications=n.events.slice(0,10))};n.$on("$eventsUpdate",f),n.read=function(){if(n.notifications.length){var e=n.notifications[0].date;n.unseen>0&&(n.unseen=0),t.getSetting(n.userBlob,"lastSeenTxDate",0)<e&&(n.userBlob.set("/clients/rippletradecom/lastSeenTxDate",e),n.unseen=n.unseenNotifications.count,n.unseenNotifications.count=0)}},d.length&&u();var _=$("<div>").attr("id","notification").insertAfter(r),m=null;f(),this.enqueue=c,this.tick=u}])}).call(t,n(15).setImmediate)},function(e,t,n){(function(e,r){function o(e,t){this._id=e,this._clearFn=t}var a=n(7).nextTick,i=Function.prototype.apply,s=Array.prototype.slice,c={},u=0;t.setTimeout=function(){return new o(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=u++,r=arguments.length<2?!1:s.call(arguments,1);return c[n]=!0,a(function(){c[n]&&(r?e.apply(null,r):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof r?r:function(e){delete c[e]}}).call(t,n(15).setImmediate,n(15).clearImmediate)},function(e,t){var e=angular.module("charts",[]);e.directive("rpTrustLine",["$filter",function(e){function t(t,n){function r(e){return e=Math.min(e,v),e=Math.max(e,g),Math.round((e-g)*y+o)}var o=30,a=5,i=6,s=16,c=-10,u=t.canvas.width,d=t.canvas.height,l=u-2*o,p=Math.floor(d/2);t.clearRect(0,0,u,d);var f,_,m;try{f=-n.limit_peer.to_number(),_=n.limit.to_number(),m=n.balance.to_number()}catch(h){return}var g=Math.min(m,f),v=Math.max(m,_),y=l/(v-g);t.lineWidth=2,t.strokeStyle="#333",m>0?(t.beginPath(),t.rect(r(0),p-i,r(m)-r(0),i),t.fillStyle="green",t.fill()):(t.beginPath(),t.rect(r(m),p,r(0)-r(m),i),t.fillStyle=0===m?"black":"red",t.fill()),t.beginPath(),t.moveTo(r(f),p),t.lineTo(r(_),p),t.moveTo(r(f),p-a),t.lineTo(r(f),p+a),t.moveTo(r(_),p-a),t.lineTo(r(_),p+a),t.moveTo(r(0),p-a),t.lineTo(r(0),p+a),t.stroke();var b=e("rpamount"),w={rel_precision:0};t.font="11px sans-serif",t.textAlign="center",t.fillText(b(n.balance,w),r(m),p+c),t.fillStyle="#333";var x=b(n.limit_peer,w);0!==f&&(x="-"+x),f===_&&0===f?x="0 / 0":t.fillText(b(n.limit,w),r(_),p+s),t.fillText(x,r(f),p+s)}return{restrict:"E",template:'<canvas width="140" height="50">',scope:{data:"=rpLineData"},link:function(e,n,r){var o=n.find("canvas")[0].getContext("2d");t(o,e.data),e.$watch("data",function(){t(o,e.data)},!0)}}}]),e.directive("rpPieChart",["$filter",function(e){function t(e){return"XRP"===e?"XRP":o(e)}function n(e,n){function o(e,n,o,s){function c(e){return function(t,n){return n[e]-t[e]}}function d(e){return function(t){return t[e]}}if(o&&n&&Object.keys(n).length){var l=parseInt(o,10)/1e6,p=[{issuerSubshares:[{issuer:"XRP",subbalance:l}],amountForCurrency:"0"}],f=l;for(var _ in s)if(s.hasOwnProperty(_)){var m,h=s[_].components,g=[];for(m in h)if(h.hasOwnProperty(m)){var v=h[m].to_number();if(v>0){var y=v*(n[_+":"+m]||0);f+=y,g.push({issuer:t(m),subbalance:y})}}g.sort(c("subbalance")),p.push({issuerSubshares:g,amountForCurrency:h[m]})}var b,w,x;for(b=0;b<p.length;b++){x=p[b];var k=0;for(w=0;w<x.issuerSubshares.length;w++){var S=x.issuerSubshares[w];S.subshare=S.subbalance/f,k+=S.subshare}x.share=k,x.currency=r(x.amountForCurrency)}p.sort(c("share")),e.find("*").remove(),e.append("<svg></svg>");var A,T=0,C=!1;for(A=0;A<p.length;A++)if(x=p[A],A>0&&(T+=p[A-1].share),.97>T)a(e,x.issuerSubshares.map(d("subshare")),x.issuerSubshares.map(d("issuer")),"sub",x.currency,T);else if(.999999999999>T){C=!0,a(e,[1-T],["other"],"sub","other",T);break}C&&(p.length=A,p.push({share:1-T,currency:"other"})),a(e,p.map(d("share")),p.map(d("currency")),"main",p.map(d("currency"))),$("<circle></circle>").appendTo(e.find("svg")).attr({"class":"hole",cx:u/2,cy:u/2,r:2*u/9}),e.html(e.html()),e.find("text").each(function(){var e=$(this)[0].getBBox().width,t=$(this).attr("x");$(this).attr("x",t-e/2)});var P=i(e),B=5;e.find("svg")[0].setAttribute("viewBox",[P.left-B,P.top-B,P.right-P.left+2*B,P.bottom-P.top+2*B].join(" ")),e.find("path.main").on("mouseover",function(){var t=$(this).attr("group");e.find(".main text").css("opacity",0),e.find(".main path").css("opacity",.125),$(this).css("opacity",0),e.find('.sub[group="'+t+'"]').css("opacity",1)}).on("mouseout",function(){e.find(".main").css("opacity",1),e.find(".sub").css("opacity",0)})}}function a(e,t,n,r,o,a){var i=2*Math.PI;t.length&&1===t[0]&&(t[0]=.9999),a&&(t.unshift(a),n.unshift("!!!"));var s,c=[],d=0;for(s=0;s<t.length;s++)c.push(t[s]+d),d+=t[s];var l=c.map(function(e){return e*i}),p=[];for(s=0;s<t.length;s++)p.push((c[s-1]||0)+t[s]/2);var f=p.map(function(e){return e*i}),_=[u/2,u/2],m=u/2,h=function(e,t){return[_[0]+e*Math.sin(t),_[1]-e*Math.cos(t)]},g=[];for(s=a?1:0;s<t.length;s++){var v=t[s];if(0!==v){var y=h(m,l[s-1]||0),b=h(m,l[s]),w=h(m+20,f[s]),x={x:w[0],y:w[1]};g.push({path:"M "+_.join(",")+" L "+y.join(",")+" A "+m+","+m+" 0,"+(t[s]>.5?"1":"0")+",1 "+b.join(",")+" Z",labelPosition:x,labelText:n[s],group:"string"==typeof o?o:o[s],share:v})}}var k,S,A=e.find("svg").attr({width:"100%",height:"100%","xmlns:svg":"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/svg"
});for(s=0;s<g.length;s++){k=g[s];var T=k.group.toLowerCase();({xrp:!0,usd:!0,btc:!0,eur:!0,cny:!0,jpy:!0,cad:!0,other:!0}).hasOwnProperty(T)||(T="generic"+(s%2+1)),S=$("<g></g>").appendTo(A).attr({"class":r+" "+T,group:k.group}),$("<path></path>").appendTo(S).attr({d:k.path,"class":r,group:k.group})}for(s=0;s<g.length;s++){k=g[s],S=$("<g></g>").appendTo(A).attr({"class":r+" pielabel",group:k.group}),$("<text></text>").appendTo(S).text(k.labelText).attr({x:k.labelPosition.x,y:k.labelPosition.y,"class":r,group:k.group});var C=Math.round(100*k.share);0===C&&k.share>0&&(C="<1"),$("<text></text>").appendTo(S).text(C+"%").attr({"class":r+" percentage",x:k.labelPosition.x,y:k.labelPosition.y+16,group:k.group})}}function i(e){var t,n,r,o=e.find("svg"),a=[],i=0;do r=c(o.find("g.main.pielabel")),t=r[0],n=r[1],i++;while(n&&10>i);a.push(t);var u={};o.find("g.sub.pielabel").each(function(){u[$(this).attr("group")]=!0});var d,l,p=Object.keys(u);for(d=0;d<p.length;d++){var f=p[d],_=o.find('g.sub.pielabel[group="'+f+'"]');i=0;do r=c(_),l=r[0],n=r[1],i++;while(n&&10>i);a.push(l)}return s(a)}function s(e){for(var t={left:0,right:u,top:0,bottom:u},n=0;n<e.length;n++){var r=e[n];t={left:Math.min(t.left,r.left),right:Math.max(t.right,r.right),top:Math.min(t.top,r.top),bottom:Math.max(t.bottom,r.bottom)}}return t}function c(e){function t(e,t){return function(){var n=$(this).attr(t),r=e[t];$(this).attr(t,n-r/1.9)}}var n=[];e.each(function(){var e=$(this)[0].getBBox();n.push({left:e.x,right:e.x+e.width,top:e.y,bottom:e.y+e.height})});var r,o,a={};for(r=0;r<n.length;r++){var i=n[r];for(o=0;o<n.length;o++)if(r!==o){var c=n[o],u=i.right-c.left,d=i.left-c.right,l=i.bottom-c.top,p=i.top-c.bottom;u>0&&0>d&&l>0&&0>p&&(a[r]||(a[r]={}),a[r][o]||(a[r][o]={}),a[r][o]={x:u>-d?d:u,y:l>-p?p:l})}}for(r in a)if(a.hasOwnProperty(r)){var f=a[r];for(o in f)if(f.hasOwnProperty(o)){var _=f[o],m=$(e[r]);Math.abs(_.x)<Math.abs(_.y)?m.find("text").each(t(_,"x")):m.find("text").each(t(_,"y"))}}return[s(n),!!Object.keys(a).length]}var u=Math.min($(e).height(),$(e).width());u>n.size&&(u=parseInt(n.size,10)),o(e,n.exchangeRates,n.drops,n.ious)}var r=e("rpcurrency"),o=e("rpcontactname");return{restrict:"E",scope:{drops:"=rpDrops",ious:"=rpIous",exchangeRates:"=rpExchangeRates",size:"@rpSize"},link:function(e,t,r){n(t,e),e.$watch("drops",function(){n(t,e)}),e.$on("$balancesUpdate",function(){n(t,e)}),e.$watch("exchangeRates",function(){n(t,e)},!0)}}}])},function(e,t,n){var r=n(18),e=angular.module("fields",[]);e.directive("rpCombobox",[function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,o){function a(e){t.parent()[e?"addClass":"removeClass"]("active"),p[e?"fadeIn":"fadeOut"]("fast")}function i(){var t,i,u=o.$viewValue,d=[],l=null;if(t=e.$eval(n.rpCombobox),"function"!=typeof t&&(t=r.queryFromOptions(t)),"string"==typeof u&&u.length){var p=r.escapeRegExp(u);l=new RegExp("("+p+")","i"),d=t(u,l)}if(n.rpComboboxValueAsOption&&u&&u.length){var f=n.rpComboboxValueAsOptionPrefix;i=f&&0!==u.indexOf(f)?f+u:u,d.push(i)}return n.rpComboboxValueAsRippleName&&u&&u.length&&(i=0!==u.indexOf("~")?"~"+u:u,r.isRippleName(i)&&d.push(i)),d.length?(s(d,l),void c()):void a(!1)}function s(e,n){p.empty(),l=-1,e.forEach(function(e){var r="";"string"==typeof e?val=e:(val=e.name,e.additional&&(r='<span class="additional">'+e.additional+"</span>")),n&&(val=val.replace(n,"<u>$1</u>"));var o=$('<li><span class="val">'+val+"</span>"+r+"</li>");t.parent().find(".completions").append(o)})}function c(){var e=p.children(),n=!!e.length;1===e.length&&e.eq(0).text()===t.val()&&(n=!1),a(n)}function u(){var e=p.find("li");l=Math.max(l,0),l=Math.min(l,e.length-1),e.removeClass("cursor"),e.eq(l).addClass("cursor")}function d(n){var r=$(n).find(".val").text();e.$apply(function(){t.val(r),o.$setViewValue(r),a(!1),t.blur()})}var l=-1;t.wrap('<div class="rp-combobox">'),t.attr("autocomplete","off");var p=$('<ul class="completions"></ul>').hide();if(t.parent().append(p),n.rpComboboxSmall&&t.parent().addClass("rp-combobox-small"),n.rpComboboxSelect){var f=$("<div>").appendTo(t.parent());f.addClass("select"),f.mousedown(function(e){e.preventDefault()}),f.click(function(){var o=e.$eval(n.rpCombobox);if("function"!=typeof o){var a=o;o=r.queryFromOptions(o),e.$watch(a,function(e){s(o())})}s(o()),p.is(":visible")?t.blur():t.focus()})}t.keydown(function(e){if(38===e.which||40===e.which)p.children().length||i(),e.preventDefault(),38===e.which?l--:l++,u();else if(13===e.which){var t=p.find("li.cursor");p.is(":visible")&&(e.preventDefault(),1===p.find("li").length?d(p.find("li")):1===t.length&&d(t))}else 27===e.which&&a(!1)}),t.keyup(function(e){e.which>=37&&e.which<=40||13!==e.which&&27!==e.which&&i()}),t.focus(function(){l=-1,c()}),t.blur(function(){a(!1)}),p.mousedown(function(e){e.preventDefault()}),p.on("click","li",function(){d(this)})}}}]),e.directive("rpDatepicker",[function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){n.$observe("rpDatepicker",function(){var o={format:"mm/dd/yyyy"};if(n.rpDatepickerMin){var a=0;o.onRender=function(e){return e.valueOf()<a?"disabled":""},e.$watch(n.rpDatepickerMin,function(e){if(e instanceof Date){a=e.valueOf();var n=r.$viewValue.valueOf();if("string"==typeof n&&(n=Date.parse(n).valueOf()),a>n){var o=new Date(a+864e5);r.$setViewValue(o),$(t).datepicker("setValue",o)}$(t).data("datepicker").fill()}})}var i=$(t).datepicker(o);i.on("changeDate",function(t){e.$apply(function(){r.$setViewValue(t.date.getMonth()?t.date:new Date(t.date))})}),e.$watch(n.ngModel,function(){function e(e){return"0"==e||"false"==e}var t=r.$viewValue;!e(n.ignoreInvalidUpdate)&&(null==t||t instanceof Date&&isNaN(t.getYear()))})})}}}]),e.directive("fileUploadButton",function(){return{require:"^ngModel",link:function(e,t,n){var r=angular.element(t);r.children()[0];r.css({position:"relative","margin-bottom":14});var o=angular.element('<input type="file" ng-model="walletfile" nwsaveas="wallet.txt" />');o.bind("change",function(){e.$apply(n.fileUploadButton)}),o.css({position:"absolute",top:0,left:0,"z-index":"2",width:"100%",height:"100%",opacity:"0",cursor:"pointer"}),r.append(o)}}})},function(e,t){t.stripRippleAddress=function(e){if("string"==typeof e){var t=e.indexOf("?");if(t>=0)return e.slice(0,t)}return e},t.getDestTagFromAddress=function(e){var t=e.indexOf("?");if(t>=0){if(e=e.slice(t,e.length),t=e.indexOf("dt="),t>=0)return e=e.slice(t+3,e.length),t=e.indexOf("&"),t>0?e.slice(0,t):e;if(t=e.indexOf("d="),t>=0)return e=e.slice(t+2,e.length),t=e.indexOf("&"),t>0?e.slice(0,t):e}return void 0},t.removeClassPrefix=function(e,t){var n=$(e),r=n.attr("class");r&&r.length&&(r=r.split(" ").map(function(e){return 0===e.indexOf(t)?"":e}),n.attr("class",r.join(" ")))},t.getAjaxErrorHandler=function(e,t){return function(t,n,r){switch(n){case"timeout":message="The request timed out.";break;case"notmodified":message="The request was not modified but was not retrieved from the cache.";break;case"parsererror":message="XML/Json format is bad.";break;default:message="HTTP Error ("+t.status+" "+t.statusText+")."}e(new Error(message))}},t.scrollToTop=function(){$("html, body").animate({scrollTop:0},"fast")},t.findIssuer=function(e,t){var n=null,r=0;for(var o in e)if(e.hasOwnProperty(o)&&e[o].currency===t){var a=+e[o].limit.to_text();a>r&&(r=a,n=e[o].account)}return n},t.getContact=function(e,t){if(!t)return!1;for(var n=0;n<e.length;n++)if(e[n].name===t||e[n].address===t)return e[n];return!1},t.isContact=function(e,t){try{for(var n=0,r=e.length;r>n;n++)if(e[n].address===t)return e[n].name}catch(o){}},t.resolveContact=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n].name===t)return e[n].address;return ripple.UInt160.is_valid(t)?ripple.UInt160.json_rewrite(t):""},t.unresolveContact=function(e,n){var r;return(r=t.isContact(e,n))?r:n},t.queryFromContacts=function(e){return t.queryFromOptions(_.map(e,function(e){return{name:e.name,additional:e.view||e.address}}))},t.queryFromOptions=function(e){var n=_.map(e,function(e){return"object"==typeof e||"string"==typeof e?e:null});return t.queryFromArray(n)},t.queryFromOptionsIncludingKeys=function(e){var n=_.map(e,function(e){return"object"==typeof e&&e.value&&"string"==typeof e.value&&e.name&&"string"==typeof e.name?e.value+" - "+e.name:"object"==typeof e||"string"==typeof e?e:null});return t.queryFromArray(n)},t.queryFromArray=function(e){return function(t,n){return n instanceof RegExp?e.filter(function(e){return"string"==typeof e?e.match(n):e.name?e.name.match(n):!1}):e}},t.escapeRegExp=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t.isRippleName=function(e){var t=/^~[a-zA-Z0-9]([\-]?[a-zA-Z0-9]){0,19}$/;return t.test(e)},t.base64ToBase64Url=function(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,"")},t.base64UrlToBase64=function(e){for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4;)e+="=";return e}},function(e,t){var e=angular.module("effects",[]);e.directive("rpAnimate",function(){return{restrict:"A",link:function(e,t,n){("rp-animate"===n.rpAnimate||e.$eval(n.rpAnimate))&&(t=jQuery(t),t.hide(),t.fadeIn(600),t.css("background-color","#E2F5E4"),t.addClass("rp-animate-during rp-animate"),t.animate({"background-color":"#fff"},{duration:600,complete:function(){t.removeClass("rp-animate-during").addClass("rp-animate-after")}}))}}}),e.directive("rpSlide",[function(){return{restrict:"A",link:function(e,t,n){e.$watch(n.rpSlide,function(e,n){if(e===n)return void(e?t.css("maxHeight",""):t.css({maxHeight:0,overflow:"hidden"}));if(e){t.css("maxHeight","");var r=t.height();t.stop().animate({maxHeight:r},350,function(){t.css("maxHeight",""),t.css("overflow","")})}else t.css({maxHeight:t.height(),overflow:"hidden"}),t.stop().animate({maxHeight:0},350)})}}}]),e.directive("rpAutoZoom",[function(){return{restrict:"A",link:function(e,t,n){var r=$(t),o=r.parent(),a=r.find(n.rpAutoZoomRef),i=0,s=function(){if(!(i++>999999)){var e=a.height(),t=r.height(),n=o.width(),c=r.css("zoom"),u=0;r.children().each(function(){u+=$(this).width()}),c||(c=1),u*=c,(t>e||u>n)&&(c*=.95,r.css("zoom",c),s())}},c=null,u=function(){c=null,r.css("zoom",""),s()},d=function(){c&&clearTimeout(c),c=setTimeout(u,100)};e.$watch(function(){return $(t).text()},function(e,t){e!==t&&d()}),$(window).resize(d)}}}])},function(e,t,n){var r=n(18),o=ripple.Base,a=(ripple.Amount,ripple.Currency),e=angular.module("validators",[]);e.directive("rpMasterKey",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var a=function(e){return e&&!o.decode_check(33,e)?void r.$setValidity("rpMasterKey",!1):(r.$setValidity("rpMasterKey",!0),e)};r.$formatters.push(a),r.$parsers.unshift(a),n.$observe("rpMasterKey",function(){a(r.$viewValue)})}}}}),e.directive("rpMasterAddressExists",["$q","$timeout","$http",function(e,t,n){return{restrict:"A",require:"?ngModel",link:function(n,r,a,i){i&&(i.$asyncValidators.rpMasterAddressExists=function(r){if(!r||!o.decode_check(33,r))return e.when(!0);if(r){var a=ripple.Seed.from_json(r).get_key().get_address().to_json(),i=e.defer();return t(function(){rippleVaultClient.AuthInfo.get(Options.domain,a,function(e,t){e&&i.reject(),t.username?(n.masterkeyUsername=t.username,n.masterkeyAddress=a,i.reject()):i.resolve()})},500),i.promise}},a.$observe("rpMasterAddressExists",function(){i.$validate()}))}}}]),e.directive("rpDest",["$q","$timeout","$parse","rpFederation",function(e,t,n,a){var i=/^\S+@\S+\.[^\s.]+$/;return{restrict:"A",require:"?ngModel",link:function(s,c,u,d){function l(e){u.rpDestModel&&(p=n(u.rpDestModel),p.assign(s,e))}if(d){var p,f=null,_=null;d.$asyncValidators.rpDest=function(c){var m=r.stripRippleAddress(c),h=ripple.UInt160.from_json(m);if(("string"!=typeof m||m.length&&"r"!==m[0])&&(h=ripple.UInt160.from_json()),_&&(_.resolve(!0),_=null,t.cancel(f),f=null),d.rpDestType=null,u.rpDestFederationModel&&(p=n(u.rpDestFederationModel),p.assign(s,null)),u.rpDestAddress&&h.is_valid())return d.rpDestType="address",l(c),e.when(!0);if(u.rpDestContact&&s.userBlob&&r.getContact(s.userBlob.data.contacts,m))return d.rpDestType="contact",l(s,r.getContact(s.userBlob.data.contacts,m).address),e.when(!0);if(u.rpDestBitcoin&&!isNaN(o.decode_check([0,5],m,"bitcoin")))return d.rpDestType="bitcoin",l(c),e.when(!0);if(u.rpDestEmail&&i.test(m))return d.rpDestType="email",u.rpDestCheckFederation?a.check_email(c).then(function(e){return c==d.$viewValue?(l(c),u.rpDestFederationModel&&(p=n(u.rpDestFederationModel),p.assign(s,e)),!0):void 0},function(){return!1}):(l(c),e.when(!0));if(u.rpDestRippleName&&r.isRippleName(c)||u.rpDestRippleNameNoTilde&&c&&"~"!==c[0]&&r.isRippleName("~"+c)){d.rpDestType="rippleName";var g=e.defer();return _=g,f=t(function(){f=null,_=null,rippleVaultClient.AuthInfo.get(Options.domain,c,function(e,t){s.$apply(function(){t.exists?(l(t.address),g.resolve(t.exists)):g.reject()})})},500),g.promise}return e.reject(!1)},u.$observe("rpDest",function(){d.$validate()})}}}}]),e.directive("rpAvailableName",["$q","$timeout","$parse",function(e,t,n){return{restrict:"A",require:"?ngModel",link:function(n,r,o,a){a&&(a.$asyncValidators.rpAvailableName=function(r){if(n.usernameInvalidReason="",n.usernameReservedFor="",!r)return e.when(!0);if(r.length<2)n.usernameInvalidReason="tooshort";else if(r.length>20)n.usernameInvalidReason="toolong";else if(/^[a-zA-Z0-9\-]+$/.exec(r))if(/^-/.exec(r))n.usernameInvalidReason="starthyphen";else if(/-$/.exec(r))n.usernameInvalidReason="endhyphen";else{if(!/--/.exec(r)){var o=e.defer();return t(function(){rippleVaultClient.AuthInfo.get(Options.domain,r,function(e,t){n.$apply(function(){t.exists?(n.usernameInvalidReason="exists",o.reject("exists")):t.reserved?(n.usernameInvalidReason="reserved",n.usernameReservedFor=t.reserved,o.reject("reserved")):o.resolve()})})},500),o.promise}n.usernameInvalidReason="multhyphen"}else n.usernameInvalidReason="charset";return e.reject(!1)},o.$observe("rpAvailableName",function(e){a.$validate()}))}}}]),e.directive("rpStdt",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){return!e||!isNaN(parseFloat(e))&&isFinite(e)&&e>=0&&e<Math.pow(2,32)-1?(r.$setValidity("rpStdt",!0),e):void r.$setValidity("rpStdt",!1)};r.$formatters.push(o),r.$parsers.unshift(o),n.$observe("rpStdt",function(){o(r.$viewValue)})}}}}),e.directive("rpInvoiceId",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){return!e||e.length<=64?(r.$setValidity("rpInvoiceId",!0),e):void r.$setValidity("rpInvoiceId",!1)};r.$formatters.push(o),r.$parsers.unshift(o),n.$observe("rpInvoiceId",function(){o(r.$viewValue)})}}}}),e.directive("rpNotMe",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,o){if(o){var a=function(t){var n=r.getContact(e.userBlob.data.contacts,t);return t&&(n&&n.address===e.userBlob.data.account_id||e.userBlob.data.account_id===t)?void o.$setValidity("rpNotMe",!1):(o.$setValidity("rpNotMe",!0),t)};o.$formatters.push(a),o.$parsers.unshift(a),n.$observe("rpNotMe",function(){a(o.$viewValue)})}}}}),e.directive("rpIssuer",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,o){if(o){var a=function(t){if(!t)return void o.$setValidity("rpIssuer",!1);var n=t.slice(0,3).toUpperCase();return"XRP"===n||r.findIssuer(e.lines,n)?(o.$setValidity("rpIssuer",!0),t):void o.$setValidity("rpIssuer",!1)};o.$formatters.push(a),o.$parsers.unshift(a),n.$observe("rpIssuer",function(){a(o.$viewValue)})}}}}),e.directive("rpSameInSet",[function(){return{require:"ngModel",link:function(e,t,n,r){function o(e){var t=e!==r.$modelValue?r.$modelValue:e!==r.$viewValue?r.$viewValue:e;return e!==t&&(a[t]=(a[t]||1)-1,0===a[t]&&delete a[t],e&&(a[e]=(a[e]||0)+1)),e}var a=e.$eval(n.rpSameInSet);r.$formatters.push(o),r.$parsers.push(o),e.$watch(function(){return 1===_.size(a)},function(e){r.$setValidity("rpSameInSet",e)})}}}]),e.directive("rpUnique",function(){var e={},t=function(e){return function(t){return e.apply(this,t)}};return{restrict:"A",require:"?ngModel",link:function(n,r,o,a){if(a){var c;if(o.rpUniqueGroup){var u;u=r.inheritedData(s)||e,u[o.rpUniqueGroup]||(u[o.rpUniqueGroup]=[]),c=u[o.rpUniqueGroup],c.push([n,r,o,a])}else c=[[n,r,o,a]];var d=function(e){_.forEach(c,t(function(t,n,r,o){o.$setValidity("rpUnique",e)}))},p=function(e,t){return e===t?!0:null!==e&&void 0!==e&&""!==e||null!==t&&void 0!==t&&""!==t?!1:!0},f=function(e){var r=a,s=n.$eval(o.rpUnique)||[],u=_.every(c,t(function(t,n,o,a){return o.rpUniqueOrig&&p(a===r?e:a.$viewValue,t.$eval(o.rpUniqueOrig))}));if(u)d(!0);else if(o.rpUniqueField){var f=function(n){return _.every(c,t(function(t,o,a,i){return p(s[n][a.rpUniqueField],i===r?e:i.$viewValue)}))};for(i=0,l=s.length;i<l;i++){if(f(i))return d(!1),e;d(!0)}}else a.$setValidity("rpUnique",-1===s.indexOf(e));return e};a.$formatters.push(f),a.$parsers.unshift(f),n.$watch(o.rpUnique,function(){f(a.$viewValue)},!0)}}}});var s="rp-unique-scope";e.directive("rpUniqueScope",function(){return{restrict:"EA",link:{pre:function(e,t){t.data(s,{})}}}}),e.directive("rpStrongPassword",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(t){var n=0,o=""+e.username;return t?t.length<6?(r.$setValidity("rpStrongPassword",!1),void(e.strength="weak")):t.toLowerCase()===o.toLowerCase()?(r.$setValidity("rpStrongPassword",!1),void(e.strength="match")):(checkRepetition=function(e,t){for(var n="",r=0;r<t.length;r++){for(var o=!0,a=0;e>a&&a+r+e<t.length;a++)o=o&&t.charAt(a+r)===t.charAt(a+r+e);e>a&&(o=!1),o?(r+=e-1,o=!1):n+=t.charAt(r)}return n},n+=4*t.length,n+=1*(checkRepetition(1,t).length-t.length),n+=1*(checkRepetition(2,t).length-t.length),n+=1*(checkRepetition(3,t).length-t.length),n+=1*(checkRepetition(4,t).length-t.length),t.match(/(.*[0-9].*[0-9].*[0-9])/)&&(n+=5),t.match(/(.*[!,@,#,$,%,&,*,?,_,~].*[!,@,#,$,%,&,*,?,_,~])/)&&(n+=5),t.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(n+=10),t.match(/([a-zA-Z])/)&&t.match(/([0-9])/)&&(n+=15),t.match(/([!,@,#,$,%,&,*,?,_,~])/)&&t.match(/([0-9])/)&&(n+=15),t.match(/([!,@,#,$,%,&,*,?,_,~])/)&&t.match(/([a-zA-Z])/)&&(n+=15),(t.match(/^\w+$/)||t.match(/^\d+$/))&&(n-=10),0>n&&(n=0),n>100&&(n=100),34>n?(r.$setValidity("rpStrongPassword",!1),void(e.strength="weak")):(r.$setValidity("rpStrongPassword",!0),68>n?(e.strength="medium",t):(e.strength="strong",t))):(e.strength="",t)};r.$formatters.push(o),r.$parsers.unshift(o),n.$observe("rpStrongPassword",function(){o(r.$viewValue)})}}}}),e.directive("rpAmount",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){e&&-1!=e.toString().indexOf(",")&&(e=e.split(",").join(""));var t=/^(([0-9]*?\.\d+)|([0-9]\d*))$/.test(e);return t&&"."==e[0]&&(e="0"+e),r.$setValidity("rpAmount",t),e};r.$formatters.push(o),r.$parsers.unshift(o)}}}}),e.directive("rpAmountPositive",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){return r.$setValidity("rpAmountPositive",e>0),e};r.$formatters.push(o),r.$parsers.unshift(o)}}}}),e.directive("rpAmountXrpLimit",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){var t=a.from_human(n.rpAmountCurrency.slice(0,3)).get_iso();return"XRP"!==t?r.$setValidity("rpAmountXrpLimit",!0):r.$setValidity("rpAmountXrpLimit",1e11>=e&&e>=1e-6),e};r.$formatters.push(o),r.$parsers.unshift(o)}}}}),e.directive("rpMaxDigits",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){var t=a.from_human(n.rpAmountCurrency.slice(0,3)).get_iso();if("XRP"===t)r.$setValidity("rpMaxDigits",!0);else{var o=/^(?:(?=.{2,17}$)\d+\.\d+|\d{1,16})$/.test(e);r.$setValidity("rpMaxDigits",o)}return e};r.$formatters.push(o),r.$parsers.unshift(o),n.$observe("rpAmountCurrency",function(){o(r.$viewValue)})}}}}),e.directive("rpRestrictCurrencies",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){var t=/^([a-zA-Z0-9]{3}|[A-Fa-f0-9]{40})\b/.exec(e);return n.rpRestrictCurrencies?t?r.$setValidity("rpRestrictCurrencies",-1!=n.rpRestrictCurrencies.indexOf(t[1])?!0:"XRP"===e):r.$setValidity("rpRestrictCurrencies",!1):r.$setValidity("rpRestrictCurrencies",!0),e};r.$formatters.push(o),r.$parsers.unshift(o)}}}}),e.directive("rpPortNumber",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){return r.$setValidity("rpPortNumber",!e||parseInt(e,10)==e&&e>=1&&65535>=e),e};r.$formatters.push(o),r.$parsers.unshift(o),n.$observe("rpPortNumber",function(){o(r.$viewValue)})}}}}),e.directive("rpNotXrp",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=function(e){return r.$setValidity("rpNotXrp",!e||"xrp"!==e.toLowerCase()),e};r.$formatters.push(o),r.$parsers.unshift(o),n.$observe("rpNotXrp",function(){o(r.$viewValue)})}}}}),e.directive("rpEmail",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var o=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,a=function(e){return r.$setValidity("rpEmail",o.test(e)),e};r.$formatters.push(a),r.$parsers.unshift(a),n.$observe("rpEmail",function(){a(r.$viewValue)})}}}})},function(e,t,n){!function(){"use strict";function e(e,n,r,o){return{restrict:"A",require:"?ngModel",link:function(n,a,i,s){if(s){var c=null,u=null;s.$asyncValidators.rpAccountExists=function(a){function i(e){return e.then(function(e){if(e===!1)return o.when(!0);var t=ripple.UInt160.from_json(e);if(t.is_valid()){var n=o.defer();return r.remote.requestAccountInfo({account:e}).on("success",function(e){n.resolve(!0)}).on("error",function(e){e&&e.remote&&"actNotFound"===e.remote.error?n.reject(!1):(console.log("There was an error",e),n.resolve(!0))}).request(),n.promise}return o.when(!0)})}var s=t.stripRippleAddress(a),d=ripple.UInt160.from_json(s);if(u&&(u.resolve(!0),u=null,e.cancel(c),c=null),d.is_valid())return i(o.when(a));if(n.userBlob&&t.getContact(n.userBlob.data.contacts,s))return i(o.when(t.getContact(n.userBlob.data.contacts,s).address));if(t.isRippleName(a)){var l=o.defer();return u=l,c=e(function(){c=null,u=null,rippleVaultClient.AuthInfo.get(Options.domain,a,function(e,t){t&&t.exists&&t.address?l.resolve(t.address):l.resolve(!1)})},500),i(l.promise)}return o.when(!0)},i.$observe("rpAccountExists",function(){s.$validate()})}}}}var t=n(18);angular.module("validators").directive("rpAccountExists",e),e.$inject=["$timeout","$parse","rpNetwork","$q"]}()},function(e,t){var e=angular.module("events",[]);e.directive("ngEnter",function(){return function(e,t,n){t.bind("keypress",function(t){13===t.charCode&&e.$apply(n.ngEnter)})}})},function(e,t,n){var r=n(18),o=ripple.Amount,a=ripple.Currency,e=angular.module("formatters",["domainalias"]);e.directive("rpPrettyIssuer",["rpDomainAlias",function(e){return{restrict:"EA",scope:{issuer:"=rpPrettyIssuer",contacts:"=rpPrettyIssuerContacts"},template:"{{alias || name || issuer}}",compile:function(t,n,o){return function(t,n,o){function a(){if(!t.issuer)return void(t.alias=o.rpPrettyIssuerDefault?o.rpPrettyIssuerDefault:"???");var n=e.getAliasForAddress(t.issuer);t.alias=null,n.then(function(e){t.alias=e}),t.name=null,t.contacts&&(t.name=r.isContact(t.contacts,t.issuer)),!t.name&&o.rpPrettyIssuerOrShort&&(t.name=""+t.issuer.substring(0,7)+"…")}t.$watch("issuer",a),t.$watch("contacts",a,!0),a()}}}}]);var i="rp-pretty-amount-date";e.directive("rpPrettyAmount",[function(){return{restrict:"EA",scope:{amount:"=rpPrettyAmount"},template:'<span class="value">{{amount | rpamount:{reference_date:date} }}</span> <span class="currency" rp-currency="amount"></span>',compile:function(e,t,n){return function(e,t,n){e.date=e.date||t.inheritedData(i)}}}}]),e.directive("rpPrettyAmountHighPrecision",[function(){return{restrict:"EA",scope:{amount:"=rpPrettyAmountHighPrecision"},template:'<span class="value">{{amount | rpamount:{reference_date:date, abs_precision: 6} }}</span> <span class="currency" rp-currency="amount"></span>',compile:function(e,t,n){return function(e,t,n){e.date=e.date||t.inheritedData(i)}}}}]),e.directive("rpPrettyAmountDate",[function(){return{restrict:"EA",compile:function(e,t,n){return function(e,t,n){t.data(i,e.$eval(n.rpPrettyAmountDate))}}}}]),e.directive("rpPrettyIdentity",[function(){return{restrict:"EA",scope:{identity:"=rpPrettyIdentity"},template:"{{identity | rpcontactnamefull | rpripplename:{tilde:true} }}",compile:function(e,t,n){return t.rpPrettyIdentityFilters&&e.text("{{identity | "+t.rpPrettyIdentityFilters+" }}"),function(e,t,n){}}}}]),e.directive("rpRippleName",["rpId",function(e){return{restrict:"EA",scope:{address:"=rpRippleName"},template:"{{name || address}}",compile:function(t,n,r){return function(t,n,r){function o(){e.resolveName(t.address,{tilde:!0}).then(function(e){t.name=e})}t.$watch("address",o),o()}}}}]),e.directive("rpBindColorAmount",function(){return{restrict:"A",compile:function(){return function(e,t,n){e.$watch(n.rpBindColorAmount,function(e){if(e){var n=e.split(".");if(2===n.length){var r=n[1].replace(/(0+)$/,'<span class="insig">$1</span>');r='<span class="decimalPart">.'+r+"</span>",t[0].innerHTML=r.length>0?n[0]+r:n[0]}}})}}}}),e.directive("rpCurrency",function(){return{restrict:"A",compile:function(e,t,n){return function(e,t,n){e.$watch(n.rpCurrency,function(r){var i,s;if(r instanceof a)i=r;else{var c=o.from_json(r);i=c.currency()}if(s=i.to_human(),n.rpCurrencyFull){var u=$.grep(e.currencies_all,function(e){return e.value==s})[0];u&&(s=u.value+" - "+u.name)}if(i.has_interest()){var d=i._interest_start+31536e3,l=i.get_interest_at(d);l=Math.round(1e4*l-1e4)/100;var p;p=l>0?"Interest: "+l+" %/yr":"Fee: "+-l+"%/yr";var f=$("<abbr></abbr>").attr("title",p).text(s);t.empty().append(f)}else t.empty().text(s)})}}}})},function(e,t,n){(function(e){var t=angular.module("directives",["popup"]);t.directive("inlineEdit",function(){var e='<span ng-hide="mode">{{model}}</span>',t='<input ng-show="mode" ng-model="model" />';return{restrict:"E",scope:{model:"=",mode:"="},template:e+t}}),t.directive("rpConfirm",["rpPopup","$parse",function(e,t){return{restrict:"E",link:function(n,r,o){var a={};r.find("a,button").click(function(r){r.preventDefault();var i=o.rpShow?t(o.rpShow)(n):!0;i&&e.confirm(o.title,o.actionText,o.actionButtonText,o.actionFunction,o.actionButtonCss,o.cancelButtonText,o.cancelFunction,o.cancelButtonCss,n,a)})}}}]),t.directive("rpPopup",["rpPopup","$parse",function(e,t){return{restrict:"E",link:function(n,r,o){var a=r.find("a[rp-popup-link]");a.click(function(a){a.preventDefault();var i=function(t){27===t.which&&($(document).off("keyup",i),e.close())};$(document).on("keyup",i),o.rpPopupOnOpen&&t(o.rpPopupOnOpen)(n);var s=r.find("[rp-popup-content]"),c=(new XMLSerializer).serializeToString(s[0]);e.blank(c,n),o.onopen&&n[o.onopen]&&n[o.onopen]()})}}}]),t.directive("rpInboundBridgeLimit",[function(){return{restrict:"E",scope:{limit:"="},template:"<span> {{limit}} BTC </span>",compile:function(e,t){e.addClass("test")}}}]),t.directive("rpDownload",[function(){return{restrict:"A",scope:{data:"=rpDownload",filename:"@rpDownloadFilename",isCsv:"@rpDownloadCsv",clickHandler:"@ngClick"},compile:function(t,n,r){return function(t,n,r){var o=n.find("[rp-download-trigger]");o.length||(o=n),"download"in document.createElement("a")?(t.$watch("data",function(e){t.isCsv?o.attr("href",e?"data:text/csv;charset=utf-8,"+escape(e):""):o.attr("href","data:text/plain,"+e)}),t.$watch("filename",function(e){o.attr("download",e)})):swfobject.hasFlashPlayerVersion("10.0.0")&&(n.css("position","relative"),e(function(){var e=o.innerWidth(),r=o.innerHeight(),a=o.offset(),i=n.offset(),s=a.top-i.top,c=a.left-i.left,u=Downloadify.create(n[0],{filename:function(){return t.filename},data:function(){return t.clickHandler&&o.trigger("click"),t.data},transparent:!0,swf:"swf/downloadify.swf",downloadImage:"img/transparent_l.gif",width:e,height:r,append:!0}),d=u.flashContainer.id;$("#"+d).css({position:"absolute",top:s+"px",left:c+"px"})}))}}}}]),t.directive("rpTooltip",[function(){return function(e,t,n){n.$observe("rpTooltip",function(e){var r={title:e};n.rpTooltipPlacement&&(r.placement=n.rpTooltipPlacement),$(t).tooltip("destroy"),$(t).tooltip(r)})}}]),t.directive("rpPopover",["$interpolate",function(e){return function(t,n,r){var o=function(){return e(r.rpPopoverContent)(t)};r.rpPopoverTrigger||(r.rpPopoverTrigger="click");var a={html:!0,placement:r.rpPopoverPlacement,trigger:r.rpPopoverTrigger};if(r.rpPopoverTitle?a.title=r.rpPopoverTitle:a.template='<div class="popover"><div class="arrow"></div><div class="popover-inner"><div class="popover-content" ></div></div></div>',r.rpPopoverContent&&(a.content=o),r.rpPopoverDelay){var i=r.rpPopoverDelay;"number"!=typeof i&&(i=500),a.delay={show:i,hide:1e3}}$(n).popover(a),$("html").click(function(){$(n).popover("hide")}),$(n).click(function(e){e.stopPropagation()})}}]),t.directive("rpNamePopover",[function(){return function(e,t,n){var r={html:!0,placement:n.rpNamePopoverPlacement,trigger:"manual"};r.template='<div class="popover"><div class="arrow"></div><div class="popover-inner"><div class="popover-content" ></div></div></div>',n.rpPopoverContent&&(r.content=n.content),$(t).popover(r),$(t).mouseenter(function(){$(t).popover("show")}),$("html").click(function(){$(t).popover("hide")})}}]),t.directive("rpAutofill",["$parse",function(e){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){r&&e.$watch(n.rpAutofill,function(o){if(o){if(n.rpAutofillAmount||n.rpAutofillCurrency){o===""+parseInt(o,10)&&(o+="/XRP");var a=function(t){return n.rpAutofillCurrencyFullname?e.currencies_all_keyed[t.get_iso()]?t.to_human({full_name:e.currencies_all_keyed[t.get_iso()].name}):t.to_human():t.to_json()},i=ripple.Amount.from_json(o);if(i.is_valid())o=n.rpAutofillAmount?i.to_human({group_sep:!1}):a(i.currency());else{var s=ripple.Currency.from_json(o);if(!s.is_valid())return;o=a(s)}}t.val(o),r.$setViewValue(o),e.$eval(n.rpAutofillOn)}},!0)}}}]),t.directive("rpSelectEl",[function(){return{restrict:"A",scope:{target:"@rpSelectEl"},link:function(e,t,n){t.click(function(){var t=document,n=t.getElementById(e.target);if(t.body.createTextRange){var r=t.body.createTextRange();r.moveToElementText(n),r.select()}else if(window.getSelection){var o=window.getSelection(),a=t.createRange();a.selectNodeContents(n),o.removeAllRanges(),o.addRange(a)}})}}}]),t.directive("rpNoPropagate",[function(){return{restrict:"A",link:function(e,t,n){t.click(function(e){e.stopPropagation()})}}}]),t.directive("rpSpinner",[function(){return{restrict:"A",require:"^form",link:function(e,t,n,r){var o=null;e.$watch(r.$name+"."+t.attr("name")+".$pending",function(e){t.removeClass("spinner"),o&&(o.stop(),o=null),e&&(o=new Spinner({lines:9,length:3,width:2,radius:4,className:"spinnerInner"}),t.is("input")?(t.after('<div class="inputSpinner"></div>'),o.spin(t.parent().find(".inputSpinner")[0])):(t.addClass("spinner"),o.spin(t[0])))})}}}]),t.directive("ngUpload",function(){return{restrict:"A",link:function(e,t,n){var r={};if(r.enableControls=n.uploadOptionsEnableControls,n.ngUpload){t.attr("target","upload_iframe"),t.attr("method","post"),t.attr("action",t.attr("action")+"?_t="+(new Date).getTime()),t.attr("enctype","multipart/form-data"),t.attr("encoding","multipart/form-data");var o=n.ngUpload.split("(")[0],a=e.$eval(o);if(null===a||void 0===a||!angular.isFunction(a)){var i="The expression on the ngUpload directive does not point to a valid function.";throw i+"\n"}var s=function(n){var r=$("<iframe id='upload_iframe' name='upload_iframe' border='0' width='0' height='0' style='width: 0px; height: 0px; border: none; display: none' />");r.bind("load",function(){var t=r.contents().find("body").text();e.$apply(function(){a(t,""!==t)}),""!==t&&setTimeout(function(){r.remove()},250),n.attr("disabled",null),n.attr("title","Click to start upload.")}),t.parent().append(r)};$(".upload-submit",t).click(function(){s($(this)),e.$apply(function(){a("Please wait...",!1)});var n=!0;(null===r.enableControls||void 0===r.enableControls||r.enableControls.length>=0)&&($(this).attr("disabled","disabled"),
n=!1),$(this).attr("title",(n?"[ENABLED]: ":"[DISABLED]: ")+"Uploading, please wait..."),$(t).submit()}).attr("title","Click to start upload.")}else console.log("No callback function found on the ngUpload directive.")}}}),t.directive("rpFocus",["$timeout",function(e){return function(t,n){e(function(){t.$watch(function(){return n.is(":visible")},function(e){e===!0&&n.focus()})})}}]),t.directive("rpOffCanvasMenu",function(){return{restrict:"A",link:function(e,t,n){t.find("h2").click(function(){t.parent().toggleClass("off-canvas-nav-expand")})}}}),t.directive("rpSnapper",["rpId",function(t){return function(n){var r=n.$watch(function(){return t.loginStatus},function(){var n;if(t.loginStatus){e(function(){n=new Snap({element:document.getElementById("wrapper"),disable:"right"}),o(),$(".snapper-toggle").click(function(){"closed"==n.state().state?n.open("left"):n.close()}),$(".mobile-nav").find("a").click(function(){n.close()})}),$(window).resize(function(){o()});var o=function(){"object"==typeof n&&($(window).width()>767?(n.close(),n.disable()):($(".mobile-nav").show(),n.enable()))};r()}})}}]),t.directive("rpSpanSpacing",[function(){return{restrict:"EA",compile:function(e,t,n){e.find("> span").before(" ").after(" ")}}}]),t.directive("rpSortHeader",["$timeout","$parse",function(e,t){return{restrict:"A",compile:function(e,n,r){return function(e,n,r){function o(e,t){var r=n.find("i");r.toggleClass("sorted",e),r.toggleClass("fa-caret-up",t),r.toggleClass("fa-caret-down",!t)}function a(){var t=s(e);t==u&&o(!0,!c(e))}function i(){var t=s(e);if(t!=u)s.assign(e,u),c.assign(e,!0),o(!0,!1);else{var n=c(e);c.assign(e,!n)}}if(r.rpSortHeaderField){var s=t(r.rpSortHeader),c=t(r.rpSortHeaderReverse),u=r.rpSortHeaderField;a();var d=e.$watch(r.rpSortHeader,function(){s(e)!=u?o(!1,!1):n.find("span").addClass("sorted")}),l=e.$watch(r.rpSortHeaderReverse,a);n.click(function(t){e.$apply(i)}),e.$on("$destroy",function(){d(),l()})}}}}}])}).call(t,n(15).setImmediate)},function(e,t){!function(){function e(e,t,n,r,o,a,i){this.$timeout=e,this.$parse=r,this.scope=o,this.element=a,this.cancelHidePopoverTimeout=null,this.cancelShowPopoverTimeout=null,this.tip=null,this.shown=!1,this.identity="",this.summ="",this.rippleName="",this.rpamountFilter=n("rpamount"),this.popoverCreated=!1,this.rpAddressPopoverSum=i.rpAddressPopoverSum,this.rpAddressPopoverSumMinus=i.rpAddressPopoverSumMinus,i.rpAddressPopover&&"rp-address-popover"!=i.rpAddressPopover&&(this.identity=r(i.rpAddressPopover)(o)),this.onPopoverEnterBound=null,this.onPopoverLeaveBound=null,this.onElemLeaveBound=null,this.onElemEnterBound=this.onElemEnter.bind(this),a.bind("mouseenter",this.onElemEnterBound);var s=this;i.rpAddressPopoverLinkToCharts&&t.resolveName(this.identity,{tilde:!0}).then(function(e){if(s.rippleName=e,s.popoverCreated){var t=a.data("popover");t&&(t.options.content=s.makeContent(),t.setContent())}}),o.$on("$destroy",function(){e.cancel(s.cancelHidePopoverTimeout),s.cancelHidePopoverTimeout=null,e.cancel(s.cancelShowPopoverTimeout),s.cancelShowPopoverTimeout=null,s.unbindHanlders(),s.tip&&(s.tip.remove(),s.tip=null),this.scope=null,this.element=null,this.onPopoverEnterBound=null,this.onPopoverLeaveBound=null,this.onElemLeaveBound=null,this.onElemEnterBound=null})}function t(t,n,r,o,a){return a("templates/"+window.lang+"/directives/addresspopover.html",!1).then(function(t){var n=t.split("<br/>");e.textRippleAddress=n[0],e.textShowInGraph=n.length>1?n[1]:e.textShowInGraph}),{restrict:"A",replace:!1,compile:function(a,i,s){return function(a,i,s){new e(t,n,r,o,a,i,s)}}}}e.popupDelay=800,e.hideDelay=700,e.summFilterOpts={force_precision:100,min_precision:2},e.prototype.create=function(){if(this.rpAddressPopoverSum){var t=this.$parse(this.rpAddressPopoverSum)(this.scope);t=this.rpamountFilter(t,e.summFilterOpts),t!=this.summ&&(this.rpAddressPopoverSumMinus&&"n/a"!=t&&(t="-"+t),this.summ=t)}var n={content:this.makeContent(),html:!0,trigger:"manual",placement:"top",container:"body",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"></div></div></div>'};this.element.popover(n);this.tip=this.element.data("popover").tip(),this.onPopoverEnterBound=this.onPopoverEnter.bind(this),this.tip.bind("mouseenter",this.onPopoverEnterBound),this.onPopoverLeaveBound=this.onPopoverLeave.bind(this),this.tip.bind("mouseleave",this.onPopoverLeaveBound),this.popoverCreated=!0},e.prototype.makeContent=function(){var t=["<div>"];return this.summ&&t.push("<div>",String(this.summ),"</div>"),this.rippleName?(this.rippleName!==this.identity&&t.push("<div>",this.rippleName,"</div>"),t.push("<span>",this.identity,"</span>","<br/>"),t.push('<a target="_blank", href="http://www.ripplecharts.com/#/graph/',this.identity,'" >',e.textShowInGraph,"</a>")):this.identity&&t.push(e.textRippleAddress," ",this.identity),t.push("</div>"),t.join("")},e.prototype.showPopover=function(){this.popoverCreated||this.create();var e=this;this.$timeout(function(){e.element.popover("show"),e.shown=!0},10,!1)},e.prototype.hidePopover=function(){if(!this.cancelHidePopoverTimeout){var t=this;this.cancelHidePopoverTimeout=this.$timeout(function(){t.element.popover("hide"),t.shown=!1},e.hideDelay,!1),this.cancelHidePopoverTimeout["finally"](function(){t.cancelHidePopoverTimeout=null})}},e.prototype.onPopoverEnter=function(){this.cancelShowPopoverTimeout&&(this.$timeout.cancel(this.cancelShowPopoverTimeout),this.cancelShowPopoverTimeout=null),this.cancelHidePopoverTimeout&&(this.$timeout.cancel(this.cancelHidePopoverTimeout),this.cancelHidePopoverTimeout=null)},e.prototype.onPopoverLeave=function(){this.hidePopover()},e.prototype.onElemEnter=function(){this.onElemLeaveBound||(this.onElemLeaveBound=this.onElemLeave.bind(this),this.element.bind("mouseleave",this.onElemLeaveBound)),this.cancelHidePopoverTimeout?(this.$timeout.cancel(this.cancelHidePopoverTimeout),this.cancelHidePopoverTimeout=null):this.cancelShowPopoverTimeout||(this.cancelShowPopoverTimeout=this.$timeout(this.showPopover.bind(this),e.popupDelay,!1),this.cancelShowPopoverTimeout["finally"](this.onCancelShowPopoverTimeoutFinally.bind(this)))},e.prototype.onCancelShowPopoverTimeoutFinally=function(){this.cancelShowPopoverTimeout=null},e.prototype.onElemLeave=function(){this.cancelShowPopoverTimeout?(this.$timeout.cancel(this.cancelShowPopoverTimeout),this.cancelShowPopoverTimeout=null):this.shown&&this.hidePopover()},e.prototype.unbindHanlders=function(){this.element.unbind("mouseenter",this.onElemEnterBound),this.element.unbind("mouseleave",this.onElemLeaveBound),this.tip&&(this.tip.unbind("mouseenter",this.onPopoverEnterBound),this.tip.unbind("mouseleave",this.onPopoverLeaveBound))},e.textRippleAddress="span(l10n) Ripple address",e.textShowInGraph="span(l10n) Show in graph",angular.module("directives").directive("rpAddressPopover",t),t.$inject=["$timeout","rpId","$filter","$parse","$templateRequest"]}()},function(e,t){var e=angular.module("datalinks",[]);e.directive("rpLinkTx",["$location",function(e){return{restrict:"A",link:function(t,n,r){var o;t.$watch(r.rpLinkTx,function(e){o="/tx?id="+e}),n.click(function(){t.$apply(function(){o&&e.url(o)})})}}}])},function(e,t){var e=angular.module("errors",[]);e.directive("rpTransactionStatus",function(){return{restrict:"E",templateUrl:"templates/"+lang+"/directives/transactionerror.html",scope:{engine_result:"@rpEngineResult",engine_result_message:"@rpEngineResultMessage",accepted:"@rpAccepted",tab:"@rpCurrentTab"},link:function(e,t,n){}}})},function(e,t){var e=angular.module("marketchart",[]);e.directive("rpMarketChart",[function(){var e=1;return{restrict:"E",template:"",link:function(t,n,r){var o=$(n[0]),a=!1,i=function(){if(r.baseCurrency&&r.counterCurrency){var t=new Date;if(t.setDate(t.getDate()-1),!a){var n=o.attr("id");n||(n="marketchart-"+e++,o.attr("id",n)),a=PriceChartWidget({id:n,width:o.width()-120,height:o.height()-30,margin:{top:10,right:70,bottom:20,left:50},resize:!0})}var i={base:{currency:r.baseCurrency,issuer:r.baseCurrencyIssuer?r.baseCurrencyIssuer:null},counter:{currency:r.counterCurrency,issuer:r.counterCurrencyIssuer?r.counterCurrencyIssuer:null},multiple:5,start:t,end:new Date,interval:"minute",theme:"light",type:"line"};a.load(i),o.find("img")[0].src="img/sections.png"}};r.$observe("baseCurrency",i),r.$observe("baseCurrencyIssuer",i),r.$observe("counterCurrency",i),r.$observe("counterCurrencyIssuer",i)}}}])},function(e,t,n){var e=angular.module("filters",[]),r=n(18),o=ripple.Amount,a=ripple.Currency,i=ripple.Base,s=n(13);e.filter("rpamount",function(){return function(e,t){var n,r=jQuery.extend(!0,{},t);if("number"==typeof r?r={rel_min_precision:r}:"object"!=typeof r&&(r={}),!e)return"n/a";r.xrp_human&&e===""+parseInt(e,10)&&(e+="/XRP");var a=r.precision;r.reference_date||r.no_interest||(r.reference_date=new Date),!r.hard_precision&&e._is_native&&(n=s[0].standard_precision,r.min_precision=n,r.precision=n);var i=o.from_json(e);if(!i.is_valid())return"n/a";if(r.force_precision)return r.precision=r.force_precision,i.to_human(r);if(r.abs_precision)return r.min_precision=r.abs_precision,r.precision=r.abs_precision,i.to_human(r);if(!r.hard_precision)for(var c=0;c<s.length;c++)if(s[c].value===i.currency().to_human()){n=s[c].standard_precision,r.min_precision=n,r.precision=n;break}var u=i.to_human();(.01>u&&u>0||"number"==typeof r.tiny_precision&&.1>u)&&(r.precision=15);var d="undefined"!=typeof n?n:4;"number"==typeof r.rel_precision&&(r.precision=d+r.rel_precision),"number"==typeof r.rel_min_precision&&(r.min_precision=d+r.rel_min_precision);var l=i.to_human(r);if("number"==typeof r.tiny_precision){var p=!1,f=l.split(".");if(+f[0].replace(",","")>=1)r.hard_precision&&(r.precision=a,p=!0);else{var _=f[1];if(_&&_.length>r.tiny_precision){var m=/^0*/,h=m.exec(_),g=h[0].length;g&&(r.precision=g+r.tiny_precision,p=!0)}}p&&(l=i.to_human(r))}return l}}),e.filter("rpcurrency",function(){return function(e){if(!e)return"";var t;if(e instanceof a)t=e;else{var n=o.from_json(e);t=n.currency()}return t.to_human()}}),e.filter("rpissuer",function(){return function(e){if(!e)return"";var t=o.from_json(e);return t.is_valid()&&t.issuer().is_valid()?t.issuer().to_json():""}}),e.filter("rpcurrencyfull",["$rootScope",function(e){return function(t){if(!t)return"";var n=o.from_json(t),r=$.grep(e.currencies_all,function(e){return e.value==n.currency().to_human()})[0];return r?r.name:n.currency().to_human()}}]),e.filter("rpamountratio",function(){return function(e,t){try{return o.from_json(e).ratio_human(t,{reference_date:new Date})}catch(n){return o.NaN()}}}),e.filter("rpamountadd",function(){return function(e,t){try{return t=o.from_json(t),t.is_zero()?e:o.from_json(e).add(t)}catch(n){return o.NaN()}}}),e.filter("rpamountsubtract",function(){return function(e,t){try{return o.from_json(e).subtract(t)}catch(n){return o.NaN()}}});var c={};e.filter("rpfromnow",function(){return function(e){return c[e]||(c[e]=moment(e).fromNow()),c[e]}}),e.filter("rpripplename",["rpId",function(e){return function(t,n){var r=e.resolveNameSync(t,n);return r!==t?r:t.length>21?t.substring(0,7)+"…":t}}]),e.filter("rpripplenamefull",["rpId",function(e){return function(t,n){var r=e.resolveNameSync(t,n);return r!==t?r:t}}]),e.filter("rpcontactname",["$rootScope",function(e){return function(t){t=t?""+t:"";var n=r.getContact(e.userBlob.data.contacts,t);return n?n.name:t.substring(0,7)+"…"}}]),e.filter("rpcontactnamefull",["$rootScope",function(e){return function(t){t=t?""+t:"";var n=r.getContact(e.userBlob.data.contacts,t);return n?n.name:""+t}}]),e.filter("rponlycontactname",["$rootScope",function(e){return function(t){t=t?""+t:"";var n=r.getContact(e.userBlob.data.contacts,t);return n?n.name:void 0}}]),e.filter("rpmask",function(){return function(e){return e=""+e,Array(e.length+1).join("•")}}),e.filter("rptruncate",function(){return function(e,t){return e?e.slice(0,t):""}}),e.filter("rpfilesize",function(){function e(e,t,n,r){var o=e,a=isNaN(t=Math.abs(t))?2:t,i=void 0===n?",":n,s=void 0===r?".":r,c=0>o?"-":"",u=parseInt(o=Math.abs(+o||0).toFixed(a),10)+"",d=(d=u.length)>3?d%3:0;return c+(d?u.substr(0,d)+s:"")+u.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+s)+(a?i+Math.abs(o-u).toFixed(a).slice(2):"")}var t=1e3,n="kMGTPE",r="B";return function(o){var a=+o;if(t>a)return a+" B";var i=Math.floor(Math.log(a)/Math.log(t)),s=" "+n[i-1]+r;return e(a/Math.pow(t,i),2,".","")+s}}),e.filter("rpucfirst",function(){return function(e){return e=""+e,e.charAt(0).toUpperCase()+e.slice(1)}}),e.filter("rprange",function(){return function(e){var t,n;switch(e.length){case 1:t=0,n=parseInt(e[0],10)-1;break;case 2:t=parseInt(e[0],10),n=parseInt(e[1],10);break;default:return e}for(var r=[],o=t;n>=o;o++)r.push(o);return r}}),e.filter("rpaddressorigin",function(){return function(e){return~e.indexOf("@")?"federation":isNaN(i.decode_check([0,5],e,"bitcoin"))?"ripple":"bitcoin"}}),e.filter("rpheavynormalize",function(){return function(e,t){return String(e).replace(/[^ -~]/g,"").substr(0,t||160).replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g," ")}}),e.filter("rpcurrentpair",function(){return function(e,t,n){return t?_.pick(e,function(e,t,r){var o=e.first.currency(),a=e.first.issuer().to_json(),i=e.second.currency(),s=e.second.issuer().to_json(),c=""+o.to_json()+(o.is_native()?"":"/"+a)+":"+i._iso_code+(i.is_native()?"":"/"+s);return c==n}):e}}),e.filter("rpvalues",function(){return function(e){_.values(e);return _.values(e)}}),e.filter("rpsortmyorders",function(){return function(e,t,n){var r=e.slice(0);return r.sort(function(e,r){var a=0;switch(t){case"qty":a=e.first.to_number()-r.first.to_number();break;case"limit":var i=new Date,s=o.from_json(e.second).ratio_human(e.first,{reference_date:i}),c=o.from_json(r.second).ratio_human(r.first,{reference_date:i});a=s.to_number()-c.to_number();break;case"type":a=e.type.localeCompare(r.type);break;case"base":a=e.first.currency().to_json().localeCompare(r.first.currency().to_json());break;case"counter":a=e.second.currency().to_json().localeCompare(r.second.currency().to_json());break;case"time":}return n&&(a*=-1),a}),r}}),e.filter("rpsortcontacts",function(){return function(e,t,n){var r=e.slice(0);return r.sort(function(e,r){var o=0;switch(t){case"contact":o=e.name.localeCompare(r.name);break;case"address":o=e.address.localeCompare(r.address)}return n&&(o*=-1),o}),r}}),e.filter("rprange",function(){return function(e,t){t=parseInt(t,10);for(var n=1;t>=n;n++)e.push(n);return e}})},function(e,t){function n(){return function(e){return e?(_.isArray(e)||(e=[e]),_.any(e,function(e){return!!e.amount.issuer().to_json()})):void 0}}angular.module("filters").filter("rpAmountHasIssuer",n)},function(e,t){var e=angular.module("validators");e.directive("rpWebsocket",function(e,t,n){return{restrict:"A",require:"?ngModel",link:function(n,r,o,a){a&&(a.$asyncValidators.rpWebsocket=function(n){var r,a=e.defer();return n?(t(function(){try{r=new WebSocket(("true"===o.rpWebsocketSecure?"wss":"ws")+"://"+n+(o.rpWebsocketPort?":"+o.rpWebsocketPort:""))}catch(t){}return r?(r.onopen=function(){r.send('{"command": "ping"}')},r.onerror=function(e){a.reject()},void(r.onmessage=function(e){"success"===JSON.parse(e.data).status?a.resolve():a.reject()})):e.reject(!1)},500),a.promise):e.reject(!1)},o.$observe("rpWebsocket",function(e){a.$validate()}),o.$observe("rpWebsocketPort",function(e){a.$validate()}),o.$observe("rpWebsocketSecure",function(e){a.$validate()}))}}})},function(e,t){var n=angular.module("app.globals",[]);n.constant("store",store),n.constant("Options",Options)},function(e,t,n){"use strict";var r=n(18),o=n(12),e=angular.module("id",["authflow","blob"]);e.factory("rpId",["$rootScope","$location","$route","$routeParams","$timeout","$q","rpAuthFlow","rpBlob","rpAPI",function(e,t,n,a,i,s,c,u,d){var l=function(){this.account=null,this.loginStatus=!1,this.resolvedNames=[],this.serviceInvoked=[]};return l.minimumBlob={data:{contacts:[],preferred_issuer:{},preferred_second_issuer:{}},meta:[]},l.defaultBlob=l.minimumBlob,l.normalizeUsernameForDisplay=function(e){return e=""+e,e=e.trim()},l.normalizeUsernameForInternals=function(e){return e=""+e,e=e.trim(),e=e.replace(/-/g,""),e=e.toLowerCase()},l.prototype.init=function(){for(var n=this,r=0;8>r;r++)sjcl.random.addEntropy(Math.random(),32,"Math.random()");e.userBlob=l.defaultBlob,e.userCredentials={},e.$watch("userBlob",function(){e.$broadcast("$blobUpdate")},!0),e.$on("$blobUpdate",function(){if(o.blobIsValid(e.userBlob)){e.ripple_exchange_selection_trade=o.getSetting(e.userBlob,"rippleExchangeSelectionTrade",!1);var t=e.userBlob.data;Options.advanced_feature_switch=o.getSetting(e.userBlob,"trust.advancedMode",!1),Options.historyApi=o.getSetting(e.userBlob,"historyApi",Options.historyApi).replace(/[\/]*$/,""),Options.max_tx_network_fee=o.getSetting(e.userBlob,"maxNetworkFee",Options.max_tx_network_fee),Options.confirmation=$.extend(!0,{},o.getSetting(e.userBlob,"confirmation",Options.confirmation));var n=o.getSetting(e.userBlob,"server.servers",[]);_.isArray(n)&&n.length>0&&!_.isEqual(n,o.getClearServers(Options.server.servers))&&(Options.server.servers=n,store.disabled||(store.set("ripple_settings",JSON.stringify(Options)),location.reload())),!e.address&&t.account_id&&(e.address=t.account_id),_.has(t,"advancedFeatureSwitch")&&(o.hasSetting(e.userBlob,"trust.advancedMode")||e.userBlob.set("/clients/rippletradecom/trust/advancedMode",t.advancedFeatureSwitch),e.userBlob.unset("/advancedFeatureSwitch")),_.has(t,"persistUnlock")&&(e.userBlob.set("/clients/rippletradecom/persistUnlock",t.persistUnlock),e.userBlob.unset("/persistUnlock")),_.has(t,"lastSeenTxDate")&&(e.userBlob.set("/clients/rippletradecom/lastSeenTxDate",t.lastSeenTxDate),e.userBlob.unset("/lastSeenTxDate")),_.has(t,"trade_currency_pairs")&&(e.userBlob.set("/clients/rippletradecom/trade_currency_pairs",t.trade_currency_pairs),e.userBlob.unset("/trade_currency_pairs"));var r=o.getSetting(e.userBlob,"trade_currency_pairs",[]);if(_.isArray(r)&&r.length>0){var a=!1;_.find(r,_.partial(_.has,_,"$$hashKey"))&&(r=angular.fromJson(angular.toJson(r)),a=!0);var i=_.uniq(r,!1,function(e){return e.name});i.length!==r.length&&(r=i,a=!0),a&&e.userBlob.set("/clients/rippletradecom/trade_currency_pairs",r)}_.has(t,"txQueue")&&(e.userBlob.set("/clients/rippletradecom/txQueue",t.txQueue),e.userBlob.unset("/txQueue"))}}),store.get("backend_token")&&n.relogin(function(e,r){r||(n.logout(),t.path("/login"))}),e.showLogin=!0,$(window).bind("storage",function(t){document.hasFocus()||("backend_token"===t.originalEvent.key&&t.originalEvent.oldValue&&!t.originalEvent.newValue&&i(function(){e.$broadcast("$idRemoteLogout")},0),"backend_token"===t.originalEvent.key&&!t.originalEvent.oldValue&&t.originalEvent.newValue&&i(function(){e.$broadcast("$idRemoteLogin")},0))})},l.prototype.setUsername=function(t){this.username=t,e.userCredentials.username=t,e.$broadcast("$idUserChange",{username:t})},l.prototype.setAccount=function(t){null!==this.account&&e.$broadcast("$idAccountUnload",{account:t}),this.account=t,e.userCredentials.account=t,e.$broadcast("$idAccountLoad",{account:t})},l.prototype.isReturning=function(){return!!store.get("ripple_known")},l.prototype.isLoggedIn=function(){return this.loginStatus},l.prototype.exists=function(e,t){e=l.normalizeUsernameForDisplay(e),c.exists(l.normalizeUsernameForInternals(e),function(e,n){!e&&n?t(null,!0):t(null,!1)})},l.prototype.login=function(t,n){var r=this;if("function"!=typeof n&&(n=$.noop),store.disabled)return void n(new Error("Local storage is disabled, unable to login!"));store.set("backend_token",t),d.setHttpOptions();var o=new u;o.init().then(function(t){$.extend(!0,t,l.minimumBlob),e.userBlob=t,r.setUsername(t.ripple_name),r.setAccount(t.data.account_id),r.loginStatus=!0,e.loginStatus=!0,e.$broadcast("$blobUpdate"),store.set("ripple_known",!0),n(null)},function(e){r.logout(),n(new Error(e))})},l.prototype.relogin=function(t){var n=this,r=store.get("backend_token");if("function"!=typeof t&&(t=$.noop),!r)return t(new Error("Missing backend token"));var o=new u;o.init().then(function(r){$.extend(!0,r,l.minimumBlob),e.userBlob=r,n.setUsername(r.ripple_name),n.setAccount(r.data.account_id),n.loginStatus=!0,e.loginStatus=!0,e.$broadcast("$blobUpdate"),store.set("ripple_known",!0),t(null,r)},function(e){t(new Error(e))})},l.prototype.logout=function(){store.remove("backend_token")},l.prototype.unlock=function(e,t,n){"function"!=typeof n&&(n=$.noop),c.unlock(e,t,function(e,t){return e?void n(e):void n(null,t.secret)})},l.prototype.goId=function(){if(!this.isLoggedIn()){if(_.size(a)){var e=n.current.tabName;return t.search("tab",e),void t.path("/login")}t.path("/login")}},l.prototype.resolveNameSync=function(e,t){return this.resolvedNames[e]?this.resolvedNames[e]:(this.serviceInvoked[e]||this.resolveName(e,t),e)},l.prototype.addressDontHaveName=function(e){return this.resolvedNames[e]===e},l.prototype.resolveName=function(e,t){var n=this,o=s.defer(),a=r.stripRippleAddress(e),i=ripple.UInt160.from_json(a);if(!i.is_valid())return o.resolve(e),o.promise;var c=jQuery.extend(!0,{},t);if(this.resolvedNames[e]){var u=n.resolvedNames[e]!==e&&c.tilde?"~".concat(n.resolvedNames[e]):n.resolvedNames[e];o.resolve(u)}else if(this.serviceInvoked[e]){if(!_.isBoolean(this.serviceInvoked[e])&&_.isFunction(this.serviceInvoked[e].resolve))return this.serviceInvoked[e].promise;o.resolve(e)}else this.serviceInvoked[e]=o,rippleVaultClient.AuthInfo.get(Options.domain,a,function(t,r){if(t)return n.serviceInvoked[e]=!1,void o.reject(t);r.username?n.resolvedNames[e]=r.username:n.resolvedNames[e]=e,n.serviceInvoked[e]=!0;var a=n.resolvedNames[e]!==e&&c.tilde?"~".concat(n.resolvedNames[e]):n.resolvedNames[e];o.resolve(a)});return o.promise},e.$watch("loginStatus",function(t){t&&(e.showLogin=!1)}),e.$on("$routeChangeStart",function(t,n){if(!e.loginStatus){var r=n.tabName,o=["login","migrate","logout","404","privacypolicy","tou"];if(-1===o.indexOf(r))return void(e.showLogin=!0);e.showLogin=!1}}),new l}])},function(e,t){var e=angular.module("tracker",[]);e.factory("rpTracker",["$rootScope",function(e){var t=e.$on("$blobUpdate",function(){if(e.userCredentials.username)try{mixpanel.identify(e.userCredentials.username),mixpanel.people.set({$username:e.userCredentials.username,$name:e.userCredentials.username,"Ripple Address":e.address}),t()}catch(n){console.log("Mixpanel tracking failed",n)}}),n=function(e,t){if(Options.mixpanel&&Options.mixpanel.track&&window.mixpanel)try{mixpanel.track(e,t)}catch(n){console.log("Mixpanel tracking failed",n)}},r=function(e,t,r){t=t&&"object"==typeof t?{Name:t.name,Message:t.message,Stack:t.stack}:{Name:"NonErrorThrownValue",Message:"Not an Error object: "+t,Stack:""},r&&angular.extend(t,r),n(e,t)};return{track:n,trackError:r}}])},function(e,t,n){function r(e,t,n,r,a){function i(o){if(e.account.Balance)n.requestSecret(r.account,r.username,function(e,n){if(e)return void console.log("client: txQueue: error while unlocking wallet: ",e);var r=ripple.Transaction.from_json(o.tx_json);r.remote=t.remote,r.secret(n),a.getUserAccess().then(function(e){r.submit()},function(e){})});else{var i={tx_json:o.tx_json,type:o.tx_json.TransactionType};"TrustSet"===i.type&&(i.details=o.tx_json.LimitAmount);var s=function(t,n){return t?void console.warn(t):void e.userBlob.unshift("/clients/rippletradecom/txQueue",i)};e.userBlob.data&&!e.userBlob.data.clients?e.userBlob.set("/clients",{rippletradecom:{}},s):e.userBlob.data&&e.userBlob.data.clients&&_.isArray(e.userBlob.data.clients)?e.userBlob.unset("/clients",function(t,n){t||e.userBlob.set("/clients",{rippletradecom:{}},s)}):s()}}function s(){if(e.account.Balance&&o.hasSetting(e.userBlob,"txQueue")){var i=this;n.requestSecret(r.account,r.username,function(n,r){return n?void console.log("client: txQueue: error while unlocking wallet: ",n):(o.getSetting(e.userBlob,"txQueue").forEach(function(e){if(e.blob)return void t.remote.requestSubmit().txBlob(e.blob).request();var n=ripple.Transaction.from_json(e.tx_json);n.remote=t.remote,n.secret(r),a.getUserAccess().then(function(e){n.submit()},function(e){})}),void i.emptyQueue())})}}function c(){e.userBlob.unset("/clients/rippletradecom/txQueue")}return{addTransaction:i,checkQueue:s,emptyQueue:c}}var o=n(12);angular.module("txQueue",[]).service("rpTxQueue",r),r.$inject=["$rootScope","rpNetwork","rpKeychain","rpId","rpAPI"]},function(e,t,n){var r=(n(18),n(12)),e=(n(37),angular.module("keychain",["popup"]));e.factory("rpKeychain",["$rootScope","$timeout","rpPopup","rpId","$interval","$templateRequest",function(e,t,n,o,a,i){var s=function(){this.secrets={}};return s.unlockDuration=3e5,s.prototype.isUnlocked=function(e){return!!this.secrets[e]},s.prototype.requestSecret=function(r,o,s,c){var u=this;if("function"==typeof s&&(c=s,s=null),this.secrets[r]){var d=this.secrets[r].masterkey;return void t(function(){c(null,d)})}var l=e.$new(),p=l.unlock={isConfirming:!1,password:"",purpose:s};l.updater=a(function(){var e=$('input[name="popup_unlock_password"]').val();"string"==typeof e&&l.unlockForm.popup_unlock_password.$setViewValue(e)},2e3),l.confirm=function(){function e(e,t){e?(p.isConfirming=!1,e instanceof Error&&"string"==typeof e.message&&-1!==e.message.indexOf("PAKDF")?p.error="server":p.error="password"):(a.cancel(l.updater),n.close(),c(null,t))}p.isConfirming=!0,p.error=null,u.getSecret(r,o,l.unlock.password,e)},l.cancel=function(){a.cancel(l.updater),c("canceled"),n.close()},l.onKeyUp=function(e){27===e.which&&l.cancel()},i("templates/"+lang+"/popup/unlock.html",!1).then(function(e){n.blank(e,l)})},s.prototype.getSecret=function(e,n,r,a){var i=this;if(this.secrets[e]&&this.secrets[e].password===r){var s=this.secrets[e].masterkey;return void t(function(){a(null,s)})}o.unlock(n,r,function(t,n){return t?void a(t):(i.secrets[e]={masterkey:n,password:r},i.expireSecret(e),void a(null,n))})},s.prototype.getUnlockedSecret=function(e){if(!this.isUnlocked(e))throw new Error("Keychain: Tried to get secret for locked account synchronously.");return this.secrets[e].masterkey},s.prototype.setPasswordProtection=function(t,n){function r(t,n,r){e.userBlob.set("/clients/rippletradecom/persistUnlock",!t,function(e,n){return e?r(e):void(t&&a.expireSecret(o.account))})}var a=this;t===!1?this.requestSecret(o.account,o.username,function(e,o){return e?n(e):void r(t,o,n)}):r(t,null,n)},s.prototype.expireSecret=function(n){var o=this;t(function(){o.secrets[n]&&!r.getSetting(e.userBlob,"persistUnlock",!1)&&delete o.secrets[n]},s.unlockDuration)},new s}])},function(e,t){t.exception=function(e){console.log("function"==typeof e.getStack?e.getStack():e.stack)}},function(e,t){!function(){"use strict";function e(e,t){var n=function(){this.remote=new ripple.Remote(Options.server,!0),this.remote.on("connected",this.handleConnect.bind(this)),this.remote.on("disconnected",this.handleDisconnect.bind(this)),this.remote.max_fee=Options.max_tx_network_fee||12,this.connected=!1,this.disconnectTimeout=null};return n.prototype.init=function(){this.remote.connect()},n.prototype.listenId=function(e){},n.prototype.handleConnect=function(n){var r=this,o=!0;this.disconnectTimeout&&(t.cancel(this.disconnectTimeout),this.disconnectTimeout=null,o=!1),e.$apply(function(){r.connected=!0,o&&(e.connected=!0,e.$broadcast("$netConnected"))})},n.prototype.handleDisconnect=function(n){var r=this;e.$apply(function(){r.connected=!1}),this.disconnectTimeout&&t.cancel(this.disconnectTimeout),this.disconnectTimeout=t(this.handleDisconnectReal.bind(this),2e3)},n.prototype.handleDisconnectReal=function(t){this.disconnectTimeout=null,e.$apply(function(){e.connected=!1,e.$broadcast("$netDisconnected")})},new n}angular.module("network",[]).factory("rpNetwork",e),e.$inject=["$rootScope","$timeout"]}()},function(e,t){var e=angular.module("books",["network"]),n=ripple.Amount;e.factory("rpBooks",["rpNetwork","$q","$rootScope","$filter","rpId",function(e,t,r,o,a){function i(t,n,r){return e.remote.book(t.currency,t.issuer,n.currency,n.issuer,r)}function s(e,t,r){var i,s,u=Options.orderbook_max_rows||100,d=o("rpamount"),l=jQuery.extend(!0,{},e);c=0,l=_.values(_.compact(_.map(l,function(e,o){if(!(c>u)&&"0"!==e.taker_gets_funded&&"0"!==e.taker_pays_funded&&(e.TakerGets.value?e.TakerGets.value=e.taker_gets_funded:e.TakerGets=parseInt(Number(e.taker_gets_funded),10),e.TakerPays.value?e.TakerPays.value=e.taker_pays_funded:e.TakerPays=parseInt(Number(e.taker_pays_funded),10),e.TakerGets=n.from_json(e.TakerGets),e.TakerPays=n.from_json(e.TakerPays),e.TakerGets.is_valid()&&e.TakerPays.is_valid())){"asks"===t?e.price=n.from_quality(e.BookDirectory,e.TakerPays.currency(),e.TakerPays.issuer(),{base_currency:e.TakerGets.currency(),reference_date:new Date}):e.price=n.from_quality(e.BookDirectory,e.TakerGets.currency(),e.TakerGets.issuer(),{inverse:!0,base_currency:e.TakerPays.currency(),reference_date:new Date});var p=d(e.price,{rel_precision:4,rel_min_precision:2});return e.Account==a.account&&(e.my=!0),i!==p||e.my?s=o:(r&&(l[s].TakerPays=n.from_json(l[s].TakerPays).add(e.TakerPays),l[s].TakerGets=n.from_json(l[s].TakerGets).add(e.TakerGets)),e=!1),e.my||(i=p),e&&c++,c>u?!1:e}})));var p,f="asks"===t?"TakerGets":"TakerPays";return _.each(l,function(e,t){p=p?e.sum=p.add(e[f]):e.sum=e[f]}),l}var c;return{get:function(e,t,n){function o(e){r.$apply(function(){_.asks=s(e,"asks",!0),_.updated=!0,p||(p=!0,!_.ready&&f&&(_.ready=!0))}),_.asksLastUpdate=+new Date}function a(e,t){r.$apply(function(){_.last_price=e.ratio_human(t),_.updated=!0}),_.asksLastUpdate=+new Date}function c(e){r.$apply(function(){_.bids=s(e,"bids",!0),_.updated=!0,f||(f=!0,!_.ready&&p&&(_.ready=!0)),_.bidsLastUpdate=+new Date})}function u(e,t){r.$apply(function(){_.last_price=t.ratio_human(e),_.updated=!0,_.bidsLastUpdate=+new Date})}var d=i(e,t,n),l=i(t,e,n),p=!1,f=!1;d._shouldSubscribe=!0,l._shouldSubscribe=!0;var _={asks:s(d.offersSync(),"asks",!0),bids:s(l.offersSync(),"bids",!0),asksLastUpdate:+new Date,bidsLastUpdate:+new Date,ready:!1};return d.on("model",o),d.on("trade",a),l.on("model",c),l.on("trade",u),_.unsubscribe=function(){d.removeListener("model",o),d.removeListener("trade",a),l.removeListener("model",c),l.removeListener("trade",u),p=!1,f=!1,_.ready=!1},_.requestOffers=function(){d.requestOffers(),l.requestOffers()},_},getLength:function(){return c}}}])},function(e,t){var e=angular.module("popup",[]);e.factory("rpPopup",["$compile",function(e){var t={};return t.getPopup=function(e){return!t.popupElement&&e&&(t.popupElement=$('<div class="modal fade"></div>'),t.popupElement.appendTo("BODY")),t.popupElement},t.compileAndRunPopup=function(t,n,r){e(t)(n),t.modal(r)},t.blank=function(e,n){var r=t.getPopup(!0),o='<div class="modal-dialog"><div class="modal-content">';o+=e,o+="</div></div>",r.html(o),t.compileAndRunPopup(r,n)},t.confirm=function(e,n,r,o,a,i,s,c,u,d){n=n?n:"Are you sure?",r=r?r:"Ok",a=a?a:"btn btn-info",i=i?i:"Cancel",c=c?c:"";var l=t.getPopup(!0),p='<div class="modal-dialog"><div class="modal-content">';e&&(p+='<div class="modal-header"><h1>'+e+"</h1></div>"),p+='<div class="modal-body"><p class="question">'+n+'</p><div class="actions">',p+=o?'<button class="'+a+' " ng-click="'+o+'">'+r+"</button>":'<button class="'+a+' ">'+r+"</button>",p+=s?'<button class="'+c+' btn-cancel" ng-click="'+s+'">'+i+"</button>":'<button class="'+c+' btn-cancel">'+i+"</button>",p+="</div></div></div></div>",l.html(p),l.find(".btn").click(function(){t.close()}),t.compileAndRunPopup(l,u,d)},t.close=function(){var e=t.getPopup();e&&e.modal("hide")},t}])},function(e,t){var e=angular.module("rippletxt",[]);e.factory("rpRippleTxt",["$q","$rootScope","$http",function(e,t,n){function r(t){if(a[t])return a[t];var r=e.defer(),i=["https://www."+t+"/ripple.txt","https://"+t+"/ripple.txt","https://ripple."+t+"/ripple.txt"].reverse(),s=function(){if(!i.length)return void r.reject(new Error("No ripple.txt found"));var e=i.pop();n.get(e).success(function(e){r.resolve(o(e))}).error(s)};return s(),a[t]=r.promise}function o(e){e=e.replace("\r\n","\n"),
e=e.replace("\r","\n"),e=e.split("\n");for(var t="",n={},r=0,o=e.length;o>r;r++){var a=e[r];a.length&&"#"!==a[0]&&("["===a[0]&&"]"===a[a.length-1]?(t=a.slice(1,a.length-1),n[t]=[]):(a=a.replace(/^\s+|\s+$/g,""),n[t]&&n[t].push(a)))}return n}var a={};return{get:r,parse:o}}])},function(e,t){!function(){"use strict";function e(e,t,n){function r(r){function o(){i.reject({result:"error",error:"noRippleTxt",error_message:"Ripple.txt not available for the requested domain."})}function a(e){e.federation_url?$.ajax({url:e.federation_url[0],dataType:"json",data:{type:"federation",domain:c,destination:u,user:u},error:function(){t.$apply(function(){i.reject({result:"error",error:"down",error_message:"Federation gateway did not respond.",url:e.federation_url[0]})})},success:function(e){t.$apply(function(){"object"!=typeof e||"object"!=typeof e.federation_json||"federation_record"!==e.federation_json.type||e.federation_json.user!==u&&e.federation_json.destination!==u||e.federation_json.domain!==c?"string"==typeof e.error?i.reject({result:"error",error:"remote",error_remote:e.error,error_message:e.error_message?"Service error: "+e.error_message:"Unknown remote service error."}):i.reject({result:"error",error:"unavailable",error_message:"Federation gateway's response was invalid."}):i.resolve(e.federation_json)})}}):i.reject({result:"error",error:"noFederation",error_message:"Federation is not available on the requested domain."})}var i=e.defer(),s=r.split("@"),c=s.pop(),u=s.join("@"),d=n.get(c);return d?"function"==typeof d.then?d.then(a,o):a(d):o(),i.promise}return{check_email:r}}angular.module("federation",[]).factory("rpFederation",e);e.$inject=["$q","$rootScope","rpRippleTxt"]}()},function(e,t){var e=angular.module("domainalias",["network","rippletxt"]);e.factory("rpDomainAlias",["$q","$rootScope","rpNetwork","rpRippleTxt",function(e,t,n,r){function o(e,t,n){if(!n.domain||1!==n.domain.length||n.domain[0]!==e)return!1;if(!n.accounts)return!1;for(var r=0,o=n.accounts.length;o>r;r++)if(n.accounts[r]===t)return!0;return!1}function a(a){if(i[a])return i[a];var s=e.defer();return n.remote.requestAccountInfo({account:a}).on("success",function(e){e.account_data.Domain?t.$apply(function(){var t=sjcl.codec.utf8String.fromBits(sjcl.codec.hex.toBits(e.account_data.Domain));r.get(t).then(function(e){o(t,a,e)?s.resolve(t):s.reject(new Error("Invalid domain"))},function(e){s.reject(new Error(e))})}):s.reject(new Error("No domain found"))}).on("error",function(){s.reject(new Error("No domain found"))}).request(),i[a]=s.promise}var i={};return{getAliasForAddress:a}}])},function(e,t){function n(e,t,n){var r=function(e){this.account=e,this.accountObj=n.remote.account(this.account)};return r.prototype.getHistory=function(e){return t({url:Options.historyApi+"/accounts/"+this.account+"/transactions",method:"GET",params:e})},r.prototype.getCount=function(e){return e=jQuery.extend(!0,{},e),delete e.limit,delete e.offset,e.count=!0,this.getHistory(e)},r.prototype.getTransaction=function(e){return t({url:Options.historyApi+"/transactions/"+e,method:"GET"})},r.prototype.onTransaction=function(e){this.accountObj.on("transaction",e)},r}angular.module("history",[]).factory("rpHistory",n),n.$inject=["$rootScope","$http","rpNetwork"]},function(e,t){"use strict";var e=angular.module("api",[]);e.factory("rpAPI",["$http","$q",function(e,t){var n={},r={};return n.setHttpOptions=function(){r={headers:{Authorization:"Bearer "+store.get("backend_token")},timeout:8e3}},n.setHttpOptions(),n.getSubscription=function(){return e.get(Options.backend_url+"/api/subscription",r)},n.updateSubscription=function(t){return e.put(Options.backend_url+"/api/subscription",t,r)},n.addTransaction=function(t,n,o,a){var i={transaction:t,result:n,hash:o,submit_response_time:a};return e.post(Options.backend_url+"/api/transactions",i,r)},n.getUserProfile=function(){return e.get(Options.backend_url+"/api/user",r)},n.getUserAccess=function(){return e.get(Options.backend_url+"/api/user/access",r).then(function(e){return"allowed"===e.data.access?"allowed":t.reject("denied")})},n.getBlob=function(){return e.get(Options.backend_url+"/api/blob",r)},n.updateBlob=function(t){return e.post(Options.backend_url+"/api/blob",t,r)},n}])},function(e,t,n){(function(e){"use strict";var t=angular.module("authflow",[]);t.factory("rpAuthFlow",["$rootScope",function(t){var n={};return n.exists=function(e,t){var r=n.getVaultClient(e);r.client.exists(r.username,t)},n.unlock=function(r,o,a){if(!t.userBlob)return void t.$apply(function(){a(new Error("Blob not found"))});var i=n.getVaultClient(r),s=t.userBlob.encrypted_secret;i.client.unlock(i.username,o,s,function(n,r){e(function(){t.$apply(function(){a(n,r)})})})},n.getVaultClient=function(e){var t={username:e,domain:Options.domain},n=e.indexOf("@");return-1!==n&&(t={username:e.substring(0,n),domain:e.substring(n+1)}),t.client=new rippleVaultClient.VaultClient(t.domain),t},n}])}).call(t,n(15).setImmediate)},function(e,t){"use strict";var e=angular.module("blob",[]);e.factory("rpBlob",["$rootScope","$q","rpAPI",function(e,t,n){function r(){this.data={}}function o(e,t){return/(number|string)/.test(typeof e[0])?e=[e]:1===e.length&&Array.isArray(e[0])&&/(number|string)/.test(typeof e[0][0])||Array.isArray(e[0])&&(e=e[0]),e=e.map(function(e){if("string"==typeof e[0]&&(e[0]=r.ops[e[0]]),"number"!=typeof e[0])throw new Error("Invalid op in subcommand");if("string"!=typeof e[1])throw new Error("Invalid path in subcommand");return e}),t?1===e.length?e[0]:[e]:e}r.ops={noop:0,set:16,unset:17,extend:18,push:32,pop:33,shift:34,unshift:35,filter:36},r.opsReverseMap=[];for(var a in r.ops)r.opsReverseMap[r.ops[a]]=a;var i="identityVault";return r.prototype.init=function(){var e=this;return n.getBlob().then(function(n){return n.data&&n.data.data&&n.data.data.account_id?(e.ripple_name=n.data.ripple_name,e.identity=n.data.identity,e.device_id=n.data.device_id,e.encrypted_secret=n.data.encrypted_secret,e.data=n.data.data,e):t.reject("Could not retrieve blob")},function(e){return t.reject(e.data||"Could not retrieve blob")})},r.prototype.set=function(e,t,n){return e==="/"+i&&this.data[i]?n(new Error("Cannot overwrite Identity Vault")):(this.applyUpdate("set",e,[t]),void this.postUpdate(n))},r.prototype.unset=function(e,t){return e==="/"+i?t(new Error("Cannot remove Identity Vault")):(this.applyUpdate("unset",e,[]),void this.postUpdate(t))},r.prototype.extend=function(e,t,n){this.applyUpdate("extend",e,[t]),this.postUpdate("extend",e,[t],n)},r.prototype.unshift=function(e,t,n){this.applyUpdate("unshift",e,[t]),this.postUpdate(n)},r.prototype.filter=function(e,t,n,r,a){var i=Array.prototype.slice.apply(arguments);"function"==typeof i[i.length-1]&&(a=i.pop()),i.shift(),i=i.slice(0,2).concat(o(i.slice(2),!0)),this.applyUpdate("filter",e,i),this.postUpdate(a)},r.prototype.applyUpdate=function(e,t,n){if("number"==typeof e&&(e=r.opsReverseMap[e]),"string"!=typeof e)throw new Error("Blob update op code must be a number or a valid op id string");var o=t.split("/"),a=o.shift();if(""!==a)throw new Error("Invalid JSON pointer: "+t);this._traverse(this.data,o,t,e,n)},r.prototype._traverse=function(e,t,n,r,a){var i=this,s=i.unescapeToken(t.shift());if(Array.isArray(e)){if("-"===s)s=e.length;else if(s%1!==0&&s>=0)throw new Error("Invalid pointer, array element segments must be a positive integer, zero or '-'")}else{if("object"!=typeof e)return null;if(!e.hasOwnProperty(s))if("set"===r)e[s]={};else{if("unshift"!==r)return null;e[s]=[]}}if(0!==t.length)return this._traverse(e[s],t,n,r,a);switch(r){case"set":e[s]=a[0];break;case"unset":Array.isArray(e)?e.splice(s,1):delete e[s];break;case"extend":if("object"!=typeof e[s])throw new Error("Tried to extend a non-object");$.extend(e[s],a[0]);break;case"unshift":if("undefined"==typeof e[s])e[s]=[];else if(!Array.isArray(e[s]))throw new Error('Operator "unshift" must be applied to an array.');e[s].unshift(a[0]);break;case"filter":Array.isArray(e[s])&&e[s].forEach(function(e,t){if("object"==typeof e&&e.hasOwnProperty(a[0])&&e[a[0]]===a[1]){var r=n+"/"+t,s=o(a.slice(2));s.forEach(function(e){var t=e[0],n=r+e[1];i.applyUpdate(t,n,e.slice(2))})}});break;default:throw new Error("Unsupported op "+r)}},r.prototype.escapeToken=function(e){return e.replace(/[~\/]/g,function(e){return"~"===e?"~0":"~1"})},r.prototype.unescapeToken=function(e){return e.replace(/~./g,function(e){switch(e){case"~0":return"~";case"~1":return"/"}throw new Error("Invalid tilde escape: "+e)})},r.prototype.postUpdate=function(e){"function"!=typeof e&&(e=$.noop);var t={};return t.ripple_name=this.ripple_name,t.identity=this.identity,t.device_id=this.device_id,t.encrypted_secret=this.encrypted_secret,t.data=this.data,n.updateBlob(t).then(function(t){return t.data?e(null,t.data):e(new Error("Could not save blob"))},function(t){return e(new Error("Could not save blob"))})},r}])},function(e,t){var e=angular.module("appManager",["domainalias","integrationProfileManager"]);e.service("rpAppManager",["$rootScope","$http","rpDomainAlias","rpRippleTxt","rpProfileManager",function(e,t,n,r,o){var a=function(){var e=Array.prototype.slice.call(arguments);e[0]="%c "+e[0]+" ",e.splice(1,0,"background: green; color: white"),console.log.apply(console,e)},i=function(){e.$watch("userBlob.data.apps",function(t){t&&t.length&&t.forEach(function(t){l(t.rippleAddress,function(n,r){e.apps[t.rippleAddress]=r})})})};e.apps={};var s=function(e){this.name=e.name,this.description=e.description,this.image=e.imageUrl,this.rippleAddress=e.rippleAddress,this.profiles=[];var t=this;_.each(e.profiles,function(e,n){t.profiles[n]=o.getProfile(e)})};s.prototype.findProfile=function(e){return _.findWhere(this.profiles,{type:e})},s.prototype.getInboundBridge=function(e){var t;return this.profiles.forEach(function(n,r){"inboundBridge"===n.type&&n.currencies.forEach(function(r){e.toUpperCase()===r.currency&&(t=n)})}),t};var c=function(t,n){e.$watch("apps",function(e){(app=e[t])&&n(null,app)},!0)},u=function(t){e.$watch("apps",function(e){$.isEmptyObject(e)||t(e)},!0)},d=function(t){var n=e.$watch("userBlob",function(r){r.data.created&&!_.findWhere(e.userBlob.data.apps,{rippleAddress:t.rippleAddress})&&(e.userBlob.unshift("/apps",{name:t.name,rippleAddress:t.rippleAddress}),n())})},l=function(o,i){var c;a("appManager:","Looking up",o);var u=n.getAliasForAddress(o);u.then(function(n){a("appManager:","The domain for",o,"is",n),a("appManager:","Looking up ",n,"for ripple.txt");var u=r.get(n);u.then(function(n){a("appManager:","Got ripple.txt",n),n.manifest_url&&(a("appManager:","Looking up manifest",n.manifest_url),t({url:n.manifest_url,method:"get"}).success(function(t,n,r,u){return c=jQuery.extend(!0,{},t),a("appManager:","Got the manifest for",c.name,c),p(c)?(e.apps[o]=new s(c),void i(null,e.apps[o])):void a("appManager:","Manifest is invalid.")}).error(function(e,t,n,r){a("appManager:","Can't get the manifest")}))},function(e){i(e)})},function(e){i(e)})},p=function(e){return e.name&&e.rippleAddress&&e.profiles&&ripple.UInt160.from_json(e.rippleAddress).is_valid()?!0:void 0};return{getApp:c,getAllApps:u,loadApp:l,init:i,save:d}}])},function(e,t){var e=angular.module("integrationProfileManager",["integrationAccount","integrationHistory","integrationTrust","integrationInboundBridge"]);e.service("rpProfileManager",["$rootScope","rpAccountProfile","rpHistoryProfile","rpTrustProfile","rpInboundBridgeProfile",function(e,t,n,r,o){this.getProfile=function(e){var a={accountProfile:function(){return t.fromManifest(e)},historyProfile:function(){return n.fromManifest(e)},trustProfile:function(){return r.fromManifest(e)},inboundBridgeProfile:function(){return o.fromManifest(e)}};return a[e.type+"Profile"]()}}])},function(e,t){var e=angular.module("integrationAccount",[]);e.service("rpAccountProfile",["$rootScope","rpNetwork","$http",function(e,t,n){this.accountProfile=function(e){return{type:e.type,version:e.version,getFields:function(){return e.signupFields},signup:function(t,r){n({url:e.urls.signup,method:"POST",data:t}).success(function(e){return"error"===e.status?void r({message:e.message}):void r(null,e)}).error(function(e,t){r({message:"Unable to sign up."})})},getUser:function(t,r){n({url:e.urls.user,method:"GET",params:{rippleAddress:t}}).success(function(e){return"error"===e.status?void r({message:e.message}):void r(null,e)}).error(function(e,t){r({message:"Can't get the user."})})}}},this.fromManifest=function(e){return new this.accountProfile(e)}}])},function(e,t){var e=angular.module("integrationHistory",[]);e.service("rpHistoryProfile",["$rootScope","rpNetwork","$http",function(e,t,n){this.historyProfile=function(e){return{type:e.type,version:e.version,getTransactions:function(t,r){n({url:e.urls.transactions,method:"GET",params:{rippleAddress:t}}).success(function(e){return"error"===e.status?void r({message:e.message}):void r(null,e.history)}).error(function(e,t){r({message:"Unable to fetch the history."})})}}},this.fromManifest=function(e){return new this.historyProfile(e)}}])},function(e,t){var e=angular.module("integrationTrust",["txQueue","keychain"]);e.service("rpTrustProfile",["$rootScope","rpNetwork","rpTxQueue","rpKeychain","rpId",function(e,t,n,r,o){this.trustProfile=function(r){return{type:r.type,version:r.version,grantNeccessaryTrusts:function(){r.currencies.forEach(function(r){if(!((existingTrustLine=e.lines[r.issuer+r.currency.toUpperCase()])&&existingTrustLine.limit.to_number()>=r.amount)){var a=t.remote.transaction();a.rippleLineSet(o.account,r.amount+"/"+r.currency+"/"+r.issuer),a.setFlags("NoRipple"),n.addTransaction(a)}}),"function"==typeof callback&&callback()}}},this.fromManifest=function(e){return new this.trustProfile(e)}}])},function(e,t,n){var r=n(12),e=angular.module("integrationInboundBridge",[]);e.service("rpInboundBridgeProfile",["$rootScope","rpNetwork","rpId","$http","rpTxQueue",function(e,t,n,o,a){this.inboundBridgeProfile=function(i){return{type:i.type,version:i.version,bridgeType:i.bridgeType,currencies:i.currencies,trust:function(o,s){var c=_.findWhere(i.currencies,{currency:o.toUpperCase(),issuer:s});if(!c)return void console.warn("This service doesn't support "+o+"/"+s);if(!((existingTrustLine=e.lines[c.issuer+c.currency])&&existingTrustLine.limit.to_number()>=c.amount)){var u;if(_.each(_.findWhere(r.getSetting(e.userBlob,"txQueue"),{type:"TrustSet"}),function(e,t,n){u=n&&n.details.currency===c.currency&&n.details.issuer===c.issuer&&n.details.value>=c.amount}),!u){var d=t.remote.transaction();d.rippleLineSet(n.account,c.amount+"/"+c.currency+"/"+c.issuer),d.setFlags("NoRipple"),d.addMemo("client","text/plain","rt"+e.version),a.addTransaction(d)}}},getInstructions:function(e,t){o({url:i.urls.instructions,method:"GET",params:{rippleAddress:e}}).success(function(e){return"error"===e.status?void t({message:e.message}):void t(null,e)}).error(function(e,n){t({message:"Can't get the instructions."})})},getPending:function(e,t){o({url:i.urls.pending,method:"GET",params:{rippleAddress:e}}).success(function(e){return"error"===e.status?void t({message:e.message}):void t(null,e.deposits)}).error(function(e,n){t({message:"Can't get pending deposits."})})}}},this.fromManifest=function(e){return new this.inboundBridgeProfile(e)}}])},function(e,t,n){"use strict";var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="login",a.prototype.pageMode="single",a.prototype.parent="main",a.prototype.extraRoutes=[{name:"/login/:callback"}],a.prototype.angular=function(e){e.controller("LoginCtrl",["$scope","$location","$sce","rpTracker","rpId","rpAPI",function(e,t,n,r,o,a){function i(n){return n?(e.loggingIn=!1,e.status="",e.status="Login failed:","BlobError"!==n.name&&e.backendMessages.push(n.message),void(e.$$phase||e.$apply())):void a.getUserProfile().success(function(n){store.set("profile_status",n.ids_status),store.set("profile_country",n.country),e.loggingIn=!1,e.status="",t.search().redirect_to?t.url(t.search().redirect_to):t.path("/balance").search(""),r.track("Login",{Status:"success"})})}return e.error="",e.loggingIn=!1,e.redirectTo=t.path(),e.backendMessages=[],e.authAction=n.trustAsResourceUrl(Options.backend_url+"/auth/login"),o.loginStatus?void t.path("/balance"):(e.submitForm=function(r){e.redirectTo=encodeURIComponent(t.url()),e.authAction=n.trustAsResourceUrl(Options.backend_url+"/auth/"+r)},void("/login/callback"===t.path()&&t.search().token&&(e.loggingIn=!0,o.login(t.search().token,i))))}])},e.exports=a},function(e,t,n){var r=(n(6),n(18),n(37),function(e){});r.prototype.pageMode="default",r.prototype.mainMenu="none",r.prototype.angularDeps=["charts","effects","events","fields","formatters","directives","validators","datalinks","filters"],r.prototype.aliases=[],t.Tab=r},function(e,t,n){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="migrate",a.prototype.pageMode="single",a.prototype.parent="main",a.prototype.angular=function(e){e.controller("MigrateCtrl",["$scope","$rootScope",function(e,t){window.location.assign("https://www.ripple.com/migrate")}])},e.exports=a},function(e,t,n){"use strict";var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="logout",a.prototype.pageMode="single",a.prototype.parent="main",a.prototype.angular=function(e){e.controller("LogoutCtrl",["$scope","$location",function(e,t){var n=t.search().redirect_to?decodeURI(t.search().redirect_to):null;e.logout(n)}])},e.exports=a},function(e,t,n){var r=n(6),o=n(55).Tab,a=ripple.Amount,i=(n(3),n(59)),s=function(){o.call(this)};r.inherits(s,o),s.prototype.tabName="balance",s.prototype.mainMenu="wallet",s.prototype.angularDeps=o.prototype.angularDeps.concat(["marketchart"]),s.prototype.angular=function(e){e.controller("BalanceCtrl",["$scope","rpId","rpNetwork","$filter","$http","rpAppManager","$q",function(e,t,r,o,s,c,u){function d(){var t=[],n=!1;for(var r in e.balances)if(e.balances.hasOwnProperty(r)){var o=e.balances[r].components;for(var a in o)o.hasOwnProperty(a)&&(n||(n=o[a].is_negative()),t.push({currency:r,issuer:a}))}e.hasNegative=n;var i=t.map(function(e){return{base:e,counter:{currency:"XRP"}}});i.length?(e.exchangeRatesNonempty=!1,s.post("https://api.ripplecharts.com/api/exchangeRates",{pairs:i,last:!0}).success(function(t){for(var n=0;n<t.length;n++){var r=t[n];r.last>0&&(e.exchangeRates[r.base.currency+":"+r.base.issuer]=r.last)}e.exchangeRatesNonempty=!0,console.log("Exchange Rates: ",e.exchangeRates)})):e.exchangeRatesNonempty=!0}function l(){if(e.exchangeRates){for(var n={},r=Object.keys(e.exchangeRates),a=0;a<r.length;a++){var i=r[a].split(":")[0];if(!n[i]||!n.hasOwnProperty(i))for(var s=a+1;s<r.length;s++){var c=r[s].split(":")[0];if(i===c){n[i]=!0;break}}}var d=[];e.valueMetrics=r.map(function(e){var r=e.split(":"),a=o("rpcurrency")(ripple.Amount.from_human("0 "+r[0])),i=r.length>1?o("rpripplename")(r[1],!1):"";return n[r[0]]&&-1!==i.indexOf("…")&&!t.addressDontHaveName(r[1])&&d.push(t.resolveName(r[1],{tilde:!0})),{code:e,name:a+(n[r[0]]?"."+i:""),nameShort:a}}),d.length>0&&u.all(d).then(function(){l()}),p()}}function p(){if(e.account.Balance){var t=e.account.Balance/1e6;for(var n in e.balances)if(e.balances.hasOwnProperty(n)){var r=e.balances[n].components;for(var o in r)if(r.hasOwnProperty(o)){var a=e.exchangeRates[n+":"+o]||0,i=r[o].to_number()*a;t+=i}}e.aggregateValueAsXrp=t,f()}}function f(){var t;_.forEach(e.valueMetrics,function(n){n.name===e.selectedValueMetric&&(e.selectedValueMetricCode=n.code,e.selectedValueCurrencyShort=n.nameShort,t=e.exchangeRates[n.code])}),t||(e.selectedValueMetric=e.selectedValueMetricCode="XRP",e.changeMetric(e),t=e.exchangeRates[e.selectedValueMetricCode]),e.aggregateValueAsMetric=e.aggregateValueAsXrp/t,"XRP"===e.selectedValueMetricCode||"0158415500000000C1F76FF6ECB0BAC600000000:rDRXp3XC6ko3JKNh1pNrDARZzFKfBzaxyi"===e.selectedValueMetricCode||"015841551A748AD2C1F76FF6ECB0CCCD00000000:rs9M85karFkCRjvc6KMWn8Coigm9cbcgcx"===e.selectedValueMetricCode?(e.aggregateValueDisplayed=a.from_json({value:e.aggregateValueAsMetric.toFixed(4).substring(0,(e.aggregateValueAsXrp/t).toFixed(4).length-5)}).to_human(),e.aggregateValueDisplayedDecimal=e.aggregateValueAsMetric.toFixed(4).substring((e.aggregateValueAsXrp/t).toFixed(4).length-5,(e.aggregateValueAsXrp/t).toFixed(4).length)):(e.aggregateValueDisplayed=a.from_json({value:e.aggregateValueAsMetric.toFixed(2).substring(0,(e.aggregateValueAsXrp/t).toFixed(2).length-3)}).to_human(),e.aggregateValueDisplayedDecimal=e.aggregateValueAsMetric.toFixed(2).substring((e.aggregateValueAsXrp/t).toFixed(2).length-3,(e.aggregateValueAsXrp/t).toFixed(2).length)),e.aggregateValueDisplayedDecimalDot="."===e.aggregateValueDisplayedDecimal.substring(0,1),e.aggregateValueDisplayedDecimalDot&&(e.aggregateValueDisplayedDecimal=e.aggregateValueDisplayedDecimal.substring(1))}e.currenciesAll=n(13),e.currencies=[],e.exchangeRates||(e.exchangeRates={XRP:1}),e.firstCurrencySelected="XRP",e.secondCurrencySelected="USD";(e.selectedValueMetric=store.get("balance"))||(e.selectedValueMetric="XRP"),e.sort_options={current_pair_only:!1,sort_field:"type",reverse:!1},e.validationPatternCurrency=/^[a-zA-Z]{3}/,e.changeMetric=function(t){e.selectedValueMetric=t.selectedValueMetric,store.set("balance",e.selectedValueMetric)},e.$watch("selectedValueMetric",function(){e.selectedValueMetric&&e.aggregateValueAsXrp&&f()}),e.$on("$balancesUpdate",d),e.$watch("exchangeRates",l,!0),e.$watch("account.Balance",p),e.loadState.lines&&d(),e.$watch("firstCurrencySelected",function(){e.firstIssuerSelected="","XRP"==e.firstCurrencySelected?e.disableFirstIssuer=!0:(e.disableFirstIssuer=!1,e.firstIssuer={},i.forEach(function(t){var n=t.accounts;n.forEach(function(n){n.currencies.forEach(function(n){n==e.firstCurrencySelected&&(""===e.firstIssuerSelected&&(e.firstIssuerSelected=t.name),e.firstIssuer[t.name]=t)})})}))}),e.$watch("secondCurrencySelected",function(){e.secondIssuerSelected="","XRP"==e.secondCurrencySelected?e.disableSecondIssuer=!0:(e.disableSecondIssuer=!1,e.secondIssuer={},i.forEach(function(t){var n=t.accounts;n.forEach(function(n){n.currencies.forEach(function(n){n==e.secondCurrencySelected&&(""===e.secondIssuerSelected&&(e.secondIssuerSelected=t.name),e.secondIssuer[t.name]=t)})})}))}),e.issuerNameToAddress=function(e,t){if("XRP"===t)return"";var n="";return i.forEach(function(r){if(e===r.name){var o=r.accounts;o.forEach(function(e){e.currencies.forEach(function(r){r===t&&(n=e.address)})})}}),n},e.flipCurrencies=function(){var t=e.firstCurrencySelected,n=e.firstIssuerSelected,r=e.secondCurrencySelected,o=e.secondIssuerSelected;e.firstCurrencySelected=r,e.firstIssuerSelected=o,e.secondCurrencySelected=t,e.secondIssuerSelected=n};for(var m=0;m<e.currenciesAll.length;m++)e.currenciesAll[m].custom_trade_currency_dropdown&&e.currencies.push(e.currenciesAll[m].value);e.sortOptions={currentPairOnly:!1,sortField:"type",sortFieldName:"Type",reverse:!1},e.sortOptions.sortFieldName=e.ordersSortFieldChoicesKeyed[e.sortOptions.sortField],e.$watch("sortOptions.sortFieldName",function(){e.sortOptions.sortField=e.ordersSortFieldChoicesKeyedReverse[e.sortOptions.sortFieldName]}),e.$watch("sortOptions.sortField",function(){e.sortOptions.sortFieldName=e.ordersSortFieldChoicesKeyed[e.sortOptions.sortField]}),e.view_orders_history=function(){$location.url("/history?f=orders")}}])},e.exports=s},function(e,t){e.exports=[{name:"Bitstamp",accounts:[{address:"rvYAfWj5gh67oV6fW32ZzP3Aw4Eubs59B",currencies:["BTC","USD","EUR"],hotwallets:["rrpNnNLKrartuEqfJGpqyDwPj1AFPg9vn1"]}]},{name:"RippleChina",accounts:[{address:"razqQKzJRdB4UxFPWf5NEpEG3WMkmwgcXA",currencies:["CNY"],hotwallets:["r45dBj4S3VvMMYXxr9vHX4Z4Ma6ifPMCkK"]}]},{name:"rippleCN",accounts:[{address:"rnuF96W4SZoCJmbHYBFoJZpR8eCaxNvekK",currencies:["BTC","CNY"],hotwallets:["rNaptDNfFXo1quhKwMaNPf66iwPqA8YLky","rno91tGDJeRcnM7EMXj8KG9UTyxRGMMz8s"]}]},{name:"Payroutes",accounts:[{address:"rNPRNzBB92BVpAhhZr4iXDTveCgV5Pofm9",currencies:["BTC","ILS"],hotwallets:[]}]},{name:"SnapSwap",accounts:[{address:"rMwjYedjc7qqtKYVLiAccJSmCwih4LnE2q",currencies:["USD","BTC","EUR","GBP"],hotwallets:["rUQTpMqAF5jhykj4FExVeXakrZpiKF6cQV","rhasPLL5GaXzBh5amQkN7Dr1SNF4Whb2ZT"]}]},{name:"TheRock",accounts:[{address:"rLEsXccBGNR3UPuPu2hUXPjziKC3qKSBun",currencies:["BTC","EUR","USD"],hotwallets:["rUeFPRGNjtcbtezyQKKiDcS1eQyYLQ1gcr"]}]},{name:"WisePass",accounts:[{address:"rPDXxSZcuVL3ZWoyU82bcde3zwvmShkRyF",currencies:["BTC","LTC","USD"],hotwallets:["r9xAQUyqs53QH2PLxe7iFbNbpU2RA9QtZx"]}]},{name:"RippleUnion",accounts:[{address:"r3ADD8kXSUKHd6zTCKfnKT3zV9EZHjzp1S",currencies:["CAD"],hotwallets:[]}]},{name:"Justcoin",accounts:[{address:"rJHygWcTLVpSXkowott6kzgZU6viQSVYM1",currencies:["LTC","BTC","STR","EUR","NOK"],hotwallets:[]}]},{name:"DotPayco",accounts:[{address:"rM8199qFwspxiWNZRChZdZbGN5WrCepVP1",currencies:["CNY"],hotwallets:[]}]},{name:"RippleSingapore",accounts:[{address:"r9Dr5xwkeLegBeXq6ujinjSBLQzQ1zQGjH",currencies:["XAU","XAG","XPT","SGD"],hotwallets:[]}]},{name:"Bitso",accounts:[{address:"rG6FZ31hDHN1K5Dkbma3PSB5uVCuVVRzfn",currencies:["MXN","BTC"],hotwallets:["rHZaDC6tsGN2JWGeXhjKL6664RNCq5hu4B"]}]},{name:"RippleLatAm",accounts:[{address:"rP5ShE8dGBH6hHtNvRESdMceen36XFBQmh",currencies:["BRL","UYU","PEN","MXN","BTC","LTC","USD","CLP","ARS"],hotwallets:["raoFdQah8c8owTj4TPMr8o1WntnXybXCgB"],domain:"ripplelatam.com"}]},{name:"GBI",accounts:[{address:"rrh7rf1gV2pXAoqA8oYbpHd8TKv5ZQeo67",currencies:["XAU"],hotwallets:[],domain:"goldbullioninternational.com"}]},{name:"LakeBTC",accounts:[{address:"rpDMez6pm6dBve2TJsmDpv7Yae6V5Pyvy2",currencies:["USD"]}],hotwallets:["rP9gFJKqKGWdR4n6XjdsUPqmJfXkg4kSgZ"],domain:"lakebtc.com"},{name:"RippleFox",accounts:[{address:"rKiCet8SdvWxPXnAgYarFUXMh1zCPz432Y",currencies:["CNY","STR"]}],hotwallets:["rLSnkKvMfPD9abLoQFxQJMYyZqJcsqkL3o","rPcQaiyDxMwLr7Q9eFmn5VnVx2RN57MUmN","r3ipidkRUZWq8JYVjnSnNMf3v7o69vgLEW"],domain:"ripplefox.com"},{name:"TokyoJPY",accounts:[{address:"r94s8px6kSw1uZ1MV98dhSRTvc6VMPoPcN",currencies:["JPY"]}],hotwallets:[],domain:"tokyojpy.com"},{name:"Rippex",accounts:[{address:"rfNZPxoZ5Uaamdp339U9dCLWz2T73nZJZH",currencies:["BRL"]}],hotwallets:["r37FUji17jCgCZvAUc8m5YqXquwHpgwa9q"],domain:"rippex.net"},{name:"RippleMarketJapan",accounts:[{address:"rJRi8WW24gt9X85PHAxfWNPCizMMhqUQwg",currencies:["JPY"]}],hotwallets:[],domain:"ripple-market.jp"},{name:"RippleExchangeTokyo",accounts:[{address:"r9ZFPSb1TFdnJwbTMYHvVwFK1bQPUCVNfJ",currencies:["JPY"]}],hotwallets:[],domain:"ripplex.co.jp"},{name:"Ripula-UK",accounts:[{address:"rBycsjqxD8RVZP5zrrndiVtJwht7Z457A8",currencies:["GBP"]}],hotwallets:["rUR5QVHqFxRa8TSQawc1M6jKj7BvKzbHek"],domain:"ripula.co.uk"},{name:"ice3x",accounts:[{address:"rLpKwneVStAVwPhgCgNJVFCePq5J3xaNpN",currencies:["ZAR"]}],domain:"www.ice3x.co.za"},{name:"Senderas",accounts:[{address:"rJypGvB8H2JBj1QVYofUTU8kFtWLspNWqs",currencies:["GBP"]}],domain:"www.senderas.com"},{name:"Gatehub",accounts:[{address:"rhub8VRN55s94qWKDv6jmDy1pUykJzF3wq",currencies:["USD","EUR"]}],domain:"www.gatehub.net"},{name:"Bluzelle",accounts:[{address:"raBDVR7JFq3Yho2jf7mcx36sjTwpRJJrGU",currencies:["CAD"]}],domain:"bluzelle.com"}]},function(e,t,n){var r=n(6),o=n(18),a=n(55).Tab,i=n(3),s=ripple.Amount,c=function(){a.call(this)};r.inherits(c,a),c.prototype.tabName="history",c.prototype.mainMenu="wallet",c.prototype.angular=function(e){e.controller("HistoryCtrl",["$scope","rpId","rpNetwork","rpTracker","rpAppManager","$routeParams","$location",function(e,t,n,r,a,c,u){function d(){if(e.userHistory&&c.types){e.historyShow=[];var t={limit:Options.transactions_per_page,offset:e.pagination.currentPage>1?(e.pagination.currentPage-1)*Options.transactions_per_page:0};c.types&&(t.type=c.types),c.start&&(t.start=c.start),c.end&&(t.end=c.end),e.userHistory.getHistory(t).success(function(t){e.loadingHistory=!1,l(t)}).error(function(){e.loadingHistory=!1}),e.userHistory.getCount(t).success(function(t){e.pagination.count=t.count})}}function l(n){n.transactions.length&&n.transactions.forEach(function(n){var r=i.processTxn(n.tx,n.meta,t.account);if(r){var o=[],a=!1,s=!1;r.effects&&($.each(r.effects,function(){var e=this;switch(e.type){case"offer_funded":case"offer_partially_funded":case"offer_bought":a=!0;case"offer_cancelled":if("offer_cancelled"===e.type&&(s=!0,r.transaction&&"offercancel"===r.transaction.type))return;o.push(e)}}),r.showEffects=o,o=[],$.each(r.effects,function(){var e=this;switch(e.type){case"fee":case"balance_change":case"trust_change_balance":o.push(e)}}),r.balanceEffects=o),e.historyShow.push(r)}})}e.details=[],e.pagination={currentPage:c.page?c.page:1,transactionsPerPage:Options.transactions_per_page},e.loadingHistory=!0,e.types=[{name:"Payments & Orders",types:["Payment","OfferCreate","OfferCancel"],checked:c.types&&-1!==c.types.indexOf("Payment,OfferCreate,OfferCancel")},{name:"Gateways",types:["TrustSet"],checked:c.types&&-1!==c.types.indexOf("TrustSet")},{name:"Other",types:["AccountSet"],checked:c.types&&-1!==c.types.indexOf("AccountSet")}],e.dateMinView=c.start?new Date(c.start):"",e.dateMaxView=c.end?new Date(c.end):"",e.customDate=e.dateMinView||e.dateMaxView,e.historyShow=[],e.historyCsv="",e.$watch("types",function(t,n){n&&t!=n&&u.url(e.generateUrl())},!0),e.$watch("customDate",function(){e.customDate||!e.dateMinView&&!e.dateMaxView||(e.dateMinView=null,e.dateMaxView=null,u.url(e.generateUrl()))}),e.$watch("pagination.currentPage",function(){e.pagination.currentPage!==c.page&&u.url(e.generateUrl())});var p=e.$watch("userHistory",function(){e.noUserHistory&&(e.loadingHistory=!1),e.userHistory&&(d(),p())});e.submitDateRangeForm=function(){u.url(e.generateUrl())},e.generateUrl=function(t){var n="";t||(t=e.pagination.currentPage);var r=_.where(e.types,{checked:!0}),o=_.map(r,"types").join(",");return o=o?o:_.map(e.types,"types").join(","),o&&(n+="&types="+o),e.dateMinView&&(n+="&start="+e.dateMinView.toISOString()),e.dateMaxView&&(n+="&end="+e.dateMaxView.toISOString()),c.types!==o&&(t=1),"/history?page="+t+n};var f=function(e){return"undefined"!=typeof e},m=function(e,t){var n=e.charAt(0);return(t?n.toUpperCase():n.toLowerCase())+e.slice(1)},h=function(t){var n;return""!==t&&(n=o.isContact(e.userBlob.data.contacts,t)),n?n:t},g=function(e){var t=e.to_json();return"number"==typeof t&&isNaN(t)?"":t},v=function(e){var t="";return e instanceof s&&(t=e.to_human({group_sep:!1,precision:2}),t.length>1&&0===+t&&(t=e.to_human({group_sep:!1,precision:20,max_sig_digits:5}))),t};e.exportCsv=function(){for(var n="Date,Time,Ledger Number,Transaction Type,Trust address,Address sent from,Amount sent/sold,Currency sent/sold,Issuer of sent/sold ccy,Address sent to,Amount received,Currency received,Issuer of received ccy,Executed Price,Network Fee paid,Transaction Hash\r\n",r=function(e){n+=[e.Date,e.Time,e.LedgerNum,e.TransType,e.TrustAddr,e.FromAddr,e.SentAmount,e.SentCcy,e.SentIssuer,e.ToAddr,e.RecvAmount,e.RecvCcy,e.RecvIssuer,e.ExecPrice,e.Fee,e.TransHash].join(",")+"\r\n"},o=function(e,t,n){null!==t&&t instanceof s&&(e.SentAmount=v(t),e.SentCcy=t.currency().get_iso(),e.SentIssuer=h(g(t.issuer()))),null!==n&&n instanceof s&&(e.RecvAmount=v(n),e.RecvCcy=n.currency().get_iso(),e.RecvIssuer=h(g(n.issuer())))},a=0;a<e.historyShow.length;a++){var i,c=e.historyShow[a],u=c.transaction,d=c.tx_type,l=moment(c.date),p="NA",_={},y={},b={},w={},x={},k=f(u)?u.type:null;if("failed"!==k&&"tesSUCCESS"===c.tx_result)if(y.Date=l.format("YYYY-MM-DD"),y.Time=l.format("HH:mm:ss"),y.LedgerNum=c.ledger_index,y.Fee=v(c.fee),y.TransHash=c.hash,y.TrustAddr=y.FromAddr=y.ToAddr=p,y.RecvAmount=y.RecvCcy=y.ExecPrice=p,"TrustSet"===d){var S="";if("trusted"===k)S="Incoming ";else{if("trusting"!==k)continue;S="Outgoing "}b.TransType=S+"trust line",b.TrustAddr=h(u.counterparty),b.SentAmount=v(u.amount),b.SentCcy=u.currency,b.SentIssuer=b.RecvIssuer=p,_=$.extend({},y,b),r(_)}else if("Payment"===d&&null!==k){if("sent"===k)i=!0;else if("received"===k)i=!1;else{if("exchange"!==k)continue;i=null}w.TransType=m(k,!0)+" "+m(d,!1),null===i?w.TransType=m(k,!0):i?(w.ToAddr=h(u.counterparty),
w.FromAddr=h(t.account)):(w.FromAddr=h(u.counterparty),w.ToAddr=h(t.account)),f(u.amountSent)&&(amtSent=u.amountSent,w.SentAmount=f(amtSent.value)?amtSent.value:v(s.from_json(amtSent)),w.SentCcy=f(amtSent.currency)?amtSent.currency:"XRP",f(u.sendMax)&&(w.SentIssuer=h(u.sendMax.issuer))),w.RecvAmount=v(u.amount),w.RecvCcy=u.currency,w.RecvIssuer=h(g(u.amount.issuer())),_=$.extend({},y,w),r(_)}else if("Payment"===d||"OfferCreate"===d||"OfferCancel"===d){var A;if("offernew"===k)o(x,u.gets,u.pays),x.TransType="Offer Created",_=$.extend({},y,x),r(_);else if("offercancel"===k)for(var T=0;T<c.effects.length;T++)if(A=c.effects[T],"offer_cancelled"===A.type){o(x,A.gets,A.pays),x.TransType="Offer Cancelled",_=$.extend({},y,x),r(_);break}for(var C=0;C<c.showEffects.length;C++)switch(A=c.showEffects[C],buy=null,sell=null,x={},A.type){case"offer_bought":case"offer_funded":case"offer_partially_funded":"offer_bought"===A.type?(buy=f(A.paid)?A.paid:A.pays,sell=f(A.got)?A.got:A.gets):(buy=f(A.got)?A.got:A.gets,sell=f(A.paid)?A.paid:A.pays),o(x,buy,sell),x.TransType="Executed offer",x.ExecPrice=v(A.price),_=$.extend({},y,x),C>0&&(_.Fee=""),r(_)}}}e.historyCsv=e.historyShow.length?n:""}}])},e.exports=c},function(e,t,n){var r=n(6),o=(n(18),n(55).Tab),a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="contacts",a.prototype.mainMenu="wallet",a.prototype.aliases=["contact"],a.prototype.angular=function(e){e.controller("ContactsCtrl",["$scope","rpId","rpTracker",function(e,t,n){e.sort_options={sort_field:"contact",reverse:!1},e.reset_form=function(){e.contact={name:"",view:"",address:"",federation:null},e.addForm&&e.addForm.$setPristine()},e.reset_form(),e.toggle_form=function(){e.addform_visible=!e.addform_visible,e.reset_form()},e.create=function(){var t={name:e.contact.name,view:e.contact.view,address:e.contact.address};e.contact.dt&&!e.contact.federation&&(t.dt=e.contact.dt),e.enable_highlight=!0,e.userBlob.unshift("/contacts",t),e.toggle_form(),e.reset_form(),e.load_notification("createContactSuccess")}}]),e.controller("ContactRowCtrl",["$scope","$location",function(e,t){e.editing=!1,e.edit=function(t){e.editing=!0,e.editname=e.entry.name,e.editaddress=e.entry.address,e.editview=e.entry.view||e.entry.address,e.editdt=e.entry.dt},e.update=function(t){if(!e.inlineAddress.editaddress.$error.rpUnique&&!e.inlineAddress.editaddress.$error.rpDest&&!e.inlineName.editname.$error.rpUnique){var n={name:e.editname,view:e.editview,address:e.editaddress};e.editdt&&!e.contact.federation&&(n.dt=e.editdt),e.userBlob.filter("/contacts","name",e.entry.name,"extend","",n),!e.editdt&&e.entry.dt&&e.userBlob.filter("/contacts","name",e.entry.name,"unset","/dt"),e.editing=!1,e.load_notification("updateContactSuccess")}},e.remove=function(t){e.entry.name?(e.userBlob.filter("/contacts","name",e.entry.name,"unset",""),e.load_notification("removeContactSuccess")):e.userBlob.unset("/contacts/"+t)},e.cancel=function(t){e.editing=!1},e.send=function(n){var r={to:e.entry.name};t.path("/send"),t.search(r)}}])},e.exports=a},function(e,t,n){(function(t){var r=n(6),o=n(18),a=n(12),i=n(55).Tab,s=ripple.Amount,c=(ripple.Base,n(3)),u=ripple.Currency,d=function(){i.call(this)};r.inherits(d,i),d.prototype.tabName="exchange",d.prototype.mainMenu="exchange",d.prototype.angular=function(e){e.controller("ExchangeCtrl",["$scope","$timeout","$routeParams","rpId","rpNetwork","rpTracker","rpKeychain","rpAPI","$rootScope","$location",function(e,n,r,i,d,l,p,f,m,h){function g(){e.exchangeForm.$valid?e.update_exchange():(y(),e.reset_paths(),e.exchange.path_status="waiting")}function v(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tep":e.tx_result="partial";break;case"tec":e.tx_result="claim";break;case"tef":e.tx_result="failure";break;case"tel":e.tx_result="local";break;default:e.tx_result="unknown",console.warn("Unhandled engine status encountered!")}}function y(){x&&"function"==typeof x.close&&(x.close(),x=null),clearInterval(w)}var b,w,x=null;if(a.blobIsValid(e.userBlob))a.getSetting(e.userBlob,"rippleExchangeSelectionTrade",!1)&&e.userBlob.set("/clients/rippletradecom/rippleExchangeSelectionTrade",!1);else var $=e.$on("$blobUpdate",function(){a.getSetting(e.userBlob,"rippleExchangeSelectionTrade",!1)&&e.userBlob.set("/clients/rippletradecom/rippleExchangeSelectionTrade",!1),$()});m.ripple_exchange_selection_trade=!1;var k=u.from_json("XRP");e.xrp={name:k.to_human({full_name:e.currencies_all_keyed.XRP.name}),code:k.get_iso(),currency:k},e.$watch("exchange.amount",g,!0),e.$watch("exchange.currency_name",function(){var n=e.exchange,r=u.from_human(e.exchange.currency_name?e.exchange.currency_name:"XRP");n.currency_obj=r,n.currency_code=r.get_iso(),n.currency_name=r.to_human({full_name:e.currencies_all_keyed[r.get_iso()]?e.currencies_all_keyed[r.get_iso()].name:null}),t(function(){void 0!==e.exchangeForm.amount&&e.$apply(function(){e.exchangeForm.amount.$$parseAndValidate(),g()})})},!0),e.gotoFund=function(){h.path("/xrp")},e.reset_paths=function(){var t=e.exchange;t.alternatives=[]},e.update_exchange=function(){var t=e.exchange,r=ripple.Currency.from_human(t.currency_name);if(e.reset_paths(),0===parseFloat(t.amount)||!t.currency_name)return e.error_type="required",!1;e.error_type="";var o=r.has_interest()?r.to_hex():r.get_iso(),a=/^([a-zA-Z0-9]{3}|[A-Fa-f0-9]{40})\b/.exec(o);if(a){var c=new Date((new Date).getTime()+3e5);t.amount_feedback=s.from_human(""+t.amount+" "+o,{reference_date:c}),t.amount_feedback.set_issuer(i.account),t.amount_feedback.is_valid()&&t.amount_feedback.is_positive()?(t.path_status="pending",t.alt=null,b&&clearTimeout(b),b=n(e.update_paths,500)):t.path_status="waiting"}},e.update_paths=function(){e.exchangeForm.$invalid||e.$apply(function(){e.exchange.path_status="pending";var t=e.exchange.amount_feedback;if(!t.is_zero()){x=d.remote.path_find(i.account,i.account,t,e.generate_src_currencies());var n,r=e.generate_issuer_currencies(),o=!0;x.on("update",function(i){if(null!==x){if(o&&(!i.alternatives||!i.alternatives.length))return void(o=!1);o=!1,e.$apply(function(){if(n=new Date,clearInterval(w),w=setInterval(function(){e.$apply(function(){var t=Math.round((new Date-n)/1e3);e.lastUpdate=t||0})},1e3),i.alternatives&&i.alternatives.length){var o={};e.exchange.path_status="done",e.exchange.alternatives=_.filter(_.map(i.alternatives,function(n){var i={};i.amount=s.from_json(n.source_amount),i.rate=i.amount.ratio_human(t);var c=a.getSetting(e.userBlob,"exchangeMaxDeviation",.1);return i.send_max=i.amount.scale(1+c/100),i.paths=n.paths_computed?n.paths_computed:n.paths_canonical,i.amount.issuer().to_json()==e.address||r[i.amount.currency().to_hex()]||(o[i.amount.currency().to_hex()]=!0),i}),function(t){return o[t.amount.currency().to_hex()]?t.amount.issuer().to_json()!=e.address:!(t.amount.is_native()&&e.account.max_spend&&e.account.max_spend.to_number()>1&&e.account.max_spend.compareTo(t.amount)<0)}),e.exchange.alternatives.length||(e.exchange.path_status="no-path",e.exchange.alternatives=[])}else e.exchange.path_status="no-path",e.exchange.alternatives=[]})}}),x.on("error",function(t){e.$apply(function(){e.reset_paths(),e.exchange.path_status="waiting"})})}})};var S=function(){var t=_.uniq(_.map(e.lines,function(e){return e.currency}));t.unshift("XRP");for(var n=0;n<t.length;n++)t[n]=ripple.Currency.from_json(t[n]);t=_.map(t,function(t){return e.currencies_all_keyed[t.get_iso()]?t.to_human({full_name:e.currencies_all_keyed[t.get_iso()].name}):t.get_iso()}),e.currency_choices=t};e.$on("$balancesUpdate",S),e.reset=function(){e.mode="form",e.exchange={amount:"",currency_name:e.xrp.name,currency_code:e.xrp.code,currency_obj:e.xrp.currency,path_status:"waiting",fund_status:"none"},e.nickname="",e.error_type="",e.exchangeForm&&e.exchangeForm.$setPristine(!0)},e.cancelConfirm=function(){e.mode="form",e.exchange.alt=null},e.reset_goto=function(t){e.reset(),document.location="#"+t},e.exchange_prepared=function(){e.confirm_wait=!0,n(function(){e.confirm_wait=!1},1e3,!0),e.networkFee=d.remote.transaction()._computeFee(),Options.confirmation.exchange?(e.mode="confirm",e.exchangeMaxDeviation=a.getSetting(e.userBlob,"exchangeMaxDeviation",1)):e.exchange_confirmed()},e.exchange_confirmed=function(){var n=u.from_human(e.exchange.currency_name);n=n.has_interest()?n.to_hex():n.get_iso();var r=s.from_human(""+e.exchange.amount+" "+n);r.set_issuer(i.account);var a=d.remote.transaction();return a.addMemo("client","text/plain","rt"+m.version),a.destination_tag(o.getDestTagFromAddress(i.account)),a.payment(i.account,i.account,r.to_json()),a.send_max(e.exchange.alt.send_max),a.paths(e.exchange.alt.paths),e.exchange.secret?(a.secret(e.exchange.secret),a.on("proposed",function(t){e.$apply(function(){v(t,!1),e.exchanged(a.hash);for(var n,r=0;r<e.currencies_all.length;r++)if(e.currencies_all[r].value.toLowerCase()===e.exchange.amount_feedback.currency().get_iso().toLowerCase()){e.currencies_all[r].order++,n=!0;break}})}),a.on("success",function(t){v(t,!0);try{var n=c.processTxn(t.tx_json,t.metadata,i.account),o=_.map(n.affectedCurrencies,function(e){if("XRP"!=e){var t=_.filter(n.effects,function(t){return t.type=t.currency==e})[0],r=e+"."+i.resolveNameSync(t.amount.issuer().to_json(),{tilde:!0});return r}return e}),a=o.join("/"),s={Status:"success","Currency pair":a,Address:e.userBlob.data.account_id,"Transaction ID":t.tx_json.hash,Amount:r.to_number(!1)};l.track("Convert order result",s),f.addTransaction(t.tx_json,s,t.tx_json.hash,(new Date).toString())}catch(u){console.warn(u)}}),a.on("error",function(n){t(function(){e.$apply(function(){e.mode="rippleerror",v(n,!1),"remoteError"===n.error&&"noPath"===n.remote.error&&(e.mode="status",e.tx_result="noPath")})});try{var r=e.exchange.alt.amount.currency().get_iso(),o=e.exchange.currency_code+"/"+r,a={Status:"error",Message:n.engine_result,"Currency pair":o,Address:e.userBlob.data.account_id};l.track("Convert order result",a),f.addTransaction(n.tx_json,a,n.tx_json.hash,(new Date).toString())}catch(i){console.warn(i)}}),f.getUserAccess().then(function(e){a.submit()},function(n){t(function(){e.$apply(function(){e.mode="rippleerror"})})}),void(e.mode="sending")):void p.requestSecret(i.account,i.username,function(t,n){return t?(console.log("client: exchange tab: error while unlocking wallet: ",t),e.mode="error",void(e.error_type="ccm: tag doesn't match"===t.message?"wrongPassword":"unlockFailed")):(e.exchange.secret=n,void e.exchange_confirmed())})},e.exchanged=function(t){function n(r){e.$apply(function(){r.transaction.hash===t&&(v(r,!0),d.remote.removeListener("transaction",n))})}e.mode="status",d.remote.on("transaction",n)},e.reset(),S(),e.$on("$destroy",y)}])},e.exports=d}).call(t,n(15).setImmediate)},function(e,t,n){"use strict";var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="account",a.prototype.mainMenu="account",a.prototype.extraRoutes=[{name:"/account/:route"}],a.prototype.angular=function(e){e.controller("AccountCtrl",["$scope","$routeParams",function(e,t){t.route||(t.route="public")}])},e.exports=a},function(e,t,n){(function(t){"use strict";var r=n(6),o=n(18),a=n(55).Tab,i=(ripple.Amount,ripple.Currency),s=function(){a.call(this)};r.inherits(s,a),s.prototype.tabName="trust",s.prototype.mainMenu="fund",s.prototype.angular=function(e){e.controller("TrustCtrl",["$scope","rpBooks","$timeout","$routeParams","rpId","$filter","rpNetwork","rpTracker","rpKeychain","rpAPI",function(e,n,r,a,s,c,u,d,l,p){function f(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}}var m=[];e.trust={},e.sorting={predicate:"balance",reverse:!0,sort:function(t){return"currency"===e.sorting.predicate?t.currency:t.balance.to_number()}},e.validation_pattern=/^0*(([1-9][0-9]*.?[0-9]*)|(.0*[1-9][0-9]*))$/,e.reset=function(){e.mode="main";var t=i.from_human("USD");e.currency=t.to_human({full_name:e.currencies_all_keyed[t.get_iso()].name}),e.addform_visible=!1,e.edituser="",e.amount=Options.gateway_max_limit,e.allowrippling=!1,e.counterparty="",e.counterparty_view="",e.counterparty_address="",e.saveAddressName="",e.error_account_reserve=!1},e.toggle_form=function(){e.addform_visible?e.reset():e.addform_visible=!0},e.$watch("account",function(){e.acctDefaultRippleFlag=e.account.Flags&ripple.Remote.flags.account_root.DefaultRipple,e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0),e.$watch("counterparty",function(){e.error_account_reserve=!1,e.contact=o.getContact(e.userBlob.data.contacts,e.counterparty),e.contact?(e.counterparty_name=e.contact.name,e.counterparty_address=e.contact.address):(e.counterparty_name="",e.counterparty_address=e.counterparty)},!0),e.grant=function(){e.verifying=!0,e.error_account_reserve=!1,u.remote.requestAccountInfo({account:e.counterparty_address}).on("success",function(t){e.$apply(function(){e.verifying=!1,e.lineCurrencyObj=i.from_human(e.currency);var t=e.lineCurrencyObj.has_interest()?e.lineCurrencyObj.to_hex():e.lineCurrencyObj.get_iso(),n=/^([a-zA-Z0-9]{3}|[A-Fa-f0-9]{40})\b/.exec(t);if(!n)return void console.error("Currency code:",n,"is not recognized");(Options.advanced_feature_switch===!1||""===e.amount)&&(e.amount=Options.gateway_max_limit);var o=ripple.Amount.from_human(""+e.amount+" "+e.lineCurrencyObj.to_hex(),{reference_date:new Date(+new Date+3e5)});o.set_issuer(e.counterparty_address),o.is_valid()&&(e.amount_feedback=o,e.confirm_wait=!0,r(function(){e.confirm_wait=!1},1e3,!0),e.mode="confirm")})}).on("error",function(n){t(function(){e.$apply(function(){e.verifying=!1,e.error_account_reserve=!0,console.log("There was an error",n)})})}).request()},e.grant_confirmed=function(){var n=e.amount_feedback.to_json(),r=u.remote.transaction();r.addMemo("client","text/plain","rt"+e.version),r.rippleLineSet(s.account,n).setFlags(e.allowrippling?"ClearNoRipple":"NoRipple").on("proposed",function(t){e.$apply(function(){f(t,!1),e.granted(r.hash);for(var n,o=0;o<e.currencies_all.length;o++)if(e.currencies_all[o].value.toLowerCase()===e.amount_feedback.currency().get_iso().toLowerCase()){e.currencies_all[o].order++,n=!0;break}})}).on("success",function(t){e.$apply(function(){f(t,!0)}),p.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){t(function(){e.$apply(function(){e.mode="error",f(n,!1),e.reset()})}),p.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),l.requestSecret(s.account,s.username,function(n,o){return n?(e.load_notification("unlock_failed"),void e.reset()):(e.mode="granting",r.secret(o),void p.getUserAccess().then(function(e){r.submit()},function(n){t(function(){e.$apply(function(){e.mode="error",e.reset()})})}))}),e.toggle_form()},e.granted=function(t){function n(r){e.$apply(function(){r.transaction.hash===t&&(f(r,!0),u.remote.removeListener("transaction",n))})}e.mode="granted",u.remote.on("transaction",n),r(function(){e.mode="main"},1e4)},e.$watch("userBlob.data.contacts",function(t){e.counterparty_query=o.queryFromContacts(t)},!0);for(var h=0;h<e.currencies_all.length;h++)e.currencies_all[h].display&&m.push(e.currencies_all[h]);e.currency_query=o.queryFromOptionsIncludingKeys(m),e.reset();var g=function(){var t={};_.each(e.lines,function(n){e.isSignificantLine(n)&&(t[n.currency]||(t[n.currency]={components:[]}),t[n.currency].components.push(n))}),e.accountLines=t};e.$on("$balancesUpdate",function(){g()}),g()}]),e.controller("AccountRowCtrl",["$scope","rpBooks","rpNetwork","rpId","rpKeychain","rpAPI","$timeout",function(e,n,r,o,a,s,c){function u(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}}e.minVal=e.entry.components[0].limit_peer.to_human({rel_precision:2}),0!==e.minVal&&(e.minVal=-1*e.minVal),e.minVal=Number(e.minVal).toFixed(2),e.cancel=function(){e.editing=!1},e.edit_account=function(){e.editing=!0,e.trust={},e.trust.limit=String(e.component.limit.to_json().value),e.trust.rippling=!e.component.no_ripple,e.trust.limit_peer=Number(e.component.limit_peer.to_json().value),e.trust.balance=String(e.component.balance.to_json().value),e.trust.balanceAmount=e.component.balance;var t=i.from_human(e.component.currency);t.to_human({full_name:e.currencies_all_keyed[t.get_iso()]})?e.trust.currency=t.to_human({full_name:e.currencies_all_keyed[t]}):e.trust.currency=t.to_human({full_name:e.currencies_all_keyed[t.get_iso()].name}),e.trust.counterparty=e.component.account,e.load_orderbook()},e.delete_account=function(){e.trust.loading=!0,e.load_notification("remove_gateway"),e.trust.state="removing";var n=function(n){n.on("proposed",function(t){e.$apply(function(){u(t,!1)})}).on("success",function(t){e.$apply(function(){u(t,!0)}),s.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){console.log("error",n),t(function(){e.$apply(function(){"tejMaxFeeExceeded"===n.result&&e.load_notification("max_fee"),e.mode="error",u(n,!1),e.trust.loading=!1})}),s.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),a.requestSecret(o.account,o.username,function(r,o){return r?(e.mode="error",e.trust.loading=!1,e.load_notification("unlock_failed"),console.log("Error on requestSecret: ",r),void e.reset()):(n.secret(o),void s.getUserAccess().then(function(e){n.submit()},function(n){t(function(){e.$apply(function(){e.mode="error",e.trust.loading=!1})})}))})},i=function(t,o,a){var i=r.remote.transaction();i.addMemo("client","text/plain","rt"+e.version),i.trustSet(t,"0/"+o+"/"+a),e.acctDefaultRippleFlag?i.setFlags("ClearNoRipple"):i.setFlags("NoRipple"),n(i)},c=function(t,o,a,i,s){var c=function(){var n=r.remote.transaction();n.addMemo("client","text/plain","rt"+e.version);var s=n.payment(t,t,"100000000000");return s.setFlags("PartialPayment"),s.sendMax(i.to_human()+"/"+a+"/"+o),n},u=function(){var n=r.remote.transaction();n.addMemo("client","text/plain","rt"+e.version);var a=i.clone(),s=a.set_issuer(o);n.payment(t,o,s);return n},d="exists"===e.orderbookStatus?c():u();n(d),d.once("proposed",s)};"0"!==e.trust.balance?!function(t){c(o.account,e.trust.counterparty,e.trust.currency,e.trust.balanceAmount,function(n){i(o.account,e.trust.currency,t)})}(e.trust.counterparty):i(o.account,e.trust.currency,e.trust.counterparty)},e.load_orderbook=function(){e.orderbookStatus=!1,e.book&&e.book.unsubscribe(),e.book=n.get({currency:e.trust.currency,issuer:e.trust.counterparty},{currency:"XRP",issuer:void 0}),e.$watchCollection("book",function(){e.book.updated&&(0!==e.book.asks.length&&0!==e.book.bids.length?e.orderbookStatus="exists":e.orderbookStatus="not")})},e.save_account=function(){e.trust.loading=!0,e.trust.state="saving";var n=ripple.Amount.from_human(e.trust.limit+" "+e.component.currency,{reference_date:new Date(+new Date+3e5)});if(n.set_issuer(e.component.account),!n.is_valid())return void console.log("Invalid amount");var i=r.remote.transaction();i.addMemo("client","text/plain","rt"+e.version),i.rippleLineSet(o.account,n).setFlags(e.trust.rippling?"ClearNoRipple":"NoRipple").on("proposed",function(t){e.$apply(function(){u(t,!1)})}).on("success",function(t){e.$apply(function(){u(t,!0),e.trust.loading=!1,e.editing=!1,e.load_notification("changes_saved")}),s.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){t(function(){e.$apply(function(){e.mode="error",u(n,!1),"tejMaxFeeExceeded"===n.result&&e.load_notification("max_fee"),e.trust.loading=!1,e.editing=!1})}),s.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),a.requestSecret(o.account,o.username,function(n,r){return n?(e.trust.loading=!1,e.load_notification("error"),void e.reset()):(e.mode="granting",i.secret(r),void s.getUserAccess().then(function(e){i.submit()},function(n){t(function(){e.$apply(function(){e.mode="error",e.trust.loading=!1,e.editing=!1})})}))})},e.isIncomingOnly=function(){return e.component.limit.is_zero()&&!e.component.limit_peer.is_zero()},e.ripplingEnabled=function(){return!e.component.no_ripple},e.showEnableRipplingWarningMessage=function(){return e.isIncomingOnly()&&!e.ripplingEnabled()&&e.trust.rippling&&"0"!==e.trust.balance}}])},e.exports=s}).call(t,n(15).setImmediate)},function(e,t,n){(function(t){var r=n(6),o=n(18),a=n(12),i=n(55).Tab,s=ripple.Amount,c=ripple.Currency,u=(ripple.Base,ripple.RippleError,function(){i.call(this)});r.inherits(u,i),u.prototype.tabName="send",u.prototype.mainMenu="send",u.prototype.angularDeps=i.prototype.angularDeps.concat(["federation","keychain"]),u.prototype.angular=function(e){e.controller("SendCtrl",["$scope","$timeout","$routeParams","rpId","rpNetwork","rpFederation","rpTracker","rpKeychain","rpAPI","$interval",function(e,n,r,i,u,d,l,p,f,m){function h(){"function"==typeof y&&y(),v&&(m.cancel(v),v=null)}var g,v,y,b,w,x=c.from_json("XRP");if(e.xrp={name:x.to_human({full_name:e.currencies_all_keyed.XRP.name}),code:x.get_iso(),currency:x},e.$watch("send.recipient",function(t){if(t){var n=o.stripRippleAddress(e.send.recipient),r=o.getDestTagFromAddress(e.send.recipient);r&&(e.send.dt=r),e.contact=o.getContact(e.userBlob.data.contacts,n),e.contact?(e.send.recipient===e.contact.address&&(e.send.recipient=e.contact.name),e.send.recipient_name=e.contact.name,e.send.recipient_address=e.contact.address,e.contact.dt&&!r&&(e.send.dt=e.contact.dt)):(e.send.recipient_name="",e.send.recipient_address=n),e.update_destination()}},!0),e.$watch("send.currency",function(){var n=ripple.Currency.from_json(e.send.currency);""!==e.send.currency&&n.is_valid()?e.send.currency_code=n.to_human().toUpperCase():e.send.currency_code="",e.update_currency(),t(function(){e.sendForm&&void 0!==e.sendForm.send_amount&&e.$apply(function(){e.sendForm.send_amount.$$parseAndValidate(),e.update_amount()})})},!0),e.$watch("send.amount",function(){e.update_amount()},!0),e.$watch("send.extra_fields",function(){e.update_amount()},!0),e.$watch("sendForm.$valid",function(t){t?e.update_amount():(e.send.last_recipient=null,e.send.path_status="waiting",e.send.fund_status="none",e.send.pathfind&&(e.send.pathfind.close(),delete e.send.pathfind),b&&(n.cancel(b),b=null),e.reset_paths())}),e.reset_destination_deps=function(){var t=e.send;t.self=!1,t.quote_url=!1,t.federation=!1,t.fund_status="none",t.extra_fields=[],e.sendForm&&e.sendForm.send_destination&&(e.sendForm.send_destination.$setValidity("federation",!0),e.sendForm.send_destination.$setValidity("federationDown",!0),e.sendForm.send_destination.$setValidity("btcBridgeWrong",!0),e.sendForm.send_destination.$setValidity("profileUnverified",!0)),t.recipient_resolved=!1,t.recipient_actual=void 0,t.amount_actual=void 0,e.reset_currency_deps()},e.check_dt_visibility=function(){var t=e.send;t.show_dt_field=(r.dt||t.dt||t.recipient_info&&"object"==typeof t.recipient_info&&t.recipient_info.dest_tag_required)&&(!t.federation||t.federation_record&&!t.federation_record.dt)},e.update_destination=function(){var t=e.send,r=t.recipient_address;if(r!==t.last_recipient){if(t.toBitcoin=!1,t.last_recipient=r,e.reset_destination_deps(),t.self=r===e.address,t.rippleName=o.isRippleName(r),t.federation="string"==typeof r&&~r.indexOf("@"),t.federation){if("verified"!==store.get("profile_status"))return void(e.sendForm&&e.sendForm.send_destination&&e.sendForm.send_destination.$setValidity("profileUnverified",!1));if("btc2ripple.com"==r.substring(r.indexOf("@")+1)&&"US"==store.get("profile_country"))return void(e.sendForm&&e.sendForm.send_destination&&e.sendForm.send_destination.$setValidity("btc2rippleUSCustomer",!1))}e.check_dt_visibility(),g&&n.cancel(g),g=n(e.update_destination_remote,500)}},e.update_destination_remote=function(){var t=e.send,n=t.recipient_address,r=o.stripRippleAddress(t.recipient),a=ripple.UInt160.is_valid(r);e.sendForm&&e.sendForm.send_destination&&(e.sendForm.send_destination.$setValidity("federation",!0),e.sendForm.send_destination.$setValidity("federationDown",!0),e.sendForm.send_destination.$setValidity("btcBridgeWrong",!0),e.sendForm.send_destination.$setValidity("profileUnverified",!0)),t.federation_record&&(t.federation_record=null,t.dt=null),t.federation?(t.path_status="fed-check",d.check_email(n).then(function(r){var o=t.recipient_address;n===o&&(t.federation_record=r,r.extra_fields&&(t.extra_fields=r.extra_fields),t.dt="number"==typeof r.dt?r.dt:void 0,r.destination_address?(t.recipient_name=n,t.recipient_address=r.destination_address,e.check_destination()):r.quote_url?(t.recipient_info={},t.quote_url=r.quote_url,t.quote_destination=r.destination,t.path_status="waiting",e.update_currency_constraints()):(t.path_status="waiting",e.sendForm.send_destination.$setValidity("federation",!1)))},function(r){var o=t.recipient_actual||t.recipient_address;if(n===o)if(t.path_status="waiting",t.toBitcoin)e.sendForm.send_destination.$setValidity("btcBridgeWrong",!1);else if(r&&"down"===r.error){e.sendForm.send_destination.$setValidity("federationDown",!1);var a=r.url.split("/").slice(0,3).join("/");e.send.federationURL=a}else e.sendForm.send_destination.$setValidity("federation",!1)})):t.rippleName?rippleVaultClient.AuthInfo.get(Options.domain,t.recipient,function(n,r){e.$apply(function(){t.recipient_name="~"+r.username,t.recipient_address=r.address}),e.check_destination()}):a&&t.recipient_address==r?i.resolveName(r,{tilde:!0}).then(function(n){t.recipient_name=n,t.recipient===n?e.check_destination():(t.last_recipient=null,t.recipient=n)},function(t){e.check_destination()}):e.check_destination()},e.check_destination=function(){var t=e.send,n=t.recipient_actual||t.recipient_address;if(ripple.UInt160.is_valid(n)&&e.account&&e.account.reserve_base){if(!t.federation&&e.contact&&e.contact.noDestinationCheck)return t.recipient_info={loaded:!0,exists:!0,Balance:e.account.reserve_base,disallow_xrp:0,dest_tag_required:0},t.recipient_resolved=!0,e.check_dt_visibility(),t.recipient_lines=!1,void e.update_currency_constraints();var r=u.remote.account(n);t.path_status="checking",t.recipient_info=null,r.entry(function(r,o){e.$apply(function(){var a=t.recipient_actual||t.recipient_address;if(n===a)if(t.recipient_resolved=!0,r)"actNotFound"===r.remote.error&&(t.recipient_info={loaded:!0,exists:!1,Balance:"0"},e.update_currency_constraints());else{if(t.recipient_info={loaded:!0,exists:!0,Balance:o.account_data.Balance,disallow_xrp:o.account_data.Flags&ripple.Remote.flags.account_root.DisallowXRP,dest_tag_required:o.account_data.Flags&ripple.Remote.flags.account_root.RequireDestTag},e.check_dt_visibility(),!e.account||!e.account.reserve_base)return;var i=e.account.reserve_base;t.xrp_deficiency=i.subtract(o.account_data.Balance),!t.federation&&e.contact&&!t.recipient_info.disallow_xrp&&!t.recipient_info.dest_tag_required&&t.xrp_deficiency.compareTo(0)<=0&&e.userBlob.filter("/contacts","name",e.contact.name,"set","/noDestinationCheck",!0),t.recipient_lines=!1,e.update_currency_constraints()}})})}},e.update_currency_constraints=function(){var t=e.send;if(t.currency_choices=e.currencies_all,t.currency_force=!1,t.currencyIsBTC=!1,t.currency_choices_constraints={},t.federation_record&&"undefined"!=typeof t.federation_record.amount?(t.force_amount=s.from_json(t.federation_record.amount),t.amount=t.force_amount.to_text(),t.currency_choices_constraints.federation=[t.force_amount.currency().to_json()]):t.federation_record&&$.isArray(t.federation_record.currencies)&&t.federation_record.currencies.length>=1&&"object"==typeof t.federation_record.currencies[0]&&"string"==typeof t.federation_record.currencies[0].currency&&(t.currency_choices_constraints.federation=[],$.each(t.federation_record.currencies,function(){t.currency_choices_constraints.federation.push(this.currency)})),t.quote_url)return void e.update_currency_choices();if(t.recipient_info.loaded){if(t.recipient_info.exists){var n=t.recipient_address;t.currency_choices_constraints.accountLines="pending",u.remote.requestAccountCurrencies({account:n}).on("success",function(r){e.$apply(function(){r.receive_currencies&&t.recipient_address===n&&(t.currency_choices_constraints.accountLines=r.receive_currencies,e.send.recipient_info.disallow_xrp||t.currency_choices_constraints.accountLines.unshift("XRP"),e.update_currency_choices())})}).on("error",function(){}).request()}else t.currency_choices_constraints.accountLines=["XRP"];e.update_currency_choices()}},e.update_currency_choices=function(){var t=e.send,n=[];return-1!==_.values(t.currency_choices_constraints).indexOf("pending")?(t.path_status="account-currencies",void(t.currency_choices=[])):(n=_.values(t.currency_choices_constraints),n=1==n.length?n[0]:_.intersection.apply(_,n),n=_.uniq(_.compact(n)),n=_.map(n,function(t){var n=ripple.Currency.from_json(t);return e.currencies_all_keyed[n.get_iso()]?n.to_human({full_name:e.currencies_all_keyed[n.get_iso()].name}):n.to_human()}),1===n.length?(t.currency=t.currency_force=n[0],t.currencyIsBTC=0===t.currency_force.indexOf("BTC")):0===n.length?(t.path_status="error-no-currency",t.currency=""):(t.currency_force=!1,t.currencyIsBTC=!1,-1===n.indexOf(t.currency)&&(t.currency=n[0])),e.send.currency_choices=n,void e.update_currency())},e.reset_currency_deps=function(){e.reset_amount_deps()},e.update_currency=function(){var t=e.send,n=t.recipient_actual||t.recipient_address;t.currency;e.reset_currency_deps(),(ripple.UInt160.is_valid(n)||t.quote_url)&&t.currency_choices&&0!==t.currency_choices.length&&e.update_amount()},e.reset_amount_deps=function(){var t=e.send;t.sender_insufficient_xrp=!1,t.quote=!1,e.reset_paths()},e.update_amount=function(){var t=e.send,r=t.recipient_actual||t.recipient_address;if(t.currency_choices&&0!==t.currency_choices.length){var o=ripple.Currency.from_human(t.currency),a=o.has_interest()?o.to_hex():o.get_iso(),i=/^([a-zA-Z0-9]{3}|[A-Fa-f0-9]{40})\b/.exec(a);if(i){var s=new Date((new Date).getTime()+3e5),c=t.amount_feedback=ripple.Amount.from_human(""+t.amount+" "+a,{reference_date:s});if(e.reset_amount_deps(),t.path_status="waiting",b&&n.cancel(b),!e.sendForm.$invalid)if(t.quote_url){if(!t.amount_feedback.is_valid())return;t.amount_feedback.set_issuer(1),b=n(e.update_quote,500)}else{if(!ripple.UInt160.is_valid(r)||!ripple.Amount.is_valid(c))return;if(t.amount_feedback.is_native()||t.amount_feedback.set_issuer(r),!t.recipient_info)return;t.sender_insufficient_xrp=t.amount_feedback.is_native()&&e.account.max_spend&&e.account.max_spend.to_number()>1&&e.account.max_spend.compareTo(t.amount_feedback)<0;var u=t.amount_feedback.add(t.recipient_info.Balance),d=e.account.reserve_base;if(u.compareTo(d)<0)return t.fund_status="insufficient-xrp",t.xrp_deficiency=d.subtract(t.recipient_info.Balance),void(t.insufficient=!0);t.insufficient=!1,t.fund_status="none",t.path_status="pending",b=n(e.update_paths,500)}}}},e.update_quote=function(){var n=e.send,r=n.recipient_actual||n.recipient_address;e.reset_paths();try{n.path_status="bridge-quote";var o={type:"quote",amount:n.amount_feedback.to_text()+"/"+n.amount_feedback.currency().to_json(),destination:n.quote_destination,address:e.address};$.isArray(n.extra_fields)&&$.each(n.extra_fields,function(){
o[this.name]=this.value}),$.ajax({url:n.quote_url,dataType:"json",data:o,error:function(){t(function(){e.$apply(function(){e.send.pathfind.close(),e.send.path_status="error-quote"})})},success:function(t){e.$apply(function(){var o=n.recipient_actual||n.recipient_address;if(r===o){var a=n.amount_feedback;if(a.equals(n.amount_feedback)){if(!t||!t.quote||"success"!==t.result&&"success"!==t.status||!Array.isArray(t.quote.send)||!t.quote.send.length||!t.quote.address)return e.send.pathfind.close(),e.send.path_status="error-quote",e.send.quote_error="",void(t&&"error"===t.result&&"string"==typeof t.error_message&&(e.send.quote_error=t.error_message));var i=s.from_json(t.quote.send[0]);n.quote=t.quote,n.recipient_actual=t.quote.address,n.amount_actual=i,e.update_paths()}}})}})}catch(a){console.error(a.stack||a),e.send.pathfind.close(),e.send.path_status="error-quote"}},e.reset_paths=function(){var t=e.send;t.alternatives=[]},e.update_paths=function(){var n,r=e.send,o=r.recipient_actual||r.recipient_address,c=r.amount_actual||r.amount_feedback;e.reset_paths(),r.path_status="pending";var d=u.remote.path_find(i.account,o,c,e.generate_src_currencies()),p=e.generate_issuer_currencies();r.pathfind=d,r.pathfindJustStarted=!0;var f;d.on("update",function(t){if("error-quote"!==e.send.path_status){if(r.pathfindJustStarted&&(!t.alternatives||!t.alternatives.length))return void(r.pathfindJustStarted=!1);r.pathfindJustStarted=!1,e.$apply(function(){f=new Date,clearInterval(w),w=setInterval(function(){e.$apply(function(){var t=Math.round((new Date-f)/1e3);e.lastUpdate=t||0})},1e3);var i=r.recipient_actual||r.recipient_address;if(o===i){var u=r.amount_actual||r.amount_feedback;if(u.equals(c)){if(t.alternatives&&t.alternatives.length){var d={},h=[];e.send.path_status="done",e.send.alternatives=_.map(t.alternatives,function(t,n){var r={};r.amount=s.from_json(t.source_amount);var o=new Date(+new Date+3e5);r.rate=r.amount.ratio_human(c,{reference_date:o});var i=a.getSetting(e.userBlob,"sendMaxDeviation",.1);return r.send_max=r.amount.scale(1+i/100),r.paths=t.paths_computed||t.paths_canonical,t.source_amount.currency?t.source_amount.currency===e.send.currency_code&&h.push(r):"XRP"===e.send.currency_code&&h.push(r),r.amount.issuer().to_json()==e.address||p[r.amount.currency().to_hex()]||(d[r.amount.currency().to_hex()]=!0),r}).filter(function(e){return-1==h.indexOf(e)}),Array.prototype.unshift.apply(e.send.alternatives,h),e.send.alternatives=e.send.alternatives.filter(function(t){return d[t.amount.currency().to_hex()]?t.amount.issuer().to_json()!=e.address:!0})}else e.send.path_status="no-path",e.send.alternatives=[];n||(l.track("Send pathfind",{Status:"success",Currency:e.send.currency_code,"Address Type":e.send.federation?"federation":"ripple","Destination Tag":!!e.send.dt,Paths:t.alternatives.length,Time:(+new Date-+m)/1e3,Address:e.userBlob.data.account_id}),n=!0)}}})}}),d.on("error",function(n){t(function(){e.$apply(function(){r.path_status="error"})}),l.track("Send pathfind",{Status:"error",Message:n.engine_result,Currency:e.send.currency_code,"Address Type":e.send.federation?"federation":"ripple","Destination Tag":!!e.send.dt,Address:e.userBlob.data.account_id})});var m=new Date},e.$watch("userBlob.data.contacts",function(t){e.recipient_query=o.queryFromContacts(t)},!0),e.$watch("account.max_spend",function(){e.update_amount()},!0),e.reset=function(){e.mode="form",e.send={recipient:"",recipient_name:"",recipient_address:"",recipient_prev:"",recipient_info:{},amount:"",amount_prev:new s,currency:e.xrp.name,currency_choices:[],currency_code:"XRP",path_status:"waiting",fund_status:"none",sender_insufficient_xrp:!1},e.nickname="",e.error_type="",e.resetAddressForm(),e.sendForm&&e.sendForm.$setPristine(!0)},e.cancelConfirm=function(){e.mode="form",e.send.alt=null,h(),e.update_paths(),r.abort_url&&document.location.replace(r.abort_url)},e.resetAddressForm=function(){e.show_save_address_form=!1,e.addressSaved=!1,e.saveAddressName="",e.addressSaving=!1,e.saveAddressForm&&e.saveAddressForm.$setPristine(!0)},e.reset_goto=function(t){e.reset(),document.location="#"+t},e.send_prepared=function(){e.send.indirect=e.send.alt?e.send.alt.paths.length:!1,e.confirm_wait=!0,n(function(){e.confirm_wait=!1},1e3,!0),e.send.pathfind&&(e.send.pathfind.close(),delete e.send.pathfind),e.networkFee=u.remote.transaction()._computeFee(),p.isUnlocked(i.account)&&(e.send.secret=p.getUnlockedSecret(i.account)),l.track("Send confirmation page",{Currency:e.send.currency_code,"Address Type":e.send.federation?"federation":"ripple","Destination Tag":!!e.send.dt,Address:e.userBlob.data.account_id}),Options.confirmation.send?(e.mode="confirm",e.sendMaxDeviation=a.getSetting(e.userBlob,"sendMaxDeviation",.1),h(),v=m(function(){var t=$('input[name="send_unlock_password"]').val();"string"==typeof t&&e.sendUnlockForm.send_unlock_password.$setViewValue(t)},2e3),y=e.$on("$destroy",function(){h()})):p.isUnlocked(i.account)?e.send_confirmed():p.requestSecret(i.account,i.username,function(t,n){return t?void console.log(t):(e.send.secret=n,void e.send_confirmed())})},e.onTransactionProposed=function(t,n){e.$apply(function(){e.setEngineStatus(t,!1),e.sent(n.hash);for(var r,o=0;o<e.currencies_all.length;o++)if(e.currencies_all[o].value.toLowerCase()===e.send.amount_feedback.currency().get_iso().toLowerCase()){e.currencies_all[o].order++,r=!0;break}})},e.onTransactionSuccess=function(t,n){e.$apply(function(){e.setEngineStatus(t,!0)})},e.onTransactionError=function(n,r){t(function(){e.$apply(function(){e.mode="error",n.engine_result?e.setEngineStatus(n,!1):"remoteError"===n.error?e.error_type=n.remote.error:"denied"===n?e.error_type="unknown":e.error_type="unknown"})})},e.send_confirmed=function(){var t=e.send,n=(e.send.currency.slice(0,3).toUpperCase(),t.amount_feedback),a=e.send.recipient_address;e.mode="sending",h(),n.set_issuer(a);var s=u.remote.transaction();if(e.send.st&&s.source_tag(e.send.st),e.send.invoice_id&&s.invoiceID(e.send.invoice_id.toUpperCase()),s.addMemo("client","text/plain","rt"+e.version),!t.secret)return void p.getSecret(i.account,i.username,t.unlock_password,function(n,r){return n?(console.log("client: send tab: error while unlocking wallet: ",n),e.mode="error",void(e.error_type="ccm: tag doesn't match"===n.message?"wrongPassword":"unlockFailed")):(t.secret=r,void e.send_confirmed())});if(s.secret(t.secret),e.send.quote)"number"==typeof e.send.quote.destination_tag&&s.destination_tag(e.send.quote.destination_tag),"string"==typeof e.send.quote.invoice_id&&(s.tx_json.InvoiceID=e.send.quote.invoice_id.toUpperCase()),s.payment(i.account,e.send.quote.address,e.send.quote.send[0]);else{var c;c=e.send.dt?e.send.dt:o.getDestTagFromAddress(e.send.recipient),s.destination_tag(c?+c:void 0),s.payment(i.account,a,n.to_json())}e.send.alt?(s.send_max(e.send.alt.send_max),s.paths(e.send.alt.paths)):n.is_native()||s.build_path(!0);var d=Options.tx_last_ledger||3;s.lastLedger(u.remote._ledger_current_index+d),s.on("success",function(t){e.onTransactionSuccess(t,s);var n={Status:"success",Currency:e.send.currency_code,"Address Type":e.send.federation?"federation":"ripple","Destination Tag":!!e.send.dt,Time:(+new Date-+e.confirmedTime)/1e3,Address:e.userBlob.data.account_id,"Transaction ID":t.tx_json.hash};l.track("Send result",n),f.addTransaction(t.tx_json,n,t.tx_json.hash,(new Date).toString()),r.return_url&&document.location.replace(r.return_url)}),s.on("proposed",function(t){e.onTransactionProposed(t,s)}),s.on("error",function(t){e.onTransactionError(t,s);var n={Status:"error",Message:t.engine_result,Currency:e.send.currency_code,"Address Type":e.send.federation?"federation":"ripple","Destination Tag":!!e.send.dt,Time:(+new Date-+e.confirmedTime)/1e3,Address:e.userBlob.account_id,"Transaction ID":t.tx_json.hash};l.track("Send result",n),f.addTransaction(t.tx_json,n,t.tx_json.hash,(new Date).toString()),r.abort_url&&document.location.replace(r.abort_url)}),f.getUserAccess().then(function(e){s.submit()},function(t){e.onTransactionError(t)}),e.confirmedTime=new Date},e.sent=function(t){function n(r){e.$apply(function(){r.transaction.hash===t&&(e.setEngineStatus(r,!0),u.remote.removeListener("transaction",n))})}e.mode="status",u.remote.on("transaction",n)},e.setEngineStatus=function(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=!!n,e.mode="status",e.tx_result="partial",t.engine_result.slice(0,3)){case"tes":e.mode="status",e.tx_result=n?"cleared":"pending";break;case"tep":e.mode="status",e.tx_result="partial";break;default:e.mode="rippleerror"}},e.saveAddress=function(){e.addressSaving=!0;var t={name:e.saveAddressName,view:e.send.recipient,address:e.send.federation?e.send.recipient:e.send.recipient_address};e.send.dt&&!e.send.federation&&(t.dt=e.send.dt),e.userBlob.unshift("/contacts",t,function(t,n){return t?void console.log("Can't save the contact. ",t):(e.contact=n,void(e.addressSaved=!0))})},e.$on("$destroy",function(){e.send.pathfind&&(e.send.pathfind.close(),delete e.send.pathfind),clearInterval(w)}),e.reset(),r.to&&r.amount){var k=r.amount,S=ripple.Amount.from_json(k),A=S.currency();e.currencies_all_keyed[A.get_iso()]?e.send.currency_choices=[A.to_human({full_name:e.currencies_all_keyed[A.get_iso()].name})]:e.send.currency_choices=[A.to_human()],e.update_destination()}}])},e.exports=u}).call(t,n(15).setImmediate)},function(e,t,n){(function(e,t){!function(e){"use strict";var r=n(6),o=n(18),a=n(12),i=n(55).Tab,s=ripple.Amount,c=n(3),u=ripple.Currency,d=n(59),l=function(){i.call(this)};r.inherits(l,i),l.prototype.tabName="trade",l.prototype.mainMenu="trade",l.prototype.angularDeps=i.prototype.angularDeps.concat(["books"]),l.prototype.extraRoutes=[{name:"/trade/:first/:second"}],l.prototype.angular=function(e){function r(e,r,i,l,p,f,m,h,g,v,y,b,w,x,k){function S(){r.pairs_query=a.getSetting(r.userBlob,"trade_currency_pairs"),a.getSetting(r.userBlob,"rippleExchangeSelectionTrade",!1)||r.userBlob.set("/clients/rippletradecom/rippleExchangeSelectionTrade",!0)}function A(){var e=jQuery("#myOrdersMsg");e[0]&&x(function(){e[0].scrollIntoView(!0)})}function T(e){var t=m("rpamount")(e,{group_sep:!1,hard_precision:!0,max_sig_digits:20});return t}function C(e,t,n){var r=t||u.from_json("XRP"),o=""+e+" "+(r.has_interest()?r.to_hex():r.get_iso()),a=s.from_human(o,{reference_date:new Date(+new Date+Y)});return r.is_native()||a.set_issuer(n),a}function P(){r.editOrder.fatFingerWarn=r.fatFingerCheck(r.editOrder.type,r.editOrder.newPrice),r.editOrder.fatFingerWarn||r.modifyOrder()}function B(e){r.editOrder.cancelling=!1,r.editOrder.seq=null,e||(r.editOrder.replacing=!0,A(),r.order_confirmed(r.editOrder.type,r.editOrder.ccyPair,r.editOrder,!0,j,R))}function D(){r.editOrder.cancelling=!1,r.offers[r.editOrder.seq]||(v.load_notification("cancel_order_gone"),r.cancelOrder.seq=null)}function j(e){r.editOrder.replacing=!1,v.load_notification("replace_success"),r.editOrder.seq=null,r.editOrder.type=null}function R(){r.editOrder.replacing=!1,v.load_notification("replace_error"),r.offers[r.editOrder.seq]||v.load_notification("replace_error_gone")}function N(e){var t=document.getElementById(e),n=(t.getClientRects()[0].top,window.scrollY),r=setInterval(function(){n-=10,window.scroll(0,n),t.getClientRects()[0].top>=0&&clearInterval(r)},5)}function O(e){if(!e)return"";var t=e.first.currency().to_json(),n=e.first.issuer().to_json(),r=e.second.currency().to_json(),o=e.second.issuer().to_json(),a="XRP"===t?"XRP":t+"."+n,i="XRP"===r?"XRP":r+"."+o,s=a+"/"+i;return s}function F(e){var t;if(e.metadata&&e.metadata.AffectedNodes){for(var n=r.editOrder.oldQuantity,o=e.metadata.AffectedNodes,a=0;a<o.length;a++)if(o[a].DeletedNode){var i=o[a].DeletedNode;if(i.LedgerEntryType&&"Offer"===i.LedgerEntryType&&i.FinalFields){var c=i.FinalFields;if(c.Sequence==r.cancelOrder.seq&&c.TakerPays&&c.TakerGets){var u;"buy"===r.editOrder.type?u=s.from_json(c.TakerPays):"sell"===r.editOrder.type&&(u=s.from_json(c.TakerGets)),u&&!u.equals(n)&&(t=n.subtract(u))}break}}a===o.length&&(t=n)}if(t&&t.is_positive()){var d=r.$new();return d.order={qtyChangeAfterCancel:t},d.cancel=function(){y.close(),d.$destroy()},k("templates/"+lang+"/popup/modifyOrderError.html",!1).then(function(e){y.blank(e,d)}),!0}return!1}function M(e,t,n){r.engine_result=e.engine_result||"tem",r.engine_result_message=e.engine_result_message||e.remote&&e.remote.error_exception,r.engine_status_accepted=t,e.engine_result&&"tes"===e.engine_result.slice(0,3)?r.tx_result=t?"cleared":"pending":(r.tx_result="unknown",console.warn("Unhandled engine status encountered!")),r.showNotification(n,r.tx_result)}function I(){var e=r.order,t=e.currency_pair;if(r.bookShow={asks:[],bids:[]},store.disabled||store.set("ripple_trade_currency_pair",t),"string"!=typeof t&&(t=""),t&&(t=t.split("/")),!t||2!=t.length||0===t[0].length||0===t[1].length)return e.first_currency=u.from_json("XRP"),e.second_currency=u.from_json("XRP"),void(e.valid_settings=!1);var n=e.first_currency=ripple.Currency.from_json(t[0].substring(0,3)),a=e.second_currency=ripple.Currency.from_json(t[1].substring(0,3));if(n.is_native())e.first_issuer="";else{var i=o.resolveContact(r.userBlob.data.contacts,t[0].substring(4));i?e.first_issuer=i:"~"==t[0].substring(4,5)?rippleVaultClient.AuthInfo.get(Options.domain,t[0].substring(4),function(t,n){t||r.$apply(function(){e.first_issuer=n.address})}):rippleVaultClient.AuthInfo.get(Options.domain,"~"+t[0].substring(4),function(t,n){t||r.$apply(function(){e.first_issuer=n.address})})}if(a.is_native())e.second_issuer="";else{var s=o.resolveContact(r.userBlob.data.contacts,t[1].substring(4));s?e.second_issuer=s:"~"==t[1].substring(4,5)?rippleVaultClient.AuthInfo.get(Options.domain,t[1].substring(4),function(t,n){t||r.$apply(function(){e.second_issuer=n.address})}):rippleVaultClient.AuthInfo.get(Options.domain,"~"+t[1].substring(4),function(t,n){t||r.$apply(function(){e.second_issuer=n.address})})}var c=ripple.UInt160.from_json(e.first_issuer),d=ripple.UInt160.from_json(e.second_issuer);if(!n.is_native()&&!c.is_valid()||!a.is_native()&&!d.is_valid()||n.is_native()&&a.is_native())return void(e.valid_settings=!1);e.valid_settings=!0;var l=""+e.first_currency.to_json()+(e.first_currency.is_native()?"":"/"+e.first_issuer)+":"+e.second_currency._iso_code+(e.second_currency.is_native()?"":"/"+e.second_issuer),p=!1;return e.prev_settings!==l?(p=!0,r.priceTicker={bid:"n/a",ask:"n/a",spread:"n/a"},L(),e.prev_settings=l):r.book.ready&&(r.editOrder.orderbookReady=!0),["buy","sell"].forEach(function(e){r.update_first(e),r.update_price(e),r.update_second(e)}),ne(),p}function E(){var e=r.order;if(e.valid_settings&&e.first_currency&&e.second_currency&&e.first_currency.is_valid()&&e.second_currency.is_valid()){for(var t=e.first_currency.to_json()+"/"+e.second_currency.to_json(),n=!1,o=0;o<r.pairs_all.length;o++)if(r.pairs_all[o].name.toLowerCase()==t.toLowerCase()){var a=r.pairs_all[o];a.name=t,a.last_used=(new Date).getTime(),r.pairs_all.splice(o,1),r.pairs_all.unshift(a),n=!0;break}n||r.pairs_all.unshift({name:t,last_used:(new Date).getTime()}),r.$$phase||r.$apply()}}function U(e,t){var n;try{if(n=r.userBlob.data.preferred_issuer[e],n&&n===t&&(n=r.userBlob.data.preferred_second_issuer[e]),n)return n}catch(o){}try{var a=r.balances[e].components;for(var i in a)if(i!=t)return i}catch(o){}return null}function q(e){var t,n=r.order;e&&(n.first_issuer=null,n.second_issuer=null),["first","second"].forEach(function(e){!n[e+"_issuer"]&&n[e+"_currency"]&&"XRP"!==n[e+"_currency"]&&(t=U(n[e+"_currency"].to_json()))&&(n[e+"_issuer"]=t)}),n.first_currency.equals(n.second_currency)&&n.first_issuer===n.second_issuer&&(t=U(n.first_currency.to_json(),n.first_issuer))&&(n.second_issuer=t)}function L(){r.book&&"function"==typeof r.book.unsubscribe&&r.book.unsubscribe();var t=r.order.first_currency,n=r.order.second_currency;r.book=e.get({currency:t.has_interest()?t.to_hex():t.get_iso(),issuer:r.order.first_issuer},{currency:n.has_interest()?n.to_hex():n.get_iso(),issuer:r.order.second_issuer},r.address),r.orderbookState="ready"}function V(){r.userBlob.data;a.hasSetting(r.userBlob,"trade_currency_pairs")?r.pairs_query=a.getSetting(r.userBlob,"trade_currency_pairs"):r.pairs_query=[{name:"XRP/USD.SnapSwap"},{name:"XRP/USD.Bitstamp"},{name:"XRP/JPY.TokyoJPY"},{name:"BTC.Bitstamp/XRP"},{name:"BTC.SnapSwap/XRP"}]}var X,H={};if(r.priceTicker={bid:"n/a",ask:"n/a",spread:"n/a"},r.sortOptions={currentPairOnly:!1,sortField:"type",sortFieldName:"Type",reverse:!1},a.blobIsValid(r.userBlob))S();else var z=r.$on("$blobUpdate",function(){a.blobIsValid(r.userBlob)&&(S(),z())});r.sortOptions.sortFieldName=r.ordersSortFieldChoicesKeyed[r.sortOptions.sortField],r.$watch("sortOptions.sortFieldName",function(){r.sortOptions.sortField=r.ordersSortFieldChoicesKeyedReverse[r.sortOptions.sortFieldName]}),r.$watch("sortOptions.sortField",function(){r.sortOptions.sortFieldName=r.ordersSortFieldChoicesKeyed[r.sortOptions.sortField]}),r.first_currency_selected="",r.second_currency_selected="",r.load_orderbook=!0,v.ripple_exchange_selection_trade=!0,r.currencies_all=n(13),r.currencies=[],r.fatFingerErr=!1,r.cancelOrder={seq:null};var K,G=m("rpamount");r.editOrder={seq:null,type:null,oldPrice:null,oldPriceDisp:"",newPrice:"",priceChanged:!1,oldQuantity:null,oldQuantityDisp:"",newQuantity:"",quantityChanged:!1,quantityFilled:!1,fatFingerWarn:!1,editing:!1,cancelling:!1,replacing:!1,orderbookReady:!1,ccyPair:null,buy_amount:null,sell_amount:null},r.notif={};for(var Q=!1,J={first:"",price:"",second:"",mode:"trade"},Z={abs_precision:6},W={rel_precision:5,rel_min_precision:5},Y=3e5,ee="Modify order result",te=0;te<r.currencies_all.length;te++)r.currencies_all[te].custom_trade_currency_dropdown&&r.currencies.push(r.currencies_all[te].value);r.gotoSettings=function(){f.path("/settingstrade")},r.priceEdited=function(){r.editOrder.priceChanged=r.editOrder.oldPriceDisp!==r.editOrder.newPrice},r.quantityEdited=function(){r.editOrder.quantityChanged=r.editOrder.oldQuantityDisp!==r.editOrder.newQuantity},r.beginEditOrder=function(){var e=this.entry;e.first.is_zero()||(r.cancelEditOrder(),O(this.entry)!==r.order.currency_pair&&(r.editOrder.orderbookReady=!1,r.goto_order_currency.bind(this)()&&(r.reset_widget("buy",!0),r.reset_widget("sell",!0))),r.editOrder.ccyPair=r.order.currency_pair,r.editOrder.editing=!0,r.editOrder.seq=e.seq,r.editOrder.type=e.type,r.editOrder.oldPrice=s.from_json(e.second).ratio_human(e.first,{reference_date:new Date}),r.editOrder.oldPriceDisp=T(r.editOrder.oldPrice),r.editOrder.newPrice=r.editOrder.oldPriceDisp,r.editOrder.oldQuantity=e.first,r.editOrder.oldQuantityDisp=T(e.first),r.editOrder.newQuantity=r.editOrder.oldQuantityDisp)},r.prepareOrderModify=function(){if(r.editOrder.newPrice&&r.editOrder.newQuantity){var e=(this.entry,r.editOrder.type),t=r.editOrder.oldQuantity,n=r.editOrder.quantityChanged?C(r.editOrder.newQuantity,t.currency(),t.issuer()):t,o=r.editOrder.oldPrice,a=r.editOrder.priceChanged?C(r.editOrder.newPrice,o.currency(),o.issuer()):o;if(r.editOrder.priceChanged||r.editOrder.quantityChanged){var i=a.product_human(n);"buy"===e?(r.editOrder.sell_amount=i.clone(),r.editOrder.buy_amount=n.clone()):(r.editOrder.sell_amount=n.clone(),r.editOrder.buy_amount=i.clone()),P()}}},r.modifyOrder=function(){(r.editOrder.priceChanged||r.editOrder.quantityChanged)&&(r.editOrder.editing=!1,r.editOrder.cancelling=!0,r.cancel_order(r.editOrder.seq,!0,B,D))},r.cancelEditOrder=function(){r.editOrder.seq=null,r.editOrder.type=null,r.editOrder.priceChanged=!1,r.editOrder.oldPrice=null,r.editOrder.oldPriceDisp="",r.editOrder.newPrice="",r.editOrder.quantityChanged=!1,r.editOrder.oldQuantity=null,r.editOrder.oldQuantityDisp="",r.editOrder.newQuantity="",r.editOrder.quantityFilled=!1,r.editOrder.fatFingerWarn=!1,r.editOrder.editing=!1,r.editOrder.ccyPair=null,r.editOrder.buy_amount=null,r.editOrder.sell_amount=null},r.fatFingerShouldWarn=function(){return r.editOrder.fatFingerWarn},r.reset=function(){r.executedOnOfferCreate="none";var e,t=store.get("ripple_trade_currency_pair")||r.pairs_all[0].name;e=r.order?r.order.listing:store.get("ripple_trade_listing")?store.get("ripple_trade_listing"):"orderbook",r.order={currency_pair:t,first_issuer:null,second_issuer:null,listing:e,buy:jQuery.extend(!0,{},J),sell:jQuery.extend(!0,{},J),valid_settings:!1},I()},r.reset_widget=function(e,t){r.order[e]=jQuery.extend(!0,{},J),t||(["buy","sell"].forEach(function(e){r.update_first(e),r.update_price(e),r.update_second(e)}),ne())},r.fill_widget=function(e,t,n){r.reset_widget(e),r.order[e].price=t.price.to_human({group_sep:!1}),n&&(r.order[e].first=t.sum.to_human({group_sep:!1}),r.calc_second(e)),N("widgetGroup")},r.place_order=function(e){"buy"===e?(r.order.buy.sell_amount=r.order.buy.second_amount,r.order.buy.buy_amount=r.order.buy.first_amount):(r.order.sell.sell_amount=r.order.sell.first_amount,r.order.sell.buy_amount=r.order.sell.second_amount),r.fatFingerErr=r.fatFingerCheck(e,r.order[e].price),h.track("Trade order confirmation page",{"Currency pair":r.order.currency_pair,Address:r.userBlob.data.account_id}),Options.confirmation.trade?r.order[e].mode="confirm":r.order_confirmed(e,r.order.currency_pair)},r.goto_order_currency=function(){if(this.entry&&O(this.entry)!==r.order.currency_pair){var e=(this.entry,r.order);Q=!0,e.first_currency=this.entry.first.currency().to_json(),e.first_issuer=this.entry.first.issuer().to_json(),e.second_currency=this.entry.second.currency().to_json(),e.second_issuer=this.entry.second.issuer().to_json();var t="XRP"===e.first_currency?"XRP":e.first_currency+"."+e.first_issuer,n="XRP"===e.second_currency?"XRP":e.second_currency+"."+e.second_issuer;e.currency_pair=t+"/"+n;var o=I();return o&&(r.load_orderbook=!0,r.reset_widget("buy",!0),r.reset_widget("sell",!0)),o}},r.view_orders_history=function(){f.url("/history?f=orders")},r.cancel_all_orders=function(){_.each(r.offers,function(e,t){r.cancel_order(e.seq,!1)})},r.cancel_order=function(e,t,n,o){if(e||(e=this.entry?this.entry.seq:this.order.Sequence),e){var a=r.offers[e],s=l.remote.transaction();a.errorMsg=null,s.offer_cancel(i.account,e),s.on("success",function(e){r.offers[a.seq]&&(r.offers[a.seq].cancelling=!1);var o;if(t){var i=F(e);n&&n(i),i?(o={Status:"error",Message:"Qty changed after cancel requested by client",Address:r.userBlob.data.account_id,"Transaction ID":e.tx_json.hash},h.track(ee,o)):o={Status:"success",Message:"Qty did not changed after cancel requested by client",Address:r.userBlob.data.account_id,"Transaction ID":e.tx_json.hash}}else r.cancelOrder.seq=a.seq,v.load_notification("cancel_success"),A(),n&&n(),o={Status:"success",Address:r.userBlob.data.account_id},h.track("Trade order cancellation",o);b.addTransaction(e.tx_json,o,e.tx_json.hash,(new Date).toString())}),s.on("error",function(e){a.cancelling=!1,a.errorMsg=e.engine_result_message,v.load_notification("cancel_error"),o&&o(),r.$$phase||r.$apply();var n={Status:"error",Message:e.engine_result,Address:r.userBlob.data.account_id};t?h.track(ee,n):h.track("Trade order cancellation",n),b.addTransaction(e.tx_json,n,e.tx_json.hash,(new Date).toString())}),g.requestSecret(i.account,i.username,function(e,t){return e?void(a.cancelling=!1):(s.secret(t),void b.getUserAccess().then(function(e){s.submit()},function(e){a.cancelling=!1,a.errorMsg="Sorry, users from your region are not allowed to do transactions through Ripple Trade.",v.load_notification("cancel_error"),r.$$phase||r.$apply()}))}),a.cancelling=!0}},r.dismissCancelError=function(){r.cancelOrder.seq=null,r.editOrder.cancelOrderGone=!1},r.showNotification=function(e,t){return"string"!=typeof t?void console.log("You must pass in a string for the status"):(r.notif[e]=t,H[e]&&(x.cancel(H[e]),H[e]=null),H[e]=x(function(){r.notif[e]="clear"},9e3),void H[e]["finally"](function(){H[e]=null}))},r.order_confirmed=function(e,t,n,o,a,s){var u=n?n:r.order[e],d=l.remote.transaction();d.offer_create(i.account,u.buy_amount,u.sell_amount),d.addMemo("client","text/plain","rt"+v.version),"sell"===e&&d.set_flags("Sell"),d.on("proposed",function(t){M(t,!1,e)}),d.on("success",function(n){M(n,!0,e),o||r.reset_widget(e);for(var s=c.processTxn(n,n.metadata,i.account),d=0;d<s.effects.length;d++){var l=s.effects[d].type;switch(l){case"trust_change_balance":r.executedOnOfferCreate="all";break;case"offer_partially_funded":r.executedOnOfferCreate="partial";break;default:r.executedOnOfferCreate="none"}}if(a){var p=n.tx_json&&n.tx_json.Sequence?n.tx_json.Sequence:null;a(p)}r.$$phase||r.$apply();var f={Status:"success","Currency pair":t,Address:r.userBlob.data.account_id,"Transaction ID":n.tx_json.hash,BuyAmount:u.buy_amount.to_number(!1),SellAmount:u.sell_amount.to_number(!1)};o?h.track(ee,f):h.track("Trade order result",f),b.addTransaction(n.tx_json,f,n.tx_json.hash,(new Date).toString())}),d.on("error",function(n){M(n,!1,e),o||r.reset_widget(e),s&&s(),r.$$phase||r.$apply();var a={Status:"error",Message:n.engine_result,"Currency pair":t,Address:r.userBlob.data.account_id};o?h.track(ee,a):h.track("Trade order result",a),b.addTransaction(n.tx_json,a,n.tx_json.hash,(new Date).toString())}),g.requestSecret(i.account,i.username,function(t,n){return t?void(o||(u.mode="trade")):(d.secret(n),void b.getUserAccess().then(function(e){d.submit()},function(t){o||r.reset_widget(e),r.$$phase||r.$apply()}))}),o||(u.mode="sending")},r.loadMore=function(){r.load_orderbook=!0,r.orderbookLength=e.getLength();var t=30;Options.orderbook_max_rows+=t,x(function(){L()},1e3),r.orderbookState=r.orderbookLength-Options.orderbook_max_rows+t<1?"full":"ready"},r.update_first=function(e){var t=r.order[e],n=r.order.first_currency||u.from_json("XRP"),o=""+t.first+" "+(n.has_interest()?n.to_hex():n.get_iso());t.first_amount=ripple.Amount.from_human(o,{reference_date:new Date(+new Date+Y)}),n.is_native()||t.first_amount.set_issuer(r.order.first_issuer)},r.update_price=function(e){var t=r.order[e],n=r.order.second_currency||u.from_json("XRP"),o=""+t.price+" "+(n.has_interest()?n.to_hex():n.get_iso());t.price_amount=ripple.Amount.from_human(o,{reference_date:new Date(+new Date+Y)}),n.is_native()||t.price_amount.set_issuer(r.order.second_issuer)},r.update_second=function(e){var t=r.order[e],n=r.order.second_currency||u.from_json("XRP"),o=""+t.second+" "+(n.has_interest()?n.to_hex():n.get_iso());t.second_amount=ripple.Amount.from_human(o,{reference_date:new Date(+new Date+Y)}),n.is_native()||t.second_amount.set_issuer(r.order.second_issuer)},r.fatFingerCheck=function(e,t){if(("buy"!==e||r.bookShow.bids[0])&&("sell"!==e||r.bookShow.asks[0])){var n,o=1.1;return"buy"===e?n=r.bookShow.bids[0].showPrice:"sell"===e&&(n=r.bookShow.asks[0].showPrice),n=+n.replace(/,/g,""),n&&(t>n*o||n/o>t)}},r.calc_second=function(e){var t=r.order[e];r.update_first(e),r.update_price(e),t.price_amount&&t.price_amount.is_valid()&&t.first_amount&&t.first_amount.is_valid()&&(t.second_amount=t.price_amount.product_human(t.first_amount),t.second=t.second_amount.to_human({group_sep:!1}))},r.calc_first=function(e){var t=r.order[e];if(r.update_second(e),r.update_price(e),t.price_amount&&t.price_amount.is_valid()&&t.second_amount&&t.second_amount.is_valid()){if(t.price_amount.is_native())t.first_amount=s.from_json(t.second_amount.to_text_full().replace(/,/g,"")).ratio_human(s.from_json(t.price_amount.to_text()),{reference_date:new Date});else{var n=t.price_amount.to_human({group_sep:!1}),o=t.price_amount.currency().to_json(),a=t.price_amount.issuer().to_json();t.first_amount=s.from_json(t.second_amount.to_text_full().replace(/,/g,"")).ratio_human(s.from_json(n+"/"+o+"/"+a),{reference_date:new Date})}t.first=t.first_amount.to_human({group_sep:!1})}},r.flip_issuer=function(){var e=r.order,t=e.first_currency,n=e.first_issuer,o=e.currency_pair.split("/");Q=!0,e.first_currency=e.second_currency,e.first_issuer=e.second_issuer,e.second_currency=t,e.second_issuer=n,e.currency_pair=o[1]+"/"+o[0],I(),E()},r.$watch("first_currency_selected",function(){r.first_issuer_selected="","XRP"==r.first_currency_selected?(r.gateway_change_form.first_iss.$setValidity("rpDest",!0),r.disable_first_issuer=!0):(r.disable_first_issuer=!1,r.first_iss={},d.forEach(function(e){var t=e.accounts;t.forEach(function(t){t.currencies.forEach(function(t){t==r.first_currency_selected&&(r.first_iss[e.name]=e)})})}))}),r.$watch("second_currency_selected",function(){r.second_issuer_selected="","XRP"==r.second_currency_selected?(r.gateway_change_form.second_iss.$setValidity("rpDest",!0),r.disable_second_issuer=!0):(r.disable_second_issuer=!1,r.second_iss={},d.forEach(function(e){var t=e.accounts;t.forEach(function(t){t.currencies.forEach(function(t){t==r.second_currency_selected&&(r.second_iss[e.name]=e)})})}))}),r.open_custom_currency_selector=function(){r.first_currency_selected="",r.first_issuer_selected="",r.second_currency_selected="",r.second_issuer_selected="",r.adding_pair=!0},r.add_pair=function(){var e="XRP"===r.first_currency_selected?"":"."+r.first_issuer_selected,t="XRP"===r.second_currency_selected?"":"."+r.second_issuer_selected;("XRP"===r.second_currency_selected||null!=r.second_issuer_selected&&""!==r.second_issuer_selected)&&("XRP"===r.first_currency_selected||null!=r.first_issuer_selected&&""!==r.first_issuer_selected)&&(r.order.currency_pair=r.first_currency_selected+e+"/"+r.second_currency_selected+t,r.userBlob.unshift("/clients/rippletradecom/trade_currency_pairs",{name:r.order.currency_pair}),r.adding_pair=!1)},["first","second"].forEach(function(e){r["edit_"+e+"_issuer"]=function(){r.show_issuer_form=e,r.order[e+"_issuer_edit"]=o.unresolveContact(r.userBlob.data.contacts,r.order[e+"_issuer"]),t(function(){$("#"+e+"_issuer").select()})},r["save_"+e+"_issuer"]=function(){r.order[e+"_issuer"]=o.resolveContact(r.userBlob.data.contacts,r.order[e+"_issuer_edit"]),r.show_issuer_form=!1,I(),E(),r.order.valid_settings&&!r.order[e+"_currency"].is_native()&&("first"===e?r.userBlob.set("/preferred_issuer/"+r.userBlob.escapeToken(r.order.first_currency.to_json()),r.order.first_issuer):r.order.first_currency.equals(r.order.second_currency)?r.userBlob.set("/preferred_second_issuer/"+r.userBlob.escapeToken(r.order.second_currency.to_json()),r.order.second_issuer):r.userBlob.set("/preferred_issuer/"+r.userBlob.escapeToken(r.order.second_currency.to_json()),r.order.second_issuer))}}),r.toggleOffers=function(){r.hideOffers=!r.hideOffers,r.userBlob.set("/clients/rippletradecom/tradeoffers",{hideOffers:r.hideOffers,hideOrderBook:r.hideOrderBook})},r.toggleOrderBook=function(){r.hideOrderBook=!r.hideOrderBook,r.userBlob.set("/clients/rippletradecom/tradeoffers",{hideOffers:r.hideOffers,hideOrderBook:r.hideOrderBook})},r.$watchCollection("[userBlob.data.clients.rippletradecom.tradeoffers.hideOffers, userBlob.data.clients.rippletradecom.tradeoffers.hideOrderBook]",function(e){void 0!==typeof e[0]&&(r.hideOffers=e[0]),void 0!==typeof e[1]&&(r.hideOrderBook=e[1])});var ne=function(){var e=r.order.first_currency,t=r.order.first_issuer,n=r.order.second_currency,o=r.order.second_issuer,a=n.is_native()||o==r.address||r.lines[o+(r.order.second_currency.has_interest()?r.order.second_currency.to_hex():r.order.second_currency.to_json())]&&r.lines[o+(r.order.second_currency.has_interest()?r.order.second_currency.to_hex():r.order.second_currency.to_json())].balance.is_positive();a=n.is_native()&&r.account.max_spend?a&&r.account.max_spend.is_positive():a;var i=e.is_native()||t==r.address||r.lines[t+(r.order.first_currency.has_interest()?r.order.first_currency.to_hex():r.order.first_currency.to_json())]&&r.lines[t+(r.order.first_currency.has_interest()?r.order.first_currency.to_hex():r.order.first_currency.to_json())].balance.is_positive();i=e.is_native()&&r.account.max_spend?i&&r.account.max_spend.is_positive():i,r.order.buy.showWidget=a,r.order.sell.showWidget=i},re=function(e){if(r.book&&r.book[e+"LastUpdate"]&&(r.load_orderbook=!1),r.book&&r.book[e]&&r.book[e].length){var t=r.bookShow[e];r.bookShow[e]=jQuery.extend(!0,[],r.book[e]),
K=new Date,clearInterval(X),X=setInterval(function(){r.$apply(function(){var e=Math.round((new Date-K)/1e3);r.lastUpdate=e||0})},1e3);var n=r.bookShow[e].length,o=_.indexBy(t,"BookDirectory"),a=t.length>0;for(te=0;n>te;te++){var i=r.bookShow[e][te];i.showSum=G(i.sum,Z),i.showPrice=G(i.price,Z);var s="bids"===e?"TakerPays":"TakerGets";i["show"+s]=G(i[s],Z),i.isNew=a&&!o[i.BookDirectory],a&&!i.isNew&&(i.isChanged=i["show"+s]!==o[i.BookDirectory]["show"+s]||i.showPrice!==o[i.BookDirectory].showPrice)}r.priceTicker[e.substring(0,3)]=G(r.bookShow[e][0].price,W),r.book.ready&&(r.editOrder.orderbookReady=!0,r.book.asks[0]&&r.book.bids[0]&&(r.priceTicker.spread=G(r.book.asks[0].price.subtract(r.book.bids[0].price),W)))}};r.$watch("book.asksLastUpdate",function(){re("asks")}),r.$watch("book.bidsLastUpdate",function(){re("bids")}),r.$watch("lastUpdate",function(){r.lastUpdate>30&&r.book.requestOffers()},!0),["buy","sell"].forEach(function(e){r.$watch("order."+e+".first",function(){r.update_first(e)},!0),r.$watch("order."+e+".price",function(){r.update_price(e)},!0),r.$watch("order."+e+".second",function(){r.update_second(e)},!0)}),r.$watch("order.currency_pair",function(e){return r.editOrder.ccyPair!==r.order.currency_pair&&r.editOrder.editing&&r.cancelEditOrder(),Q?void(Q=!1):(r.load_orderbook=!0,r.reset_widget("buy",!0),r.reset_widget("sell",!0),I(),void q(!1))},!0),r.userBlob.data&&V(),r.$on("$blobUpdate",function(){V(),q(!1)}),r.$watch("order.type",function(){ne()}),r.$watch("order.first_issuer",function(){I()},!0),r.$watch("order.second_issuer",function(){I()},!0);var oe=function(){ne(),q(!1)};r.$on("$balancesUpdate",oe);var ae=r.$watch("userBlob.data.contacts",function(e){e.length&&(r.issuer_query=o.queryFromContacts(e),ae())},!0),ie=function(){if(r.offersCount=_.size(r.offers),r.offersCount){var e=r.editOrder.seq;if(e&&r.offers[e]){var t=r.offers[e].first;r.editOrder.cancelling||(t.is_zero()?(r.cancelEditOrder(),r.offers[e].isZero=!0):t.equals(r.editOrder.oldQuantity)||(r.editOrder.newQuantity=T(t),r.editOrder.quantityChanged=!1,r.editOrder.quantityFilled=!0,v.load_notification("quantity_filled_warn")))}}};if(ie(),r.$on("$offersUpdate",ie),r.reset(),p.first&&p.second){var se={},ce={},ue={};if(["first","second"].forEach(function(e){se[e]=p[e].match(/\.(.+)$/),ce[e]=p[e].match(/^(\w{3})/),ue[e]=!(!ce[e]||"XRP"!==ce[e][1]&&!se[e])}),ue.first&&ue.second&&ce.first[1]!==ce.second[1]){Q=!0;var de="XRP"===ce.first[1]?"":"."+se.first[1],le="XRP"===ce.second[1]?"":"."+se.second[1];r.order.currency_pair=ce.first[1]+de+"/"+ce.second[1]+le}else f.url("/trade");I(),E()}oe(),r.$on("$destroy",function(){r.book&&"function"==typeof r.book.unsubscribe&&r.book.unsubscribe(),clearInterval(X)})}e.controller("TradeCtrl",r),r.$inject=["rpBooks","$scope","rpId","rpNetwork","$routeParams","$location","$filter","rpTracker","rpKeychain","$rootScope","rpPopup","rpAPI","$anchorScroll","$timeout","$templateRequest"]},e.exports=l}(e)}).call(t,n(67)(e),n(15).setImmediate)},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){var r=n(6),o=(n(18),n(55).Tab),a=n(12),i=ripple.Currency,s=function(){o.call(this)};r.inherits(s,o),s.prototype.tabName="advanced",s.prototype.mainMenu="advanced",s.prototype.angular=function(e){e.controller("AdvancedCtrl",["$scope","rpId","rpKeychain","rpNetwork",function(e,t,n,r){function o(){e.passwordProtection=!a.getSetting(e.userBlob,"persistUnlock",!1),e.sendMaxDeviation=a.getSetting(e.userBlob,"sendMaxDeviation",.1),e.exchangeMaxDeviation=a.getSetting(e.userBlob,"exchangeMaxDeviation",.1)}var s=i.from_json("XRP");if(e.xrp={name:s.to_human({full_name:e.currencies_all_keyed.XRP.name}),code:s.get_iso(),currency:s},e.options=Options,e.optionsBackup=$.extend(!0,{},Options),e.editConfirmation={send:!1,exchange:!1,trade:!1},e.edit={blobvault:!1,maxNetworkFee:!1,historyApi:!1,sendMax:!1,exchangeMax:!1},a.blobIsValid(e.userBlob))o();else var c=e.$on("$blobUpdate",function(){a.blobIsValid(e.userBlob)&&(o(),c())});e.max_tx_network_fee_human=ripple.Amount.from_json(e.options.max_tx_network_fee).to_human(),e.confirmationChanged={send:!1,exchange:!1,trade:!1},e.success={},e.save=function(t){switch(t){case"sendMax":e.userBlob.set("/clients/rippletradecom/sendMaxDeviation",e.sendMaxDeviation);case"exchangeMax":e.userBlob.set("/clients/rippletradecom/exchangeMaxDeviation",e.exchangeMaxDeviation);case"maxNetworkFee":e.options.max_tx_network_fee=ripple.Amount.from_human(e.max_tx_network_fee_human).to_json(),e.userBlob.set("/clients/rippletradecom/maxNetworkFee",e.options.max_tx_network_fee),r.remote.max_fee=e.options.max_tx_network_fee;break;case"historyApi":e.userBlob.set("/clients/rippletradecom/historyApi",e.options.historyApi.replace(/[\/]*$/,""));break;default:store.disabled||store.set("ripple_settings",JSON.stringify(e.options))}e.edit[t]=!1,"blobvault"===t&&location.reload(),e.success[t]=!0},e.saveConfirmation=function(t){return e.confirmationChanged[t]?(e.confirmationChanged[t]=!1,e.userBlob.set("/clients/rippletradecom/confirmation",e.options.confirmation),e.editConfirmation[t]=!1,void(e.success.saveConfirmation[t]=!0)):void(e.editConfirmation[t]=!1)},e.deleteUrl=function(t){"blobvault"===t&&(e.options.blobvault=""),store.disabled||store.set("ripple_settings",JSON.stringify(e.options))},e.cancelEdit=function(t){e.edit[t]=!1,"maxNetworkFee"===t&&(e.options.max_tx_network_fee=e.optionsBackup.max_tx_network_fee,e.max_tx_network_fee_human=ripple.Amount.from_json(e.options.max_tx_network_fee).to_human()),"sendMax"===t&&(e.sendMaxDeviation=a.getSetting(e.userBlob,"sendMaxDeviation",.1)),"exchangeMax"===t?e.exchangeMaxDeviation=a.getSetting(e.userBlob,"exchangeMaxDeviation",.1):e.options[t]=e.optionsBackup[t]},e.cancelEditConfirmation=function(t){e.editConfirmation[t]=!1,e.options.confirmation[t]=e.optionsBackup.confirmation[t]},e.$on("$blobUpdate",function(){e.passwordProtection=!a.getSetting(e.userBlob,"persistUnlock",!1),e.optionsBackup=$.extend(!0,{},Options),e.max_tx_network_fee_human=ripple.Amount.from_json(e.options.max_tx_network_fee).to_human()}),e.addServer=function(){e.options.server.servers.isEmptyServer||e.options.server.servers.push({isEmptyServer:!0,secure:!0}),e.editing=!0,e.success.addServer=!0}}]),e.controller("ServerRowCtrl",["$scope",function(e){e.editing=e.server.isEmptyServer,e.remove=function(){e.options.server.servers.splice(e.index,1),e.persist(),e.success.removeServer=!0},e.hasRemove=function(){return!e.server.isEmptyServer&&1!==e.options.server.servers.length},e.cancel=function(){return e.server.isEmptyServer?void e.remove():(e.editing=!1,void(e.server=$.extend({},e.optionsBackup.server.servers[e.index])))},e.noCancel=function(){return e.server.isEmptyServer&&1===e.options.server.servers.length},e.save=function(){e.server.isEmptyServer=!1,e.editing=!1,e.server.port||(e.server.port=e.server.secure?"443":"80"),e.persist(function(){location.reload()}),e.success.saveServer=!0},e.persist=function(t){store.disabled||store.set("ripple_settings",JSON.stringify(e.options));var n=a.getClearServers(e.options.server.servers);e.userBlob.set("/clients/rippletradecom/server/servers",n,t)}}])},e.exports=s},function(e,t,n){"use strict";var r=n(6),o=n(55).Tab,a=n(12),i=function(){o.call(this)};r.inherits(i,o),i.prototype.tabName="security",i.prototype.mainMenu="security",i.prototype.angular=function(e){e.controller("SecurityCtrl",["$scope","rpId","rpTracker","rpKeychain",function(e,t,n,r){function o(){e.requirePassword=!a.getSetting(e.userBlob,"persistUnlock")}e.settingsPage="security",e.isUnlocked=!0,e.requirePasswordChanged=!1,e.success={},e.security={},e.$on("$blobUpdate",o),o(),e.restoreSession=function(){return e.sessionPassword?(e.isConfirming=!0,e.unlockError=null,void r.getSecret(t.account,t.username,e.sessionPassword,function(n,o){return e.isConfirming=!1,e.sessionPassword="",n?void(e.unlockError=n):void(e.isUnlocked=r.isUnlocked(t.account))})):void(e.unlockError=!0)},e.setPasswordProtection=function(){e.editUnlock=!1,e.requirePasswordChanged&&(e.requirePasswordChanged=!1,e.requirePassword=!e.requirePassword,e.errorSetPasswordProtection=!1,r.setPasswordProtection(e.requirePassword,function(t,n){t&&(console.log(t),e.requirePassword=!e.requirePassword,e.errorSetPasswordProtection=!0)}),e.errorSetPasswordProtection||(e.requirePassword?(e.success.enableRequirePassword=!0,e.success.disableRequirePassword=!1):(e.success.enableRequirePassword=!1,e.success.disableRequirePassword=!0)))};var i=function(){e.loading=!1,e.error=!1};i()}])},e.exports=i},function(e,t,n){var r=n(6),o=n(55).Tab,a=n(3),i=function(){o.call(this)};r.inherits(i,o),i.prototype.tabName="tx",i.prototype.angular=function(e){e.controller("TxCtrl",["$scope","$routeParams",function(e,t){e.state="loading",e.transaction={hash:t.id};var n=e.$watch("userHistory",function(){e.userHistory&&(e.userHistory.getTransaction(t.id).success(function(t){$.extend(e.transaction,t.transaction.tx),e.transaction.ledger=t.transaction.ledger_index,e.transaction.amountSent=a.getAmountSent(t.transaction.tx,t.transaction.meta),e.state="loaded"}).error(function(){}),n())})}])},e.exports=i},function(e,t,n){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="xrp",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("XrpCtrl",["$scope","rpId",function(e,t){e.accountLines={},e.showComponent=[],e.fundPage="xrp"}])},e.exports=a},function(e,t,n){var r=n(6),o=n(18),a=n(55).Tab,i=function(){a.call(this)};r.inherits(i,a),i.prototype.tabName="debug",i.prototype.mainMenu="debug",i.prototype.angular=function(e){e.controller("DebugPretendCtrl",["$rootScope","$scope","rpId","$q",function(e,t,n,r){t.pretend={pretendAs:"",address:""},e.original_contacts&&(t.pretend_query=o.queryFromContacts(e.original_contacts)),t.$watch("userBlob.data.contacts",function(n){n&&n.length>0&&(t.pretend_query=o.queryFromContacts(n),e.original_contacts=n)},!0),t.$watch("pretend.pretendAs",function(e){t.resolveInput()}),t.resolveInput=function(){e.original_contacts||(e.original_contacts=[]);var n=o.getContact(e.original_contacts,t.pretend.pretendAs);console.log("got contact "+n);var a;if(n)t.pretend.address=n.address,a=r.when(n.address);else if(o.isRippleName(t.pretend.pretendAs)){var i=r.defer();a=i.promise,rippleVaultClient.AuthInfo.get(Options.domain,t.pretend.pretendAs,function(e,n){t.pretend.address=n.address,i.resolve(n.address)})}else a=r.when(t.pretend.pretendAs),t.pretend.address=t.pretend.pretendAs,t.address=t.pretend.pretendAs;return a},t.pretend=function(){console.log("debug as "+t.pretend.pretendAs);var r=t.resolveInput();r.then(function(t){n.setAccount(t);var r={data:{contacts:[],preferred_issuer:{},preferred_second_issuer:{}},meta:[],set:function(){},unset:function(){},unshift:function(){},filter:function(){}};e.userHistory=null,e.userBlob=r,n.setUsername(t);var o=n.resolveName(t);o.then(function(e){n.setUsername(e)},function(e){console.log(e)}),e.address=t,e.debug=!0})}}])},e.exports=i},function(e,t,n){(function(t){"use strict";var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="btc",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("BtcCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpNetwork","rpKeychain","rpAPI",function(e,n,r,o,a,i,s,c){e.accountLines={},e.showComponent=[],e.showInstructions=!1,e.btcConnected=!1,e.emailError=!1,e.generalError=!1,e.countryDisallowed="US"===store.get("profile_country"),e.profileUnverified="verified"!==store.get("profile_status"),e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.toggle_btc_instructions=function(){e.showBtcInstructions=!e.showBtcInstructions},e.openPopup=function(){e.emailError=!1,e.generalError=!1,o.track("B2R Show Connect")};var u=e.$watch("B2R",function(){e.B2R&&e.B2R.active&&(e.btcConnected=!0,u())},!0);e.B2RSignup=function(){var t=Options.b2rAddress,r="BTC",a="100000000000",c={};c.rippleAddress=n.account,c.email=e.userBlob.data.email,s.requestSecret(n.account,n.username,function(s,u){if(s)return console.log("client: trust profile: error while unlocking wallet: ",s),e.mode="error",void(e.error_type="unlockFailed");var d=i.remote.transaction();d.rippleLineSet(n.account,a+"/"+r+"/"+t),d.secret(u),d.setFlags("NoRipple"),d.tx_json.Sequence=1,d.complete(),d.sign(),c.txBlob=d.serialize().to_hex(),e.B2RApp.findProfile("account").signup(c,function(t,n){return t?(console.log("Error",t),t&&"E-mail address is not accepted"===t.message?(e.load_notification("emailError"),e.emailError=!0):(e.load_notification("error"),e.generalError=!0),e.btcConnected=!1,void o.track("B2R SignUp",{result:"failed",message:t.message})):(e.B2RApp.refresh(),e.B2RSignupResponse=n,o.track("B2R SignUp",{result:"success"}),e.load_notification("success"),e.btcConnected=!0,void(e.showInstructions=!0))})}),e.B2R.progress=!0,o.track("B2R Shared Email")},e.save_btc_account=function(){function r(t,n){switch(e.btc_engine_result=t.engine_result,e.btc_engine_result_message=t.engine_result_message,e.btc_engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.btc_tx_result=n?"cleared":"pending";break;case"tem":e.btc_tx_result="malformed";break;case"ter":e.btc_tx_result="failed";break;case"tec":e.btc_tx_result="failed";break;case"tel":e.btc_tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"===e.btc_tx_result&&(e.btc2Connected=!0,e.showBtcInstructions=!0),console.log(e.btc_tx_result)}e.btcLoading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" BTC",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rvYAfWj5gh67oV6fW32ZzP3Aw4Eubs59B"),!o.is_valid())return void console.log("Invalid amount");var a=i.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.btcLoading=!1,e.btcediting=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.btcMode="error",e.btcLoading=!1,e.btcediting=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),s.requestSecret(n.account,n.username,function(n,r){return n?(e.btcLoading=!1,void console.log(n)):(e.btcMode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.btcMode="error",e.btcLoading=!1,e.btcediting=!1})})}))})},e.$watch("lines",function(){e.lines.rvYAfWj5gh67oV6fW32ZzP3Aw4Eubs59BBTC?e.btc2Connected=!0:e.btc2Connected=!1},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="withdraw",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("WithdrawCtrl",["$rootScope","rpId","rpAppManager",function(e,t,n){}])},e.exports=a},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="usd",a.prototype.mainMenu="fund",a.prototype.extraRoutes=[{name:"/usd/:result"}],a.prototype.angular=function(e){e.controller("UsdCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){e.toggle_usd_instructions=function(){e.showUsdInstructions=!e.showUsdInstructions},e.toggle_gatehub_instructions=function(){e.showUsd3Instructions=!e.showUsd3Instructions},e.save_usd_account=function(){function r(t,n){switch(e.usd_engine_result=t.engine_result,e.usd_engine_result_message=t.engine_result_message,e.usd_engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.usd_tx_result=n?"cleared":"pending";break;case"tem":e.usd_tx_result="malformed";break;case"ter":e.usd_tx_result="failed";break;case"tec":e.usd_tx_result="failed";break;case"tel":e.usd_tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"===e.usd_tx_result&&(e.usd2Connected=!0,e.showUsdInstructions=!0),console.log(e.usd_tx_result)}e.usdLoading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" USD",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rvYAfWj5gh67oV6fW32ZzP3Aw4Eubs59B"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.usdLoading=!1,e.usdediting=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.usdMode="error",e.usdLoading=!1,e.usdediting=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.usdLoading=!1,void console.log(n)):(e.usdMode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.usdMode="error",e.usdLoading=!1,e.usdediting=!1})})}))})},e.save_gatehub_account=function(){function r(t,n){switch(e.usd3_engine_result=t.engine_result,e.usd3_engine_result_message=t.engine_result_message,e.usd3_engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.usd3_tx_result=n?"cleared":"pending";break;case"tem":e.usd3_tx_result="malformed";break;case"ter":e.usd3_tx_result="failed";break;case"tec":e.usd3_tx_result="failed";break;case"tel":e.usd3_tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"===e.usd3_tx_result&&(e.usd3Connected=!0,e.showUsd3Instructions=!0),console.log(e.usd3_tx_result)}e.usd3Loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" USD",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rhub8VRN55s94qWKDv6jmDy1pUykJzF3wq"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.usd3Loading=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.usd3Loading=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.usd3Loading=!1,void console.log(n)):(a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.usd3Loading=!1})})}))})},e.$watch("lines",function(){e.usd2Connected=!!e.lines.rvYAfWj5gh67oV6fW32ZzP3Aw4Eubs59BUSD,e.usd3Connected=!!e.lines.rhub8VRN55s94qWKDv6jmDy1pUykJzF3wqUSD},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="eur",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("EurCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.toggle_gatehub_instructions=function(){e.show3Instructions=!e.show3Instructions},e.save_account=function(){function r(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"===e.tx_result&&(e.eurConnected=!0,e.showInstructions=!0),console.log(e.tx_result)}e.loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" EUR",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rMwjYedjc7qqtKYVLiAccJSmCwih4LnE2q"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.loading=!1,e.editing=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.loading=!1,void console.log(n)):(e.mode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})})}))})},e.save_gatehub_account=function(){function r(t,n){switch(e.engine3_result=t.engine_result,e.engine3_result_message=t.engine_result_message,e.engine3_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx3_result=n?"cleared":"pending";break;case"tem":e.tx3_result="malformed";break;case"ter":e.tx3_result="failed";break;case"tec":e.tx3_result="failed";break;case"tel":e.tx3_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"===e.tx3_result&&(e.eur3Connected=!0,e.show3Instructions=!0),console.log(e.tx_result)}e.eur3loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" EUR",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rhub8VRN55s94qWKDv6jmDy1pUykJzF3wq"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.eur3loading=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.eur3loading=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.eur3loading=!1,void console.log(n)):(a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.eur3loading=!1})})}))})},e.$watch("lines",function(){e.eurConnected=!!e.lines.rMwjYedjc7qqtKYVLiAccJSmCwih4LnE2qEUR,e.eur3Connected=!!e.lines.rhub8VRN55s94qWKDv6jmDy1pUykJzF3wqEUR},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="sgd",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("SgdCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.save_account=function(){function r(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"==e.tx_result&&(e.sgdConnected=!0,e.showInstructions=!0),console.log(e.tx_result)}e.loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" SGD",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("r9Dr5xwkeLegBeXq6ujinjSBLQzQ1zQGjH"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.loading=!1,e.editing=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.loading=!1,void console.log(n)):(e.mode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})})}))})},e.$watch("lines",function(){e.lines.r9Dr5xwkeLegBeXq6ujinjSBLQzQ1zQGjHSGD?e.sgdConnected=!0:e.sgdConnected=!1},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="cad",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("CadCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.save_account=function(){function r(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"==e.tx_result&&(e.cadConnected=!0,e.showInstructions=!0),console.log(e.tx_result)}e.loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" CAD",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("raBDVR7JFq3Yho2jf7mcx36sjTwpRJJrGU"),!o.is_valid())return void console.warn("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.loading=!1,e.editing=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.loading=!1,void console.warn(n)):(e.mode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})})}))})},e.$watch("lines",function(){e.lines.raBDVR7JFq3Yho2jf7mcx36sjTwpRJJrGUCAD?e.cadConnected=!0:e.cadConnected=!1},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="gold",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("GoldCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.save_account=function(){function r(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"==e.tx_result&&(e.gbiConnected=!0,e.showInstructions=!0),console.log(e.tx_result)}e.loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" XAU",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rrh7rf1gV2pXAoqA8oYbpHd8TKv5ZQeo67"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.loading=!1,e.editing=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.loading=!1,void console.log(n)):(e.mode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})})}))})},e.$watch("lines",function(){e.lines.rrh7rf1gV2pXAoqA8oYbpHd8TKv5ZQeo67XAU?e.gbiConnected=!0:e.gbiConnected=!1},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="tou",a.prototype.pageMode="single",a.prototype.parent="main",a.prototype.angular=function(e){e.controller("TouCtrl",["$scope","$element",function(e,t){angular.element("nav").hide()}])},e.exports=a},function(e,t,n){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="privacypolicy",a.prototype.pageMode="single",a.prototype.parent="main",a.prototype.angular=function(e){e.controller("PrivacypolicyCtrl",["$scope","$element",function(e,t){angular.element("nav").hide()}])},e.exports=a},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="jpy",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("JpyCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){
e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.save_account=function(){function r(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"==e.tx_result&&(e.jpyConnected=!0,e.showInstructions=!0),console.log(e.tx_result)}e.loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" JPY",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("r94s8px6kSw1uZ1MV98dhSRTvc6VMPoPcN"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.loading=!1,e.editing=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.loading=!1,void console.log(n)):(e.mode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})})}))})},e.$watch("lines",function(){e.lines.r94s8px6kSw1uZ1MV98dhSRTvc6VMPoPcNJPY?e.jpyConnected=!0:e.jpyConnected=!1},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="mxn",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("MxnCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.save_account=function(){function r(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"==e.tx_result&&(e.mxnConnected=!0,e.showInstructions=!0),console.log(e.tx_result)}e.loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" MXN",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rG6FZ31hDHN1K5Dkbma3PSB5uVCuVVRzfn"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.loading=!1,e.editing=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.loading=!1,void console.log(n)):(e.mode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})})}))})},e.$watch("lines",function(){e.lines.rG6FZ31hDHN1K5Dkbma3PSB5uVCuVVRzfnMXN?e.mxnConnected=!0:e.mxnConnected=!1},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="404",a.prototype.mainMenu="none",a.prototype.angular=function(e){e.controller("NotFoundCtrl",["$scope",function(e){}])},e.exports=a},function(e,t,n){(function(t){var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="brl",a.prototype.mainMenu="fund",a.prototype.angular=function(e){e.controller("BrlCtrl",["$scope","rpId","rpAppManager","rpTracker","$routeParams","rpKeychain","rpNetwork","rpAPI","$timeout",function(e,n,r,o,a,i,s,c,u){e.toggle_instructions=function(){e.showInstructions=!e.showInstructions},e.save_account=function(){function r(t,n){switch(e.engine_result=t.engine_result,e.engine_result_message=t.engine_result_message,e.engine_status_accepted=n,t.engine_result.slice(0,3)){case"tes":e.tx_result=n?"cleared":"pending";break;case"tem":e.tx_result="malformed";break;case"ter":e.tx_result="failed";break;case"tec":e.tx_result="failed";break;case"tel":e.tx_result="local";break;case"tep":console.warn("Unhandled engine status encountered!")}"cleared"==e.tx_result&&(e.brlConnected=!0,e.showInstructions=!0),console.log(e.tx_result)}e.loading=!0;var o=ripple.Amount.from_human(Options.gateway_max_limit+" BRL",{reference_date:new Date(+new Date+3e5)});if(o.set_issuer("rfNZPxoZ5Uaamdp339U9dCLWz2T73nZJZH"),!o.is_valid())return void console.log("Invalid amount");var a=s.remote.transaction();a.addMemo("client","text/plain","rt"+e.version),a.rippleLineSet(n.account,o).setFlags("NoRipple").on("proposed",function(t){e.$apply(function(){r(t,!1)})}).on("success",function(t){e.$apply(function(){r(t,!0),e.loading=!1,e.editing=!1}),c.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}).on("error",function(n){r(n,!1),console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})}),c.addTransaction(n.tx_json,{Status:"error"},n.tx_json.hash,(new Date).toString())}),i.requestSecret(n.account,n.username,function(n,r){return n?(e.loading=!1,void console.log(n)):(e.mode="granting",a.secret(r),void c.getUserAccess().then(function(e){a.submit()},function(n){console.log("error",n),t(function(){e.$apply(function(){e.mode="error",e.loading=!1,e.editing=!1})})}))})},e.$watch("lines",function(){e.lines.rfNZPxoZ5Uaamdp339U9dCLWz2T73nZJZHBRL?e.brlConnected=!0:e.brlConnected=!1},!0),e.$watch("account",function(){e.can_add_trust=!1,e.account.Balance&&e.account.reserve_to_add_trust&&(!e.account.reserve_to_add_trust.subtract(e.account.Balance).is_positive()||$.isEmptyObject(e.lines))&&(e.can_add_trust=!0)},!0)}])},e.exports=a}).call(t,n(15).setImmediate)},function(e,t,n){(function(e){!function(e){"use strict";var t=n(6),r=(n(18),n(12)),o=n(55).Tab,a=function(){o.call(this)};t.inherits(a,o),a.prototype.tabName="settingstrade",a.prototype.mainMenu="settingstrade",a.prototype.angular=function(e){function t(e,t){if(e.userBlob.data&&e.userCredentials.username)e.pairs=_.clone(r.getSetting(e.userBlob,"trade_currency_pairs"));else var n=e.$on("$blobUpdate",function(){e.userCredentials.username&&(e.pairs=_.clone(r.getSetting(e.userBlob,"trade_currency_pairs")),n())});e.deletePair=function(t){for(var n=0;n<e.pairs.length;n++)if(e.pairs[n].name===this.entry.name)return e.pairs.splice(n,1),void e.userBlob.unset("/clients/rippletradecom/trade_currency_pairs/"+t)},e.dragControlListeners={orderChanged:function(t){var n=t.dest.index<t.source.index?1:-1,r=t.dest.index,o=t.source.index+n;do{var a=e.pairs[r];e.userBlob.set("/clients/rippletradecom/trade_currency_pairs/"+r,a),r+=n}while(r!=o)}}}e.controller("SettingsTradeCtrl",t),t.$inject=["$scope","$timeout"]},e.exports=a}(e)}).call(t,n(67)(e))},function(e,t,n){var r=n(6),o=(n(18),n(55).Tab),a=n(12),i=ripple.Currency,s=function(){o.call(this)};r.inherits(s,o),s.prototype.tabName="settingsgateway",s.prototype.mainMenu="settingsgateway",s.prototype.angular=function(e){e.controller("SettingsGatewayCtrl",["$scope","rpId","rpKeychain","rpNetwork","rpAPI",function(e,t,n,r,o){var s=i.from_json("XRP");e.xrp={name:s.to_human({full_name:e.currencies_all_keyed.XRP.name}),code:s.get_iso(),currency:s},e.options=Options,e.optionsBackup=$.extend(!0,{},Options),e.passwordProtection=!a.getSetting(e.userBlob,"persistUnlock",!1),e.editConfirmation={send:!1,exchange:!1,trade:!1},e.edit={advanced_feature_switch:!1,bridge:!1,defaultRippleFlag:!1,defaultRippleFlagSaving:!1},e.max_tx_network_fee_human=ripple.Amount.from_json(e.options.max_tx_network_fee).to_human(),e.confirmationChanged={send:!1,exchange:!1,trade:!1},e.success={},e.save=function(a){switch(a){case"advanced_feature_switch":e.userBlob.set("/clients/rippletradecom/trust/advancedMode",e.options.advanced_feature_switch);break;case"defaultRippleFlag":if(e.currentDefaultRipplingFlagSetting!==e.isDefaultRippleFlagEnabled){e.edit.defaultRippleFlagSaving=!0;var i=r.remote.transaction();e.isDefaultRippleFlagEnabled?i.accountSet(t.account,"DefaultRipple"):i.accountSet(t.account,void 0,"DefaultRipple"),i.on("success",function(t){e.$apply(function(){e.edit.defaultRippleFlagSaving=!1,e.load_notification("defaultRippleUpdated")}),o.addTransaction(t.tx_json,{Status:"success"},t.tx_json.hash,(new Date).toString())}),i.on("error",function(t){console.warn(t),e.$apply(function(){e.edit.defaultRippleFlagSaving=!1}),o.addTransaction(t.tx_json,{Status:"error"},t.tx_json.hash,(new Date).toString())}),n.requestSecret(t.account,t.username,function(t,n){return t?(console.log("Error: ",t),e.isDefaultRippleFlagEnabled=!e.isDefaultRippleFlagEnabled,void(e.edit.defaultRippleFlagSaving=!1)):(i.secret(n),void o.getUserAccess().then(function(e){i.submit()},function(t){console.warn(t),e.$apply(function(){e.edit.defaultRippleFlagSaving=!1})}))})}break;default:store.disabled||store.set("ripple_settings",JSON.stringify(e.options))}e.edit[a]=!1,e.success[a]=!0},e.saveConfirmation=function(t){return e.confirmationChanged[t]?(e.confirmationChanged[t]=!1,e.userBlob.set("/clients/rippletradecom/confirmation",e.options.confirmation),e.editConfirmation[t]=!1,void(e.success.saveConfirmation[t]=!0)):void(e.editConfirmation[t]=!1)},e.deleteUrl=function(t){"bridge"===t&&(e.options.bridge.out.bitcoin=""),store.disabled||store.set("ripple_settings",JSON.stringify(e.options))},e.cancelEdit=function(t){e.edit[t]=!1,"bridge"===t?e.options.bridge.out.bitcoin=e.optionsBackup.bridge.out.bitcoin:e.options[t]=e.optionsBackup[t]},e.cancelEditConfirmation=function(t){e.editConfirmation[t]=!1,e.options.confirmation[t]=e.optionsBackup.confirmation[t]},e.$watch("account",function(){e.isDefaultRippleFlagEnabled=!!(e.account.Flags&ripple.Remote.flags.account_root.DefaultRipple),e.currentDefaultRipplingFlagSetting=e.isDefaultRippleFlagEnabled},!0)}])},e.exports=s},function(e,t,n){"use strict";var r=n(6),o=n(55).Tab,a=function(){o.call(this)};r.inherits(a,o),a.prototype.tabName="notifications",a.prototype.mainMenu="notifications",a.prototype.angular=function(e){e.controller("NotificationsCtrl",["$scope","$window","rpId","rpAPI",function(e,t,n,r){return n.loginStatus?(e.settingsPage="notifications",e.subscription={},e.state={},e.state.notificationsChanged=!1,e.state.waitingForResponse=!1,e.state.alert="",e.notificationTypes=[{name:"sent",title:"Sent money",correspondingTypes:["sent"],checked:{email:!1,push:!1}},{name:"received",title:"Received money",correspondingTypes:["received"],checked:{email:!1,push:!1}},{name:"exchange",title:"Simple trade executed",correspondingTypes:["exchange"],checked:{email:!1,push:!1}},{name:"offernew",title:"Offer created",correspondingTypes:["offernew"],checked:{email:!1,push:!1}},{name:"offer_funded",title:"Trade executed",correspondingTypes:["offer_funded","offer_partially_funded"],checked:{email:!1,push:!1}},{name:"trusting",title:"Gateway added",correspondingTypes:["trusting"],checked:{email:!1,push:!1}}],e.$watch("userBlob.data.email",function(){null!=e.address&&null!=e.userBlob.data.email&&null!=e.userCredentials.username&&r.getSubscription().success(function(t){e.subscription=t,(t.email||t.push)&&_.invoke(e.notificationTypes,function(){var e;e=_.intersection(this.correspondingTypes,t.email),this.checked.email=!1,e.length>0&&(this.checked.email=!0),e=_.intersection(this.correspondingTypes,t.push),this.checked.push=!1,e.length>0&&(this.checked.push=!0)})})}),e.persistNotifications=function(){e.state.waitingForResponse=!0,e.state.alert="",e.subscription={email:[],push:[]},_.each(e.notificationTypes,function(t){t.checked.email&&_.each(t.correspondingTypes,function(t){e.subscription.email.push(t)}),t.checked.push&&_.each(t.correspondingTypes,function(t){e.subscription.push.push(t)})}),r.updateSubscription(e.subscription).success(function(){e.state.waitingForResponse=!1,e.state.alert="saved_successfully",e.state.notificationsChanged=!1}).error(function(){e.state.waitingForResponse=!1,e.state.alert="saved_with_errors"}),t._roost.push(["alias",e.userBlob.data.email]),t._roost.prompt()},e.allChecked=function(t){var n=0;return"push"!==t&&(t="email"),_.each(e.notificationTypes,function(e){e.checked[t]&&n++}),n===e.notificationTypes.length},void(e.allClicked=function(t){"push"!==t&&(t="email");var n=!e.allChecked(t);_.each(e.notificationTypes,function(r){r.checked[t]!==n&&(e.state.notificationsChanged=!0),r.checked[t]=n})})):n.goId()}])},e.exports=a},function(e,t,n){var r=n(6),o=(n(18),n(55).Tab),a=(ripple.Amount,ripple.Base,function(){o.call(this)});r.inherits(a,o),a.prototype.tabName="apps",a.prototype.mainMenu="apps",a.prototype.angular=function(e){e.controller("AppsCtrl",["$scope","rpId","rpAppManager",function(e,t,n){e.add=function(){e.loading=!0,e.app&&e.app.rippleAddress&&n.getApp(e.app.rippleAddress,function(t,n){return t?(console.log("err",t),void(e.error=t.message)):(e.app.name=n.name,e.userBlob.unshift("/apps",e.app),e.success=!0,void(e.loading=!1))})},e.remove=function(t){e.userBlob.filter("/apps","rippleAddress",t,"unset","")}}])},e.exports=a},function(e,t,n){var r=n(6),o=(n(18),n(55).Tab),a=(ripple.Amount,ripple.Base,function(){o.call(this)});r.inherits(a,o),a.prototype.tabName="su",a.prototype.mainMenu="su",a.prototype.angular=function(e){e.controller("SuCtrl",["$scope","$routeParams","rpId","rpNetwork","rpDomainAlias","rpKeychain","rpAPI",function(e,t,n,r,o,a,i){e.account={},e.$on("$idAccountLoad",function(t,n){var r=o.getAliasForAddress(n.account);r.then(function(t){e.account.domain=t},function(e){console.log("error",e)})}),e.accountSet=function(){var t=r.remote.transaction();t.accountSet(n.account),t.tx_json.Domain=sjcl.codec.hex.fromBits(sjcl.codec.utf8String.toBits(e.account.domain)),t.on("success",function(e){console.log("Transaction successfully finished!"),i.addTransaction(e.tx_json,{Status:"success"},e.tx_json.hash,(new Date).toString())}),t.on("error",function(e){console.log("Error!"),i.addTransaction(e.tx_json,{Status:"error"},e.tx_json.hash,(new Date).toString())}),a.requestSecret(n.account,n.username,function(e,n){e||(t.secret(n),i.getUserAccess().then(function(e){t.submit()},function(e){console.log("Error!")}))})}}])},e.exports=a},function(e,t){e.exports={active:[{code:"ca",name:"catalan",nativeName:"Català"},{code:"de",name:"german",nativeName:"Deutsch"},{code:"en",name:"english",nativeName:"English"},{code:"es",name:"spanish",nativeName:"Español"},{code:"fr_FR",name:"french",nativeName:"Français"},{code:"he_IL",name:"hebrew_israel",nativeName:"עברית"},{code:"it",name:"italian",nativeName:"Italiano"},{code:"ja",name:"japanese",nativeName:"日本の"},{code:"ko",name:"korean",nativeName:"한국말"},{code:"nb_NO",name:"norwegian_bokmal",nativeName:"Norsk bokmål"},{code:"nl_NL",name:"dutch_netherlands",nativeName:"Nederlands"},{code:"pl",name:"polish",nativeName:"Polski"},{code:"pt_BR",name:"portuguese_brazil",nativeName:"Português brasileiro"},{code:"ro",name:"romanian",nativeName:"Român"},{code:"ru",name:"russian",nativeName:"Русский"},{code:"sk",name:"slovak",nativeName:"Slovenská"},{code:"tr",name:"turkish",nativeName:"Türkçe"},{code:"zh_CN",name:"chinese_china",nativeName:"中文"}]}}]);